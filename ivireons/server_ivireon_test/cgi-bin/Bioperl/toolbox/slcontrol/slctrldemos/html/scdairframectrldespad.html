
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Cascaded Multi-Loop/Multi-Compensator Feedback Design</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-06-30"><meta name="DC.source" content="scdairframectrldespad.m"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit scdairframectrldespad">Open scdairframectrldespad.m in the Editor</a></div><div class="right"><a href="matlab:echodemo scdairframectrldespad">Run in the Command Window</a></div></div><div class="content"><h1>Cascaded Multi-Loop/Multi-Compensator Feedback Design</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Opening the Model</a></li><li><a href="#4">Design Overview</a></li><li><a href="#8">Decoupling Loops in a Multi-Loop Design</a></li><li><a href="#9">Creating a SISO Design Task</a></li><li><a href="#11">Starting a New Design</a></li><li><a href="#26">Removing the Effect of an Outer Feedback Loop</a></li><li><a href="#39">Completing the Design</a></li><li><a href="#41">Completed Design</a></li><li><a href="#51">Writing the Design to Simulink</a></li></ul></div><h2>Opening the Model<a name="1"></a></h2><p>Take a few moments to explore the model.</p><p><a href="matlab:open_system('scdairframectrl')">Open the airframe model</a></p><pre class="codeinput">open_system(<span class="string">'scdairframectrl'</span>);
</pre><img vspace="5" hspace="5" src="scdairframectrldespad_01.png" alt=""> <h2>Design Overview<a name="4"></a></h2><p>This demonstration introduces the process of designing two cascaded feedback loops so that the acceleration component (az) tracks reference signals with a maximum rise time of 0.5 seconds. The feedback loop structure in this example uses the body rate (q) as an inner feedback loop and the acceleration (az) as an outer feedback signal.</p><p>The two feedback controllers being tuned are:</p><div><ul><li><tt>scdairframectrl/q Control</tt> - A discrete time integrator and a gain block <tt>q Gain</tt> stabilize this inner loop.</li></ul></div><pre class="codeinput">open_system(<span class="string">'scdairframectrl/q Control'</span>)
</pre><img vspace="5" hspace="5" src="scdairframectrldespad_02.png" alt=""> <div><ul><li><tt>scdairframectrl/az Control</tt> - A discrete time integrator, a discrete transfer function, and a gain block <tt>az Gain</tt> stabilize the outer loop.</li></ul></div><pre class="codeinput">open_system(<span class="string">'scdairframectrl/az Control'</span>)
</pre><img vspace="5" hspace="5" src="scdairframectrldespad_03.png" alt=""> <h2>Decoupling Loops in a Multi-Loop Design<a name="8"></a></h2><p>The typical design procedure for cascaded feedback systems is to first design an inner loop and then an outer loop.  In a Simulink&reg; Compensator Design Task it is possible to design both loops simultaneously; by default, when designing a multi-loop feedback system the coupling effects between loops are taken into account. However, when designing two feedback loops simultaneously it might be necessary to remove the effect of an outer loop when tuning an inner loop. In this example the design of the inner feedback loop (q) should be performed with the effect of the outer loop removed (az).  The example demonstrates how to decouple feedback loops in a Simulink Compensator Design Task.</p><h2>Creating a SISO Design Task<a name="9"></a></h2><p>In this example a Simulink Compensator Design Task will be used to create a SISO Design Task to tune the compensators in the feedback system. There are two alternatives for creating the SISO Design Task:</p><div><ul><li>Launch a preconfigured Simulink&reg; Control Design&#8482; task by double clicking on the subsystem in the lower left hand corner of the model.</li><li>Work through the following procedure to create the SISO Design Task.</li></ul></div><h2>Starting a New Design<a name="11"></a></h2><p><b>Step 1</b> Start a new Simulink Compensator Design Task for the model <tt>scdairframectrl.mdl</tt> by choosing <b>Tools -&gt; Control Design -&gt; Compensator Design</b> from the Simulink model.</p><p><b>Step 2</b> Select the following blocks to tune:</p><div><ul><li><tt>scdairframectrl/q Control/q Gain</tt></li><li><tt>scdairframectrl/az Control/az Gain</tt></li><li><tt>scdairframectrl/az Control/az DTF</tt></li></ul></div><p><b>Step 3</b> Select the closed loop signals:</p><div><ul><li>Input: <tt>scdairframectrl/Step az</tt> - output port 1</li><li>Output: <tt>scdairframectrl/Airframe Model</tt> - output port 1</li></ul></div><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/closedloopsignals.png" alt=""> </p><p><b>Step 4</b> Click the <b>Tune Blocks...</b> button to launch the Design Configuration Wizard.</p><p>Simulink Control Design automatically recognizes 3 potential feedback loops for open-loop design:</p><div><ul><li>Open Loop at outport 1 of <tt>scdairframectrl/az Control/az DTF</tt></li><li>Open Loop at outport 1 of <tt>scdairframectrl/az Control/az Gain</tt></li><li>Open Loop at outport 1 of <tt>scdairframectrl/q Control/q Gain</tt></li></ul></div><p>In step 1 of the wizard select the loops to tune:</p><div><ul><li>Plot 1: Loop to Tune - Open Loop at outport 1 of <tt>scdairframectrl/az Control/az DTF</tt>, Plot Type - Open-Loop Bode</li><li>Plot 2: Loop to Tune - Open Loop at outport 1 of <tt>scdairframectrl/q Control/q Gain</tt>, Plot Type - Open-Loop Bode</li></ul></div><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/selectloopstep.png" alt=""> </p><p>In step 2 of the wizard select Step response for Plot 1 and add the <tt>Closed Loop from scdairframectrl/Step az to scdairframe/Ariframe Model (pt 1)</tt> to this plot to view the closed loop response of the feedback system.</p><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/selectanalysisstep.png" alt=""> </p><p>After completing the wizard a SISO Design Task node is created.  Use this task node to complete the design.</p><h2>Removing the Effect of an Outer Feedback Loop<a name="26"></a></h2><p>The SISO Design Task is ready to simultaneously design the feedback loops. In the Bode editors (see the image below) click on the left hand plot (outer feedback loop, az) and increase the gain of the feedback loop.  Note that the response of the right hand plot changes.  This is a result of the coupling between the feedback loops.  However, a more systematic approach is to first design the inner feedback loop, q with the outer loop open.</p><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/bodeeditordlg.png" alt=""> </p><p>To remove the effect of the outer loop (az) when designing the inner loop:</p><p><b>Step 1</b> From the SISO Design Task node select the <b>Architecture</b> panel and click the <b>Configure Loops...</b> button.</p><p><b>Step 2</b> In the Open-Loop Configuration dialog select the Open-Loop configuration for: <tt>Open Loop at outport 1 of scdairframe/q Control/q Gain</tt>.  This displays a list of possible locations to open feedback loops in the model.  To see the current coupling between the loops click on the <b>Highlight feedback loop</b> button.  This will highlight blocks in the current feedback loop.</p><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/highlightloop_initial.png" alt=""> </p><p>To open a feedback loop, select a block output from the list.  For this example, to remove the effect of the outer acceleration loop, select <tt>scdairframe/az Control/az DTF</tt>.</p><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/openloopdlg.png" alt=""> </p><p>Click on the <b>Highlight feedback loop</b> button.  This now highlights only the inner feedback loop; the outer loop is not included.</p><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/highlightloop.png" alt=""> </p><p><b>Step 3</b> Return to the graphical editor and change the gain of the outer acceleration loop.  The response of the inner feedback loop does not change.</p><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/bodeeditordlg.png" alt=""> </p><p>You can now complete the design of the inner loop without the effect of the outer loop and simultaneously design the outer loop while taking the effect of the inner loop into account.</p><h2>Completing the Design<a name="39"></a></h2><p>The SISO Design Task contains 4 methods to tune a control system:</p><div><ul><li>Use the <b>Compensator Editor</b> panel to manually tune the parameters of each compensator.  See the demo <a href="scdcompeditorpad.html">"Tuning Simulink Blocks in the Compensator Editor"</a>.</li><li>Configure Design Plots in the <b>Graphical Tuning</b> panel and the them to design the poles, zeros, and gains of the compensators using Root Locus, Open/Closed-Loop Bode Plots, and Nichols plots.</li><li>Use the <b>Optimization based tuning</b> option in the <b>Automated Tuning</b> panel (requires Simulink&reg; Design Optimization&#8482;) to tune the compensators using both time and frequency domain design requirements.  See the demo <a href="../../../sldo/sldodemos/optim/html/airframe_demopad.html">"Airframe Controller Tuning"</a>.</li><li>Use the <b>PID tuning</b>, <b>IMC tuning</b>, and <b>LQG synthesis</b> options in the <b>Automated Tuning</b> panel to compute initial parameters for the compensators based on tuning parameters such as closed-loop time constants.</li></ul></div><h2>Completed Design<a name="41"></a></h2><p>The design requirements can be met with the following controller parameters</p><div><ul><li><tt>scdairframectrl/q Control/q Gain</tt>:</li></ul></div><pre>         K_q = 2.7717622</pre><div><ul><li><tt>scdairframectrl/az Control/az Gain</tt></li></ul></div><pre>         K_az = 0.00027507</pre><div><ul><li><tt>scdairframectrl/az Control/az DTF</tt></li></ul></div><pre>         Numerator = [100.109745 -99.109745]</pre><pre>         Denominator = [1 -0.88893]</pre><p>The response of the closed loop system is shown below:</p><p><img vspace="5" hspace="5" src="../html_extra/scdairframectrldes/analysisresp.png" alt=""> </p><h2>Writing the Design to Simulink<a name="51"></a></h2><p>You can then test the design on the nonlinear model by clicking the <b>Update Simulink Block Parameters</b> button.  This writes the parameters back to the Simulink model.</p><pre class="codeinput">bdclose(<span class="string">'scdairframectrl'</span>)
</pre><p class="footer">Copyright 2005-2009 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Cascaded Multi-Loop/Multi-Compensator Feedback Design
%
% Copyright 2005-2009 The MathWorks, Inc.
% $Revision: 1.1.6.7 $ $Date: 2009/11/09 16:35:33 $

%% Opening the Model
% Take a few moments to explore the model. 
%%
% <matlab:open_system('scdairframectrl') Open the airframe model>
open_system('scdairframectrl');
%%
%% Design Overview
% This demonstration introduces the process of designing two cascaded
% feedback loops so that the acceleration component (az) tracks reference
% signals with a maximum rise time of 0.5 seconds. The feedback loop
% structure in this example uses the body rate (q) as an inner feedback
% loop and the acceleration (az) as an outer feedback signal.
%%
% The two feedback controllers being tuned are:
%%
% * |scdairframectrl/q Control| - A discrete time integrator and
% a gain block |q Gain| stabilize this inner loop.
open_system('scdairframectrl/q Control')
%%
% * |scdairframectrl/az Control| - A discrete time integrator, a discrete
% transfer function, and a gain block |az Gain| stabilize the
% outer loop.
open_system('scdairframectrl/az Control')

%% Decoupling Loops in a Multi-Loop Design
% The typical design procedure for cascaded feedback systems is to first
% design an inner loop and then an outer loop.  In a Simulink(R) Compensator
% Design Task it is possible to design both loops simultaneously; by
% default, when designing a multi-loop feedback system the coupling effects
% between loops are taken into account. However, when designing two
% feedback loops simultaneously it might be necessary to remove the effect
% of an outer loop when tuning an inner loop. In this example the design of
% the inner feedback loop (q) should be performed with the effect of the
% outer loop removed (az).  The example demonstrates how to decouple
% feedback loops in a Simulink Compensator Design Task.

%% Creating a SISO Design Task
% In this example a Simulink Compensator Design Task will be used to
% create a SISO Design Task to tune the compensators in the feedback system.
% There are two alternatives for creating the SISO Design Task:
%% 
% * Launch a preconfigured Simulink(R) Control Design(TM) task by double clicking
% on the subsystem in the lower left hand corner of the model.
% * Work through the following procedure to create the SISO Design
% Task.
%
%% Starting a New Design
% *Step 1* Start a new Simulink Compensator Design Task for the model
% |scdairframectrl.mdl| by choosing *Tools -> Control Design -> Compensator
% Design* from the Simulink model.
%% 
% *Step 2* Select the following blocks to tune:
%% 
% * |scdairframectrl/q Control/q Gain|
% * |scdairframectrl/az Control/az Gain|
% * |scdairframectrl/az Control/az DTF|
%% 
% *Step 3* Select the closed loop signals:
%%
% * Input: |scdairframectrl/Step az| - output port 1 
% * Output: |scdairframectrl/Airframe Model| - output port 1
%%
% <<../html_extra/scdairframectrldes/closedloopsignals.png>>

%%
% *Step 4* Click the *Tune Blocks...* button to launch the Design
% Configuration Wizard.  
%% 
% Simulink Control Design automatically recognizes 3 potential feedback
% loops for open-loop design:
%%
% * Open Loop at outport 1 of |scdairframectrl/az Control/az DTF|
% * Open Loop at outport 1 of |scdairframectrl/az Control/az Gain|
% * Open Loop at outport 1 of |scdairframectrl/q Control/q Gain|
%%
% In step 1 of the wizard select the loops to tune:
%%
% * Plot 1: Loop to Tune - Open Loop at outport 1 of |scdairframectrl/az
% Control/az DTF|, Plot Type - Open-Loop Bode
% * Plot 2: Loop to Tune - Open Loop at outport 1 of |scdairframectrl/q
% Control/q Gain|, Plot Type - Open-Loop Bode
%%
% <<../html_extra/scdairframectrldes/selectloopstep.png>>

%%
% In step 2 of the wizard select Step response for Plot 1 and add the
% |Closed Loop from scdairframectrl/Step az to scdairframe/Ariframe Model
% (pt 1)| to this plot to view the closed loop response of the feedback
% system.
%%
% <<../html_extra/scdairframectrldes/selectanalysisstep.png>>
%%
% After completing the wizard a SISO Design Task node is created.  Use this
% task node to complete the design.

%% Removing the Effect of an Outer Feedback Loop
% The SISO Design Task is ready to simultaneously design the feedback
% loops. In the Bode editors (see the image below) click on the left hand
% plot (outer feedback loop, az) and increase the gain of the feedback
% loop.  Note that the response of the right hand plot changes.  This is a
% result of the coupling between the feedback loops.  However, a more
% systematic approach is to first design the inner feedback loop, q with
% the outer loop open.  
%%
% <<../html_extra/scdairframectrldes/bodeeditordlg.png>>

%% 
% To remove the effect of the outer loop (az) when designing the inner
% loop:
%% 
% *Step 1* From the SISO Design Task node select the *Architecture* panel and
% click the *Configure Loops...* button.
%%
% *Step 2* In the Open-Loop Configuration dialog select the Open-Loop
% configuration for: |Open Loop at outport 1 of scdairframe/q Control/q
% Gain|.  This displays a list of possible locations to open feedback loops
% in the model.  To see the current coupling between the loops click on the
% *Highlight feedback loop* button.  This will highlight blocks in the
% current feedback loop. 
%%
% <<../html_extra/scdairframectrldes/highlightloop_initial.png>>
%%
% To open a feedback loop, select a block output from the list.  For this
% example, to remove the effect of the outer acceleration loop, select
% |scdairframe/az Control/az DTF|.
%%
% <<../html_extra/scdairframectrldes/openloopdlg.png>>
%%
% Click on the *Highlight feedback loop* button.  This now highlights only the
% inner feedback loop; the outer loop is not included.
%%
% <<../html_extra/scdairframectrldes/highlightloop.png>>

%% 
% *Step 3* Return to the graphical editor and change the gain of the outer
% acceleration loop.  The response of the inner feedback loop does not
% change.
%%
% <<../html_extra/scdairframectrldes/bodeeditordlg.png>>

%% 
% You can now complete the design of the inner loop without the effect of
% the outer loop and simultaneously design the outer loop while taking
% the effect of the inner loop into account.

%% Completing the Design
% The SISO Design Task contains 4 methods to tune a control system:
%%
% * Use the *Compensator Editor* panel to manually tune the parameters of each
% compensator.  See the demo <scdcompeditorpad.html "Tuning Simulink Blocks
% in the Compensator Editor">.
% * Configure Design Plots in the *Graphical Tuning* panel and the them to
% design the poles, zeros, and gains of the compensators using Root
% Locus, Open/Closed-Loop Bode Plots, and Nichols plots.
% * Use the *Optimization based tuning* option in the *Automated Tuning*
% panel (requires Simulink(R) Design Optimization(TM)) to tune the compensators using
% both time and frequency domain design requirements.  See the demo
% <../../../sldo/sldodemos/optim/html/airframe_demopad.html "Airframe
% Controller Tuning">.
% * Use the *PID tuning*, *IMC tuning*, and *LQG synthesis* options in the *Automated
% Tuning* panel to compute initial parameters for the compensators based on
% tuning parameters such as closed-loop time constants.

%% Completed Design
% The design requirements can be met with the following controller
% parameters

%%
% * |scdairframectrl/q Control/q Gain|:
%%
%           K_q = 2.7717622
%%
% * |scdairframectrl/az Control/az Gain|
%%
%           K_az = 0.00027507
%%
% * |scdairframectrl/az Control/az DTF|
%%
%           Numerator = [100.109745 -99.109745]
%%
%           Denominator = [1 -0.88893]
%%
% The response of the closed loop system is shown below:
%%
% <<../html_extra/scdairframectrldes/analysisresp.png>>

%% Writing the Design to Simulink
% You can then test the design on the nonlinear model by clicking the
% *Update Simulink Block Parameters* button.  This writes the parameters back to
% the Simulink model.

bdclose('scdairframectrl')
displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
--></body></html>