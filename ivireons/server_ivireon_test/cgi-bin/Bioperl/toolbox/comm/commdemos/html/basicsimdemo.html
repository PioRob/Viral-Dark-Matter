
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Phase Shift Keying Simulation</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-06-29"><meta name="DC.source" content="basicsimdemo.m"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit basicsimdemo">Open basicsimdemo.m in the Editor</a></div><div class="right"><a href="matlab:echodemo basicsimdemo">Run in the Command Window</a></div></div><div class="content"><h1>Phase Shift Keying Simulation</h1><!--introduction--><p>This demo shows how to simulate a basic Quaternary Phase Shift Keying (QPSK) communication link, and to generate empirical performance curves that can be compared to theoretical predictions.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Initializing Variables</a></li><li><a href="#2">Generating Random Information Symbols</a></li><li><a href="#3">Phase Modulating the Data</a></li><li><a href="#4">Creating the Noisy Signal</a></li><li><a href="#5">Recovering Information from the Transmitted Signal</a></li><li><a href="#6">Comparing Original Message to Demodulated Message</a></li><li><a href="#7">Running Simulation Examples</a></li><li><a href="#8">Running the QPSK Simulation Example</a></li></ul></div><h2>Initializing Variables<a name="1"></a></h2><p>The first step is to initialize variables for number of samples per symbol, number of symbols to simulate, alphabet size (M) and the signal to noise ratio. We create a local random stream with known seed and state to be used by random number generators.  Using this local stream ensures that the results generated by this demo will be repeatable.</p><pre class="codeinput">nSamp = 8; numSymb = 100;
M = 4; SNR = 14;
hStr = RandStream(<span class="string">'mt19937ar'</span>, <span class="string">'Seed'</span>, 12345);
</pre><h2>Generating Random Information Symbols<a name="2"></a></h2><p>Next, use RANDI to generate random information symbols from 0 to M-1. Since the simulation is of QPSK, the symbols are 0 through 3. The first 10 data points are plotted.</p><pre class="codeinput">numPlot = 10;
msg_orig = randi(hStr, [0 M-1], numSymb, 1);
stem(0:numPlot-1, msg_orig(1:numPlot), <span class="string">'bx'</span>);
xlabel(<span class="string">'Time'</span>); ylabel(<span class="string">'Amplitude'</span>);
</pre><img vspace="5" hspace="5" src="basicsimdemo_01.png" alt=""> <h2>Phase Modulating the Data<a name="3"></a></h2><p>Use MODEM.PSKMOD to modulate the data using QPSK modulation and Gray encoding. Upsample the symbols to a sampling rate 8 times the carrier frequency using RECTPULSE. Use SCATTERPLOT to see the signal constellation.</p><pre class="codeinput">hMod = modem.pskmod(<span class="string">'M'</span>, M, <span class="string">'PhaseOffset'</span>, pi/4, <span class="string">'SymbolOrder'</span>, <span class="string">'Gray'</span>);
msg_tx = modulate(hMod, msg_orig);
msg_tx = rectpulse(msg_tx,nSamp);
h1 = scatterplot(msg_tx);
</pre><img vspace="5" hspace="5" src="basicsimdemo_02.png" alt=""> <h2>Creating the Noisy Signal<a name="4"></a></h2><p>Then use AWGN to add noise to the transmitted signal to create the noisy signal at the receiver. Use the 'measured' option to add noise that is 14 dB below the average signal power (SNR = 14 dB). Plot the constellation of the received signal.</p><pre class="codeinput">msg_rx = awgn(msg_tx, SNR, <span class="string">'measured'</span>, hStr, <span class="string">'dB'</span>);
h2 = scatterplot(msg_rx);
</pre><img vspace="5" hspace="5" src="basicsimdemo_03.png" alt=""> <h2>Recovering Information from the Transmitted Signal<a name="5"></a></h2><p>Use INTDUMP to downsample to the original information rate. Then use MODEM.PSKDEMOD to demodulate the signal, and detect the transmitted symbols. The detected symbols are plotted in red stems with circles and the transmitted symbols are plotted in blue stems with x's. The blue stems of the transmitted signal are shadowed by the red stems of the received signal. Therefore, comparing the blue x's with the red circles indicates that the received signal is identical to the transmitted signal.</p><pre class="codeinput">hDemod = modem.pskdemod(<span class="string">'M'</span>, M, <span class="string">'PhaseOffset'</span>, pi/4, <span class="string">'SymbolOrder'</span>, <span class="string">'Gray'</span>);
close(h1(ishghandle(h1)), h2(ishghandle(h2)));
msg_rx_down = intdump(msg_rx,nSamp);
msg_demod = demodulate(hDemod, msg_rx_down);
stem(0:numPlot-1, msg_orig(1:numPlot), <span class="string">'bx'</span>); hold <span class="string">on</span>;
stem(0:numPlot-1, msg_demod(1:numPlot), <span class="string">'ro'</span>); hold <span class="string">off</span>;
axis([ 0 numPlot -0.2 3.2]); xlabel(<span class="string">'Time'</span>); ylabel(<span class="string">'Amplitude'</span>);
</pre><img vspace="5" hspace="5" src="basicsimdemo_04.png" alt=""> <h2>Comparing Original Message to Demodulated Message<a name="6"></a></h2><p>Finally, use BITERR and SYMERR to compare the original message to the demodulated message. BITERR is used to determine the bit error rate and SYMERR is used to determine the symbol error rate.</p><pre class="codeinput">[errorBit ratioBit] = biterr(msg_orig, msg_demod, log2(M));
[errorSym ratioSym] = symerr(msg_orig, msg_demod);
</pre><h2>Running Simulation Examples<a name="7"></a></h2><p>The next step executes an example file SIMBASEBANDEX, which is a complete simulation example for QPSK. It demonstrates how to create simulation drivers in MATLAB&reg; that plot the simulation results as they are generated.</p><h2>Running the QPSK Simulation Example<a name="8"></a></h2><p>The green and magenta lines are the theoretical bit error rate (BER) and symbol error rate (SER) performance curves for QPSK, respectively. The example, SIMBASEBANDEX, plots the simulated BER and SER in red and blue lines, respectively. SIMBASEBANDEX uses MODEM.PSKMOD and MODEM.PSKDEMOD to simulate PSK at baseband using a complex envelope representation of the modulated signal.  For this simulation, we use the default random number stream instead of a random number stream with known state and seed.  Therefore, the results may vary slightly for different runs.</p><pre class="codeinput">simbasebandex(0:5);
</pre><img vspace="5" hspace="5" src="basicsimdemo_05.png" alt=""> <p class="footer">Copyright 1996-2009 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Phase Shift Keying Simulation
% This demo shows how to simulate a basic Quaternary Phase Shift Keying
% (QPSK) communication link, and to generate empirical performance curves
% that can be compared to theoretical predictions.

% Copyright 1996-2009 The MathWorks, Inc.
% $Revision: 1.12.2.12 $ $Date: 2009/12/05 01:58:35 $

%% Initializing Variables
% The first step is to initialize variables for number of samples per
% symbol, number of symbols to simulate, alphabet size (M) and the signal
% to noise ratio. We create a local random stream with known seed and state
% to be used by random number generators.  Using this local stream ensures
% that the results generated by this demo will be repeatable. 

nSamp = 8; numSymb = 100;
M = 4; SNR = 14;
hStr = RandStream('mt19937ar', 'Seed', 12345);

%% Generating Random Information Symbols
% Next, use RANDI to generate random information symbols from 0 to M-1.
% Since the simulation is of QPSK, the symbols are 0 through 3. The first
% 10 data points are plotted.

numPlot = 10;
msg_orig = randi(hStr, [0 M-1], numSymb, 1);
stem(0:numPlot-1, msg_orig(1:numPlot), 'bx');
xlabel('Time'); ylabel('Amplitude');

%% Phase Modulating the Data 
% Use MODEM.PSKMOD to modulate the data using QPSK modulation and Gray
% encoding. Upsample the symbols to a sampling rate 8 times the carrier
% frequency using RECTPULSE. Use SCATTERPLOT to see the signal
% constellation.

hMod = modem.pskmod('M', M, 'PhaseOffset', pi/4, 'SymbolOrder', 'Gray');
msg_tx = modulate(hMod, msg_orig);
msg_tx = rectpulse(msg_tx,nSamp);
h1 = scatterplot(msg_tx);

%% Creating the Noisy Signal
% Then use AWGN to add noise to the transmitted signal to create the noisy
% signal at the receiver. Use the 'measured' option to add noise that is
% 14 dB below the average signal power (SNR = 14 dB). Plot the
% constellation of the received signal.

msg_rx = awgn(msg_tx, SNR, 'measured', hStr, 'dB');
h2 = scatterplot(msg_rx);

%% Recovering Information from the Transmitted Signal
% Use INTDUMP to downsample to the original information rate. Then use
% MODEM.PSKDEMOD to demodulate the signal, and detect the transmitted
% symbols. The detected symbols are plotted in red stems with circles and
% the transmitted symbols are plotted in blue stems with x's. The blue stems
% of the transmitted signal are shadowed by the red stems of the received
% signal. Therefore, comparing the blue x's with the red circles indicates
% that the received signal is identical to the transmitted signal.

hDemod = modem.pskdemod('M', M, 'PhaseOffset', pi/4, 'SymbolOrder', 'Gray');
close(h1(ishghandle(h1)), h2(ishghandle(h2)));
msg_rx_down = intdump(msg_rx,nSamp);
msg_demod = demodulate(hDemod, msg_rx_down);
stem(0:numPlot-1, msg_orig(1:numPlot), 'bx'); hold on;
stem(0:numPlot-1, msg_demod(1:numPlot), 'ro'); hold off;
axis([ 0 numPlot -0.2 3.2]); xlabel('Time'); ylabel('Amplitude');

%% Comparing Original Message to Demodulated Message
% Finally, use BITERR and SYMERR to compare the original message to the
% demodulated message. BITERR is used to determine the bit error rate and
% SYMERR is used to determine the symbol error rate. 

[errorBit ratioBit] = biterr(msg_orig, msg_demod, log2(M));
[errorSym ratioSym] = symerr(msg_orig, msg_demod);

%% Running Simulation Examples
% The next step executes an example file SIMBASEBANDEX, which is a complete
% simulation example for QPSK. It demonstrates how to create simulation
% drivers in MATLAB(R) that plot the simulation results as they are
% generated.

%% Running the QPSK Simulation Example 
% The green and magenta lines are the theoretical bit error rate (BER) and
% symbol error rate (SER) performance curves for QPSK, respectively. The
% example, SIMBASEBANDEX, plots the simulated BER and SER in red and blue
% lines, respectively. SIMBASEBANDEX uses MODEM.PSKMOD and MODEM.PSKDEMOD 
% to simulate PSK at baseband using a complex envelope representation of
% the modulated signal.  For this simulation, we use the default random
% number stream instead of a random number stream with known state and
% seed.  Therefore, the results may vary slightly for different runs.

simbasebandex(0:5);

displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
--></body></html>