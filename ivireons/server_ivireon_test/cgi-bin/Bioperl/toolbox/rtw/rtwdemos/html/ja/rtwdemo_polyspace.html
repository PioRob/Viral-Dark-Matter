
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>MISRA C チェックを使った PolySpace 検証</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="rtwdemo_polyspace.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit rtwdemo_polyspace">エディターで twdemo_polyspace.m を開く</a></div><div class="right"><a href="matlab:echodemo rtwdemo_polyspace">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>MISRA C チェックを使った PolySpace 検証</h1><!--introduction--><p>組み込みソフトウェアの設計過程は手作業であり、エラーが生じやすくなっています。設計の不具合は、モデル更新、シミュレーション、または後のプロセッサーインザループ (PIL) 検証による組み込みソフトウェアのテスト中に表示されます。モデル更新およびシミュレーションを使用しただけでは検出が困難な、あるカテゴリの設計の不具合があります。それは、実行時エラーです。</p><p>実行時エラーの削減はすべてのソフトウェアに重要ですが、Rule 21.2 で実行時エラーを禁止している MISRA-C:2004 などの安全規格を満たさなければならないソフトウェアの場合には特に重要です。実行時エラーの例には、固定小数点または整数のオーバーフロー、ゼロ除算、メモリ破損、範囲外の配列アクセスなどがあります。これらのエラーは、モデルの入力信号とパラメーター値の特定の組み合わせにより現れ、経験的な手法やテストを使用するだけでは検出が困難な場合が多くあります。</p><p>このドキュメントでは、Real-Time Workshop Embedded Coder ソフトウェアにより生成されるコードについて、PolySpace&reg; 製品が実行時エラーの有無をどのように証明するかを例を挙げて説明します。また、生成されたコードについての MISRA C&reg; 準拠の結果についても示します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">MISRA-C:2004</a></li><li><a href="#2">実行時エラーの有無の証明</a></li><li><a href="#3">モデルにおけるオーバーフロー処理の例</a></li><li><a href="#4">モデルにおける到達不可能なコードの例</a></li></ul></div><h2>MISRA-C:2004<a name="1"></a></h2><p>このドキュメントでは、固定小数点バージョンの fuelsys モデル (固定小数点の燃料制御装置) を使用します。PolySpace 製品のアクティベーションを行うには、Simulink&reg; ライブラリ ブラウザーから PolySpace ブロックを追加します。</p><p><img vspace="5" hspace="5" src="../polyspace_big_model.jpg" alt=""> </p><p>MISRA C 違反のリストを取得するには、PolySpace のボタンをクリックします。MISRA C チェックは、生成された C コード上、および S-function で呼び出された C コード上で実行されます。</p><p>PolySpace 製品に含まれるグラフィカル インターフェイスから、特定の MISRA-C:2004 規則を有効または無効にできます。</p><p><img vspace="5" hspace="5" src="../polyspace_misra.jpg" alt=""> </p><h2>実行時エラーの有無の証明<a name="2"></a></h2><p>PolySpace 製品は、実行時エラーがないことを証明するためのコード検証を、生成されたコードの任意の場所で実行します。この診断が発生する場合、証明されたコードの部分は、緑色で表示されます。次の例は、実行時エラーが含まれていないことが完全に検証された、生成コードを示します。</p><p><img vspace="5" hspace="5" src="../polyspace_all_green.jpg" alt=""> </p><p>PolySpace 製品では、コード内に表示された青いハイパーリンクを右クリックすると、検証済みコードから Simulink モデルに遡ることができます。モデル内の強調表示された部分 (乗算演算子) が、緑のコードの部分を生成しました。</p><p><img vspace="5" hspace="5" src="../polyspace_green_model.jpg" alt=""> </p><p>エラーがないことを PolySpace 製品が証明できない場合、診断は、次の 3 つの結果のいずれかを表示します。</p><div><ul><li>赤:実行ごとに発生したエラーに対応するエラー メッセージへのリンク。</li><li>オレンジ:証明されていないメッセージへのリンク。エラーが発生する場合があります。</li><li>グレー:到達不可能なコードとして表示されるチェックへのリンク。</li></ul></div><h2>モデルにおけるオーバーフロー処理の例<a name="3"></a></h2><p>PolySpace 製品では、指定された入力データ範囲を使用し、特定の条件の下で、生成されたコードの一部を検証できます。この検証では、キャリブレーション データ、パラメーター変更、スケーリングなどの外部制約に基づき、生成されたコードの信頼性をチェックします。次の例は、いくつかの入力範囲データが制約されている fuelsys から生成されたコードについて、可能性のあるオーバーフローを示しています。</p><pre>'throttle'     in [0...120]
'enginespeed'  in [0...1000]
'EGO'          in [0...1536]
'MAP'          in [0...256]</pre><p><img vspace="5" hspace="5" src="../polyspace_orange_annotated.jpg" alt=""> </p><p>fuelsys の次のブロックには、オーバーフロー処理が含まれています。飽和演算子を使用すると、エラー (オーバーフロー) が修正されることがあります。</p><p><img vspace="5" hspace="5" src="../polyspace_ovfl.jpg" alt=""> </p><h2>モデルにおける到達不可能なコードの例<a name="4"></a></h2><p>PolySpace 製品は、実行時エラーだけではなく、到達不可能なコードもチェックします。たとえば、アクティベーション条件が満たされない場合、Stateflow&reg; マシンまたはサブシステムに、到達不可能なコードを表示できます。次の例は、fuelsys の到達不可能なコードの一部を示します。</p><p><img vspace="5" hspace="5" src="../polyspace_grey.jpg" alt=""> </p><p class="footer">Copyright 2007-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% PolySpace Verification with MISRA C Checking % % The embedded software design process is manual and error prone.  % Design flaws can appear during model update, simulation, or even  % later during embedded software testing with processor-in-loop (PIL)  % verification. One category of design flaws is difficult to detect  % using only model updates and simulations: run-time errors. % % Elimination of run-time errors is important for all software but  % especially for software that must meet safety standards such as  % MISRA-C:2004, which prohibits run-time errors in rule 21.2.  % Examples of run-time errors include fixed-point or integer  % overflow, division by zero, memory corruption, and out-of-bounds  % array accesses. These errors manifest through specific combinations  % of the input signals and parameter values of a model, and are often  % hard to detect using empirical methods or testing alone. % % This document provides examples of how PolySpace(R) products prove  % both the absence and presence of run-time errors for code  % generated by Real-Time Workshop Embedded Coder software. It also  % shows the results of MISRA C(R) compliance for the generated code. % %% MISRA-C:2004 % % This document uses a fixed-point version of the fuelsys model  % (Fixed-Point Fuel Control System). To activate the PolySpace  % products, add the PolySpace block from the Simulink(R) Library  % browser. % % <<polyspace_big_model.jpg>> % % To get the list of MISRA C violations, click on the PolySpace  % button. The MISRA C checks are performed on the generated C code  % and on the C code invoked in S-functions.  % % You can enable or disable specific MISRA-C:2004 rules from a  % graphical interface included in the PolySpace products. % % <<polyspace_misra.jpg>> % %% Proving the Absence or Presence of Run-Time Errors % % PolySpace products perform code verification aimed at proving the  % absence of run-time errors in any location in the generated code.  % A proven code section is colored green when this diagnostic occurs.  % The following example shows generated code that has been fully  % verified as not including any run-time errors.  % % <<polyspace_all_green.jpg>> % % PolySpace products let you trace the verified code back to the  % Simulink model by right-clicking on the blue hyper-links displayed  % in the code. The highlighted portion (product operator) in the  % model produced the green code section. % % <<polyspace_green_model.jpg>> % % When PolySpace products cannot prove the absence of an error,  % the diagnostic indicates one of three results: % % * Red: A link to the error message associated to the error which occurs at every execution. % * Orange: A link to an unproven message, an error may occur sometimes. % * Grey: A link to a check shown as unreachable code. % %% Example of Overflowing Operation in the Model % % PolySpace products can verify a piece of generated code under  % certain assumptions using specified input data ranges. The verification  % checks the reliability of the generated code based on external  % constraints of calibration data, parameter changes, scaling, and  % more. The following example shows a possible overflow in the  % generated code from fuelsys where some input range data has been  % constrained: % %  'throttle'     in [0...120]  %  'enginespeed'  in [0...1000]  %  'EGO'          in [0...1536]  %  'MAP'          in [0...256]  % % <<../polyspace_orange_annotated.jpg>> % % The following block in fuelsys has the overflowing operation.  % Using a saturation operator may fix the error (overflow). % % <<../polyspace_ovfl.jpg>> % %% Example of Unreachable Code in the Model % % Besides run-time errors, PolySpace products also check for  % unreachable code. For example, unreachable code can show up in a  % Stateflow(R) machine or in a sub-system when activating conditions  % are never met. The following example shows a section of unreachable  % code in fuelsys. % % <<../polyspace_grey.jpg>> %  %   Copyright 2007-2009 The MathWorks, Inc.   displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>