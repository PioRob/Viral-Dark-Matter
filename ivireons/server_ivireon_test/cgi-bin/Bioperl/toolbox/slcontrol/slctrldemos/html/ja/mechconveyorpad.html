
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>搬送モデルの線形化 (SimMechanics が必要)</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="mechconveyorpad.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit mechconveyorpad">エディターで mechconveyorpad.m を開く</a></div><div class="right"><a href="matlab:echodemo mechconveyorpad">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>搬送モデルの線形化 (SimMechanics が必要)</h1><!--introduction--><!--/introduction--><h2>目次</h2><div><ul><li><a href="#2">操作条件の検索</a></li><li><a href="#9">モデルの線形化</a></li></ul></div><p>このデモでは、SimMechanics™ モデルの線形化と共に、操作点の検索とスナップショット機能の使用法を紹介します(SimMechanics が必要)。</p><h2>操作条件の検索<a name="2"></a></h2><p>モデルを開きます。</p><pre class="codeinput">open_system(<span class="string">'scdmechconveyor'</span>);
</pre><img vspace="5" hspace="5" src="../mechconveyorpad_01.png" alt=""> <p>定常状態の操作点は、操作仕様オブジェクトを使用して検索できます。このオブジェクトは、シミュレートされた操作点を使用して初期化されたものです。定常状態の操作点を検索する場合、SimMechanics マシンの解析タイプをトリミング モードに設定しなければなりません。この機能の詳細は、SimMechanics ドキュメンテーションを参照してください。</p><pre class="codeinput">set_param(<span class="string">'scdmechconveyor/Mechanical Environment'</span>,<span class="string">'AnalysisType'</span>,<span class="string">'Trimming'</span>)
opspec = operspec(<span class="string">'scdmechconveyor'</span>);
</pre><p>SimMechanics モデルでは、操作条件検索が非線形最小二乗アルゴリズムを使用してより迅速に定常状態条件に収束する場合もあります。このアルゴリズムは、Optimization Toolbox™ のライセンスがある場合に使用できます。検索の反復レポートは、LINOPTIONS コマンドを使用して表示することもできます。</p><pre class="codeinput">opt = linoptions(<span class="string">'OptimizerType'</span>,<span class="string">'lsqnonlin'</span>,<span class="string">'DisplayReport'</span>,<span class="string">'none'</span>);
opt.OptimizationOptions.MaxFunEvals = 2000;
</pre><p>SimMechanics モデルの代数的な制約が満たされていることを確認するには、トリム出力端子をゼロに指定しなければなりません。</p><pre class="codeinput">opspec.Outputs.y = zeros(8,1);
opspec.Outputs.Known = ones(8,1);
</pre><p>定常状態の操作点は、FINDOP コマンドを使用して検索できます。</p><pre class="codeinput">[op,opreport] = findop(<span class="string">'scdmechconveyor'</span>,opspec,opt);
</pre><p>最終レポートを表示します。</p><pre class="codeinput">opreport
</pre><pre class="codeoutput">
 Operating Report for the Model scdmechconveyor.
 (Time-Varying Components Evaluated at time t=0)

Operating point specifications were successfully met.
States: 
----------
(1.) scdmechconveyor/Position Controller/H_inf Controller
      x:         -1.08      dx:             0 (0)
      x:    -7.64e-012      dx:    -1.14e-012 (0)
      x:         0.199      dx:     -9.4e-014 (0)
      x:         0.199      dx:    -7.27e-015 (0)
      x:        0.0743      dx:     1.43e-013 (0)
(2.) scdmechconveyor/Position Controller/Loopshaping Weight
      x:     2.59e-007      dx:      3.9e-014 (0)
      x:     2.59e-007      dx:      4.2e-015 (0)
      x:     9.66e-008      dx:    -3.84e-014 (0)
(3.) scdmechconveyor/Position Controller/Prefilter
      x:        0.0103      dx:     2.44e-013 (0)
(4.) scdmechconveyor/Position Controller/inv(W)
      x:    -2.59e-007      dx:     -3.9e-014 (0)
      x:    -2.59e-007      dx:     -4.2e-015 (0)
      x:    -9.66e-008      dx:     1.07e-013 (0)
(5.) Prismatic.P1.Position
      x:         0.103      dx:     2.15e-021 (0)
(6.) Prismatic.P1.Velocity
      x:     2.15e-021      dx:     5.03e-013 (0)
(7.) Revolute.R1.Position
      x:        -0.881      dx:     1.01e-021 (0)
(8.) Revolute.R1.Velocity
      x:     1.01e-021      dx:    -4.17e-012 (0)
(9.) Revolute1.R1.Position
      x:          0.83      dx:     4.27e-021 (0)
(10.) Revolute1.R1.Velocity
      x:     4.27e-021      dx:     3.76e-012 (0)
(11.) Revolute3.R1.Position
      x:        -0.172      dx:    -7.02e-021 (0)
(12.) Revolute3.R1.Velocity
      x:    -7.02e-021      dx:    -8.07e-013 (0)
(13.) Revolute5.R1.Position
      x:       0.00175      dx:    -5.01e-022 (0)
(14.) Revolute5.R1.Velocity
      x:    -5.01e-022      dx:    -1.05e-013 (0)

Inputs: None 
----------

Outputs: 
----------
(1.) scdmechconveyor/MSB Trimming Out
      y:    -2.31e-013    (0)
      y:     1.41e-013    (0)
      y:    -9.13e-013    (0)
      y:     1.62e-013    (0)
      y:     2.15e-021    (0)
      y:    -1.66e-022    (0)
      y:    -1.39e-021    (0)
      y:    -2.17e-021    (0)

</pre><p>モデルの線形化を完了する前に、SimMechanics モデルの解析タイプを元に戻す必要があります。</p><pre class="codeinput">set_param(<span class="string">'scdmechconveyor/Mechanical Environment'</span>,<span class="string">'AnalysisType'</span>,<span class="string">'Forward dynamics'</span>)
</pre><h2>モデルの線形化<a name="9"></a></h2><p>このモデルでは、搬送位置とトルク指令間の開ループ プラント モデルを、次の入力と出力を使用して検索できます。</p><pre class="codeinput">io(1) = linio(<span class="string">'scdmechconveyor/Joint Sensor'</span>,1,<span class="string">'out'</span>,<span class="string">'on'</span>);
io(2) = linio(<span class="string">'scdmechconveyor/Position Controller'</span>,1,<span class="string">'in'</span>);
</pre><p>モデルを線形化します。</p><pre class="codeinput">sys = linearize(<span class="string">'scdmechconveyor'</span>,op,io);
</pre><p>線形化されたモデルと対応するボード線図を表示します。</p><pre class="codeinput">sysm = zpk(sys)
bodemag(sysm)
</pre><pre class="codeoutput"> 
Zero/pole/gain from input &quot;Torque&quot; to output &quot;Joint Sensor&quot;:
      -2.0818
-------------------
(s-3.481) (s+3.481)
 
</pre><img vspace="5" hspace="5" src="../mechconveyorpad_02.png" alt=""> <p>モデルを閉じます。</p><pre class="codeinput">bdclose(<span class="string">'scdmechconveyor'</span>)
</pre><p class="footer">Copyright 2005-2007 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Linearization of a Conveyor Model (Requires SimMechanics) % Copyright 2005-2007 The MathWorks, Inc. % $Revision: 1.1.4.2.2.1 $ $Date: 2010/07/29 21:29:20 $  %% % This demonstration introduces the use of the operating point search and % snapshot features along with the linearization of a SimMechanics(TM) model. (Requires SimMechanics)   %% Operating Condition Search % Open the model open_system('scdmechconveyor');  %% % The steady state operating point can now be found using the operating specification object initialized using the simulated operating point. For the steady state operating point search, the Analysis Type for the SimMechanics machine must be set to be in Trimming mode. See the SimMechanics documentation for details on this feature.  set_param('scdmechconveyor/Mechanical Environment','AnalysisType','Trimming') opspec = operspec('scdmechconveyor');  %% % For SimMechanics models, the operating condition search in some cases can converge to a steady state condition more quickly using a nonlinear least squares algorithm. This algorithm is available if the Optimization Toolbox(TM) is licensed. An iterative report of the search can also be displayed by using the LINOPTIONS command.  opt = linoptions('OptimizerType','lsqnonlin','DisplayReport','none'); opt.OptimizationOptions.MaxFunEvals = 2000;  %% % To ensure that the algebraic constraints in the SimMechanics model are % met, the trim output port must be specified to be zero.  opspec.Outputs.y = zeros(8,1); opspec.Outputs.Known = ones(8,1);  %% % The steady state operating point can now be found using the FINDOP command. [op,opreport] = findop('scdmechconveyor',opspec,opt);  %%  % Display the final report opreport  %% % Before linearization of the model can be completed, the Analysis Type for the SimMechanics model needs to be restored. set_param('scdmechconveyor/Mechanical Environment','AnalysisType','Forward dynamics')  %% Linearize the Model % In this model the open loop plant model between the conveyor position and the torque command can be found using the following input and outputs:  io(1) = linio('scdmechconveyor/Joint Sensor',1,'out','on'); io(2) = linio('scdmechconveyor/Position Controller',1,'in');  %% % Linearize the model. sys = linearize('scdmechconveyor',op,io);  %% % View the linearized model and corresponding Bode plot.  sysm = zpk(sys) bodemag(sysm)  %% % Close the model. bdclose('scdmechconveyor') displayEndOfDemoMessage(mfilename) ##### SOURCE END ##### --></body></html>