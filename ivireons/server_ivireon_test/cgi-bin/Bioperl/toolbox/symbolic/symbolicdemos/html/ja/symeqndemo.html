
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>方程式の解</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-26"><meta name="DC.source" content="symeqndemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit symeqndemo">エディターで symeqndemo.m を開く</a></div><div class="right"><a href="matlab:echodemo symeqndemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>方程式の解</h1><!--introduction--><!--/introduction--><p>&quot;solve&quot; と &quot;dsolve&quot; は、代数方程式と常微分方程式の解析解を求める関数です。</p><p>最初の例は、簡単な 2 次方程式です。単一引用符がない場合は、数式が 0 となるような x を求めるか</p><pre class="codeinput">syms <span class="string">a</span> <span class="string">b</span> <span class="string">c</span> <span class="string">x</span>
x = solve(a*x^2 + b*x + c);
</pre><p>または、単一引用符がある場合に方程式の根を求めることができます。</p><pre class="codeinput">x = solve(<span class="string">'a*x^2 + b*x + c = 0'</span>);
</pre><p>どちらの場合も、同じ結果が得られます。</p><pre class="codeinput">x
</pre><pre class="codeoutput"> 
x =
 
 -(b + (b^2 - 4*a*c)^(1/2))/(2*a)
 -(b - (b^2 - 4*a*c)^(1/2))/(2*a)
 
</pre><p>一般的な 3 次方程式の解は以下のとおりです。</p><pre class="codeinput">x = solve(<span class="string">'a*x^3 + b*x^2 + c*x + d'</span>)

pretty(x)
</pre><pre class="codeoutput"> 
x =
 
                                                                                                                                                                                                                                                                                                                   (((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3) - b/(3*a) - (c/(3*a) - b^2/(9*a^2))/(((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3)
 (c/(3*a) - b^2/(9*a^2))/(2*(((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3)) - b/(3*a) - (((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3)/2 - (3^(1/2)*((c/(3*a) - b^2/(9*a^2))/(((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3) + (((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3))*i)/2
 (c/(3*a) - b^2/(9*a^2))/(2*(((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3)) - b/(3*a) - (((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3)/2 + (3^(1/2)*((c/(3*a) - b^2/(9*a^2))/(((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3) + (((d/(2*a) + b^3/(27*a^3) - (b*c)/(6*a^2))^2 + (c/(3*a) - b^2/(9*a^2))^3)^(1/2) - b^3/(27*a^3) - d/(2*a) + (b*c)/(6*a^2))^(1/3))*i)/2
 
 
  +-                                                                                                                                                                                                                                                                                                                                      -+ 
  |                                                                                                                               2                                                                                                                                                                                                        | 
|                                                                                                                        c     b                                                                                                                    1                                                                                    | 
  |                                                                                                                       --- - ----                                                                                                                  -                                                                                    | 
|                                                                                                                       3 a      2                                         / / /         3          \2   /         2  \3 \1/2     3                \3                                                                                    | 
|                                                                                                                             9 a                                     b    | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |                                                                                     | 
  |                                                                                     - -------------------------------------------------------------------------- - --- + | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |                                                                                     | 
|                                                                                                                                                                1   3 a   | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |                                                                                     | 
|                                                                                                                                                                -         \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /                                                                                     | 
  |                                                                                       / / /         3          \2   /         2  \3 \1/2     3                \3                                                                                                                                                                       | 
|                                                                                       | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |                                                                                                                                                                        | 
  |                                                                                       | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |                                                                                                                                                                        | 
|                                                                                       | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |                                                                                                                                                                        | 
|                                                                                       \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /                                                                                                                                                                        | 
  |                                                                                                                                                                                                                                                                                                                                        | 
  |                                                                                      /                                         2                                                                                                               \                                                                                       | 
|                                                                                      |                                  c     b                                                                                                              1 |                                                                                       | 
  |                                                                                      |                                 --- - ----                                                                                                            - |                                                                                       | 
|                                                                                      |                                 3 a      2                                   / / /         3          \2   /         2  \3 \1/2     3                \3 |                                                                                       | 
|                                                                                  1/2 |                                       9 a                                    | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |  |                                                                                       | 
|                                                                                 3    | -------------------------------------------------------------------------- + | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |  | i                                                                                     | 
|                                                                                      |                                                                          1   | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |  |                                                                                    1  | 
|                                                                                      |                                                                          -   \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /  |                                                                                    -  | 
  |                                           2                                          | / / /         3          \2   /         2  \3 \1/2     3                \3                                                                              |           / / /         3          \2   /         2  \3 \1/2     3                \3  | 
  |                                    c     b                                           | | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |                                                                               |           | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |   | 
  |                                   --- - ----                                         | | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |                                                                               |           | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |   | 
  |                                   3 a      2                                         | | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |                                                                               |           | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |   | 
  |                                         9 a                                          \ \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /                                                                               /      b    \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /   | 
  |  ---------------------------------------------------------------------------- - ------------------------------------------------------------------------------------------------------------------------------------------------------------------ - --- - --------------------------------------------------------------------------  | 
|                                                                             1                                                                                   2                                                                                    3 a                                       2                                       | 
  |                                                                             -                                                                                                                                                                                                                                                          | 
  |    / / /         3          \2   /         2  \3 \1/2     3                \3                                                                                                                                                                                                                                                          | 
  |    | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |                                                                                                                                                                                                                                                           | 
  |  2 | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |                                                                                                                                                                                                                                                           | 
  |    | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |                                                                                                                                                                                                                                                           | 
  |    \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /                                                                                                                                                                                                                                                           | 
  |                                                                                                                                                                                                                                                                                                                                        | 
  |                                                                                      /                                         2                                                                                                               \                                                                                       | 
|                                                                                      |                                  c     b                                                                                                              1 |                                                                                       | 
  |                                                                                      |                                 --- - ----                                                                                                            - |                                                                                       | 
|                                                                                      |                                 3 a      2                                   / / /         3          \2   /         2  \3 \1/2     3                \3 |                                                                                       | 
|                                                                                  1/2 |                                       9 a                                    | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |  |                                                                                       | 
|                                                                                 3    | -------------------------------------------------------------------------- + | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |  | i                                                                                     | 
|                                                                                      |                                                                          1   | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |  |                                                                                    1  | 
|                                                                                      |                                                                          -   \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /  |                                                                                    -  | 
  |                                           2                                          | / / /         3          \2   /         2  \3 \1/2     3                \3                                                                              |           / / /         3          \2   /         2  \3 \1/2     3                \3  | 
  |                                    c     b                                           | | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |                                                                               |           | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |   | 
  |                                   --- - ----                                         | | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |                                                                               |           | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |   | 
  |                                   3 a      2                                         | | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |                                                                               |           | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |   | 
  |                                         9 a                                          \ \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /                                                                               /      b    \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /   | 
  |  ---------------------------------------------------------------------------- + ------------------------------------------------------------------------------------------------------------------------------------------------------------------ - --- - --------------------------------------------------------------------------  | 
|                                                                             1                                                                                   2                                                                                    3 a                                       2                                       | 
  |                                                                             -                                                                                                                                                                                                                                                          | 
  |    / / /         3          \2   /         2  \3 \1/2     3                \3                                                                                                                                                                                                                                                          | 
  |    | | |  d     b      b c  |    |  c     b   |  |       b       d    b c  |                                                                                                                                                                                                                                                           | 
  |  2 | | | --- + ----- - ---- |  + | --- - ---- |  |    - ----- - --- + ---- |                                                                                                                                                                                                                                                           | 
  |    | | | 2 a       3      2 |    | 3 a      2 |  |          3   2 a      2 |                                                                                                                                                                                                                                                           | 
  |    \ \ \       27 a    6 a  /    \       9 a  /  /      27 a          6 a  /                                                                                                                                                                                                                                                           | 
  +-                                                                                                                                                                                                                                                                                                                                      -+
</pre><p>式</p><pre class="codeinput">x = solve(<span class="string">'p*sin(x) = r'</span>);
</pre><p>では、[x] が未知数として選択され、以下が返されます。</p><pre class="codeinput">x
</pre><pre class="codeoutput"> 
x =
 
asin(r/p)
pi - asin(r/p)
 
</pre><p>連立 2 元 2 次方程式は、解ベクトルを生成します。</p><pre class="codeinput">[x,y] = solve(<span class="string">'x^2 + x*y + y = 3'</span>,<span class="string">'x^2 - 4*x + 3 = 0'</span>)
</pre><pre class="codeoutput"> 
x =
 
 1
 3
 
 
y =
 
    1
 -3/2
 
</pre><p>この解を構造体で返すこともできます。</p><pre class="codeinput">S = solve(<span class="string">'x^2 + x*y + y = 3'</span>,<span class="string">'x^2 - 4*x + 3 = 0'</span>)
S.x
S.y
</pre><pre class="codeoutput">
S = 

    x: [2x1 sym]
    y: [2x1 sym]

 
ans =
 
 1
 3
 
 
ans =
 
    1
 -3/2
 
</pre><p>次の例では、[a] をパラメーターと見なし、u と v について 2 つの方程式を解きます。</p><pre class="codeinput">[u,v] = solve(<span class="string">'a*u^2 + v^2 = 0'</span>,<span class="string">'u - v = 1'</span>)
</pre><pre class="codeoutput"> 
u =
 
 1 - (a + (-a)^(1/2))/(a + 1)
 1 - (a - (-a)^(1/2))/(a + 1)
 
 
v =
 
 -(a + (-a)^(1/2))/(a + 1)
 -(a - (-a)^(1/2))/(a + 1)
 
</pre><p>3 次方程式を追加し、3 つの未知数すべての解を求めます。</p><pre class="codeinput">[a,u,v] = solve(<span class="string">'a*u^2 + v^2'</span>,<span class="string">'u - v = 1'</span>,<span class="string">'a^2 - 5*a + 6'</span>)
</pre><pre class="codeoutput"> 
a =
 
 2
 3
 3
 2
 
 
u =
 
 1/3 + (2^(1/2)*i)/3
 1/4 + (3^(1/2)*i)/4
 1/4 - (3^(1/2)*i)/4
 1/3 - (2^(1/2)*i)/3
 
 
v =
 
 - 2/3 + (2^(1/2)*i)/3
 - 3/4 + (3^(1/2)*i)/4
 - 3/4 - (3^(1/2)*i)/4
 - 2/3 - (2^(1/2)*i)/3
 
</pre><p>解析解を求めることができない場合、&quot;solve&quot; は数値解を返します。</p><pre class="codeinput">digits(32)
[x,y] = solve(<span class="string">'sin(x+y)-exp(x)*y = 0'</span>,<span class="string">'x^2-y = 2'</span>)
</pre><pre class="codeoutput"> 
x =
 
-0.66870120500236202933135901833637
 
 
y =
 
-1.5528386984283889912797441811191
 
</pre><p>常微分方程式に対しては関数 &quot;dsolve&quot; が用意されており、微分を示す &quot;D&quot; を付けること以外は、関数 solve と同様の表記です。</p><pre class="codeinput">y = dsolve(<span class="string">'Dy = -a*y'</span>)
</pre><pre class="codeoutput"> 
y =
 
C5/exp(a*t)
 
</pre><p>初期条件を指定します。</p><pre class="codeinput">y = dsolve(<span class="string">'Dy = -a*y'</span>,<span class="string">'y(0) = 1'</span>)
</pre><pre class="codeoutput"> 
y =
 
1/exp(a*t)
 
</pre><p>&quot;D2&quot; により 2 階の微分を表します。</p><pre class="codeinput">y = dsolve(<span class="string">'D2y = -a^2*y'</span>, <span class="string">'y(0) = 1, Dy(pi/a) = 0'</span>)
</pre><pre class="codeoutput"> 
y =
 
(1/exp(a*t*i))/2 + exp(a*t*i)/2
 
</pre><p>次のような非線型微分方程式は、2 つの解をベクトルで生成します。</p><pre class="codeinput">y = dsolve(<span class="string">'(Dy)^2 + y^2 = 1'</span>,<span class="string">'y(0) = 0'</span>)
</pre><pre class="codeoutput"> 
y =
 
   cosh((pi*i)/2 + t*i)
 cosh(- (pi*i)/2 + t*i)
   cosh((pi*i)/2 + t*i)
 cosh((pi*i)/2 + t*i)
 
</pre><p class="footer">Copyright 1993-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Solving Equations % %  Copyright 1993-2009 The MathWorks, Inc. %  $Revision: 1.1.4.9.2.1 $  $Date: 2010/07/29 21:29:30 $  %% % The "solve" and "dsolve" functions seek analytic solutions % to algebraic and ordinary differential equations.  %% % % The first example is a simple quadratic. % You can either find the zeros of a symbolic expression, without quotes:  syms a b c x x = solve(a*x^2 + b*x + c);  %% % % Or, you can find the roots of an equation, given in quotes:  x = solve('a*x^2 + b*x + c = 0');  %% % % Both of these produce the same result:  x  %% % The solution to a general cubic is:  x = solve('a*x^3 + b*x^2 + c*x + d')  pretty(x)  %% % The statement  x = solve('p*sin(x) = r');  %% % % chooses 'x' as the unknown and returns  x  %% % A system of two quadratic equations in two unknowns produces solution vectors.  [x,y] = solve('x^2 + x*y + y = 3','x^2 - 4*x + 3 = 0')  %% % The solution can also be returned in a structure.  S = solve('x^2 + x*y + y = 3','x^2 - 4*x + 3 = 0') S.x S.y  %% % The next example regards 'a' as a parameter and solves two % equations for u and v.  [u,v] = solve('a*u^2 + v^2 = 0','u - v = 1')  %% % Add a third equation and solve for all three unknowns.  [a,u,v] = solve('a*u^2 + v^2','u - v = 1','a^2 - 5*a + 6')  %% % If an analytic solution cannot be found, "solve" returns a numeric solution.  digits(32) [x,y] = solve('sin(x+y)-exp(x)*y = 0','x^2-y = 2')  %% % Similar notation, with "D" denoting differentiation, is used % for ordinary differential equations by the "dsolve" function.  y = dsolve('Dy = -a*y')  %% % Specify an initial condition.  y = dsolve('Dy = -a*y','y(0) = 1')  %% % The second derivative is denoted by "D2'.  y = dsolve('D2y = -a^2*y', 'y(0) = 1, Dy(pi/a) = 0')  %% % A nonlinear equation produces two solutions in a vector.  y = dsolve('(Dy)^2 + y^2 = 1','y(0) = 0')   displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>