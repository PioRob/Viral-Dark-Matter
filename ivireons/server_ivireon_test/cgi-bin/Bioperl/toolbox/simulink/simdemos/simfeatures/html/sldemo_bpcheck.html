
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Using the Prelookup and Interpolation Blocks</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-07-08"><meta name="DC.source" content="sldemo_bpcheck.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">sldemo_bpcheck.mdl</div><div class="right"><a href="matlab:sldemo_bpcheck">Open this model</a></div></div><div class="content"><h1>Using the Prelookup and Interpolation Blocks</h1><!--introduction--><p>The Prelookup block allows you to minimize the number of index searches performed across a set of look-up tables and also to mix clipping, extrapolation, and index search algorithms within one table calculation.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Introduction</a></li><li><a href="#4">Optimization: PreLookup + Interpolation Using Prelookup Blocks</a></li><li><a href="#6">Optimization: Sub-table selection option in the Interpolation Using Prelookup Blocks</a></li><li><a href="#10">Breakpoint and Table Data Consistency Checking</a></li></ul></div><h2>Introduction<a name="1"></a></h2><p>This model uses Prelookup and Interpolation Using Prelookup blocks. Note how the Prelookup blocks perform the index search portion of the computation and the Interpolation Using Prelookup blocks perform the rest:</p><p><a href="matlab:open_system('sldemo_bpcheck')">Open the model</a></p><img vspace="5" hspace="5" src="sldemo_bpcheck_01.png" alt=""> <p>These blocks can be found in the Simulink&reg; block library in the Lookup Tables sub-library:</p><img vspace="5" hspace="5" src="sldemo_bpcheck_02.png" alt=""> <h2>Optimization: PreLookup + Interpolation Using Prelookup Blocks<a name="4"></a></h2><p>Use of the PreLookup block should be considered for tables with intensive index searches in breakpoint sets.  The Prelookup blocks allow you to perform an index search once and reuse the result in many table lookups.  In this model, 3 index search results are used in 5 blocks in a total of 10 uses.  Equivalent regular lookup tables such as the example to the right would have required 10 index searches instead of 3.</p><img vspace="5" hspace="5" src="sldemo_bpcheck_03.png" alt=""> <h2>Optimization: Sub-table selection option in the Interpolation Using Prelookup Blocks<a name="6"></a></h2><p>One of the Interpolation blocks in this model is configured using a capability: trailing dimensions of an n-D table can be marked as "selection dimensions", meaning that the input for that dimension is an integer used only to make a sub-table selection, such as picking a 2-D plane from a 3-D table.  The sub-table is then interpolated normally.</p><p>Interpolation of sub-tables can save tremendous amounts of computation. For every dimension eliminated from interpolation, the computation almost halves.  Since an N-dimensional interpolation takes (2^N)-1 individual interpolation operations (y? = ylow + f*(yhigh-ylow)), even just one dimension of selection can almost double the speed of the interpolation. Extreme example: a 5-D table with 3 dimensions of sub-table selection and 2-D interpolation: 5-D interpolation would take 2^5-1 = 31 interpolations, but a 2-D interpolation takes only 2^2 - 1 = 3.</p><p>The selection ports support vectorization to allow multiple sub-table selection / interpolations in a single block.</p><img vspace="5" hspace="5" src="sldemo_bpcheck_04.png" alt=""> <p>The sub-table or multi-table mode of operation is activated by setting a positive integer for the Number of sub-table selections dimensions parameter in the block's parameter dialog.  The number you set is interpreted as the number of dimensions to select from the highest dimensions.  For example, if you have a 3-D table and choose 2, that means the first dimension will be interpolated and dimensions 2 and 3 will be selected:</p><p>NOTE: you can remove highlighting from a model using the View / Remove highlighting menu item or this command:</p><pre> set_param(mdl,'HiliteAncestors','none')</pre><h2>Breakpoint and Table Data Consistency Checking<a name="10"></a></h2><p>Using Prelookup and Interpolation Using Prelookup blocks introduces a need to ensure that the length of the 'Breakpoint data' parameter in the Prelookup blocks matches the corresponding dimension of the 'Table data' parameter in the connected Interpolation Using Prelookup blocks. Simulink always checks the consistency between the two blocks when updating the block diagram. Simulink reports errors if it encounters inconsistent breakpoint and table data. For example:</p><pre> try
     evalc(['sim(', mdl, ')']);
 catch E
     disp(['Error:', E.message]);
 end</pre><pre class="codeoutput">Error:The range of values for input port k2 of block 'sldemo_bpcheck/Interpolation on an 11x11 table ERROR IN DIM 2 ' does not match the size of the corresponding table dimension.
</pre><p class="footer">Copyright 1990-2009 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Using the Prelookup and Interpolation Blocks
% The Prelookup block allows you to minimize the number of index 
% searches performed across a set of look-up tables and also 
% to mix clipping, extrapolation, and index search algorithms within 
% one table calculation.  
%

%   Copyright 1990-2009 The MathWorks, Inc.
%   $Revision: 1.1.6.1 $  $Date: 2009/11/13 05:06:29 $

%% Introduction 
% This model uses Prelookup and Interpolation Using Prelookup blocks. Note how 
% the Prelookup blocks perform the index search portion of the computation 
% and the Interpolation Using Prelookup blocks perform the rest:
%
% <matlab:open_system('sldemo_bpcheck') Open the model>
mdl = 'sldemo_bpcheck';
open_system(mdl)

%%

close_system(mdl)

%%
% These blocks can be found in the Simulink(R) block library in
% the Lookup Tables sub-library:

open_system('simulink')
open_system(sprintf('simulink/Lookup\nTables'),'simulink','replace')
hilite_system([ gcs, sprintf('/Prelookup')], 'different')
hilite_system([ gcs, sprintf('/Interpolation\nUsing Prelookup')], 'different')

%% Optimization: PreLookup + Interpolation Using Prelookup Blocks
% Use of the PreLookup block should be considered for tables with 
% intensive index searches in breakpoint sets.  The Prelookup blocks 
% allow you to perform an index search once and reuse the 
% result in many table lookups.  In this model, 3 index search results 
% are used in 5 blocks in a total of 10 uses.  Equivalent regular lookup 
% tables such as the example to the right would have required 10 index 
% searches instead of 3.

open_system(mdl)
preblks = find_system('sldemo_bpcheck','BlockType','PreLookup');
for k=1:length(preblks)
    hilite_system( preblks{k}, 'different' );
end

%%

close_system(mdl)
close_system('simulink')

%% Optimization: Sub-table selection option in the Interpolation Using Prelookup Blocks
% One of the Interpolation blocks in this model is configured using
% a capability: trailing dimensions of an n-D table can be marked as 
% "selection dimensions", meaning that the input for that dimension is 
% an integer used only to make a sub-table selection, such as picking 
% a 2-D plane from a 3-D table.  The sub-table is then interpolated 
% normally.
%
% Interpolation of sub-tables can save tremendous amounts of computation.
% For every dimension eliminated from interpolation, the computation 
% almost halves.  Since an N-dimensional interpolation takes (2^N)-1
% individual interpolation operations (y? = ylow + f*(yhigh-ylow)), even 
% just one dimension of selection can almost double the speed of the 
% interpolation. Extreme example: a 5-D table with 3 dimensions of 
% sub-table selection and 2-D interpolation: 5-D interpolation would 
% take 2^5-1 = 31 interpolations, but a 2-D interpolation takes 
% only 2^2 - 1 = 3.
%
% The selection ports support vectorization to allow multiple sub-table 
% selection / interpolations in a single block. 

open_system(mdl)
subblk = find_system('sldemo_bpcheck', ...
                      'BlockType',         'Interpolation_n-D',...
                      'NumSelectionDims', '1' );
hilite_system( subblk{1}, 'different' );

%%
% The sub-table or multi-table mode of operation is activated by setting
% a positive integer for the Number of sub-table selections dimensions 
% parameter in the block's parameter dialog.  The number you set is 
% interpreted as the number of dimensions to select from the highest
% dimensions.  For example, if you have a 3-D table and choose 2, that
% means the first dimension will be interpolated and dimensions 2 and 3
% will be selected:

open_system( subblk{1} )

%%

close_system( subblk{1} )

%%
% NOTE: you can remove highlighting from a model using 
% the View / Remove highlighting menu item or this command:
%
%   set_param(mdl,'HiliteAncestors','none')
set_param(mdl,'HiliteAncestors','none')

%% Breakpoint and Table Data Consistency Checking
%
% Using Prelookup and Interpolation Using Prelookup blocks introduces a need to ensure 
% that the length of the 'Breakpoint data' parameter in the Prelookup blocks matches the 
% corresponding dimension of the 'Table data' parameter in the connected Interpolation Using
% Prelookup blocks. Simulink always checks the consistency between the two blocks when updating 
% the block diagram. Simulink reports errors if it encounters inconsistent breakpoint and 
% table data. For example:
% 
%   try
%       evalc(['sim(', mdl, ')']);
%   catch E
%       disp(['Error:', E.message]);
%   end
%
try
    evalc(['sim(', mdl, ')']);
catch E
    disp(['Error:', E.message]);
end


displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
--></body></html>