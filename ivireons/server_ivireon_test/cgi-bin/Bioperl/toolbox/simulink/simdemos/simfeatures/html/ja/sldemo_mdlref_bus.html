
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>バス オブジェクトを使ったインターフェイス指定</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="sldemo_mdlref_bus.m"><link rel="stylesheet" type="text/css" href="../../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">sldemo_mdlref_bus.mdl</div><div class="right"><a href="matlab:sldemo_mdlref_bus">このモデルを開く</a></div></div><div class="content"><h1>Bus オブジェクトを使ったインターフェイス指定</h1><!--introduction--><p>このデモでは、バス信号を参照モデルに伝播する方法を説明します。また、親モデルからのログ信号データを使用して参照モデルを個別にシミュレートする方法も示します。(モデル参照の簡単な紹介は、<a href="sldemo_mdlref_basic.html">モデル参照によるコンポーネントベースのモデル化</a> を参照してください。データのログを作成するための信号の設定の詳細は、Simulink&reg; ドキュメンテーションを参照してください。)</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">デモ モデルを開く</a></li><li><a href="#2">デモの要件</a></li><li><a href="#3">デモ用のバス信号設定の説明</a></li><li><a href="#4">シミュレートして出力を表示</a></li><li><a href="#5">スタンドアロン アプリケーション用のコード生成 (Real-Time Workshop&reg; が必要)</a></li><li><a href="#6">終了</a></li></ul></div><h2>デモ モデルを開く<a name="1"></a></h2><p><a href="matlab:open_system('sldemo_mdlref_bus');">デモ モデルを開く</a></p><img vspace="5" hspace="5" src="../sldemo_mdlref_bus_01.png" alt=""> <h2>デモの要件<a name="2"></a></h2><p>このデモの実行中、現在の作業ディレクトリ内に作成された Simulink プロジェクト ディレクトリにコードが生成される場合があります。このディレクトリにファイルを生成したくない (または生成できない) 場合は、作業ディレクトリを適切なディレクトリに変更する必要があります。スタンドアロン アプリケーションで配布されるようにするために、Real-Time Workshop でモデル参照の Real-Time Workshop ターゲットが生成される必要があります。</p><h2>デモ用のバス信号設定の説明<a name="3"></a></h2><p>このモデル <tt>sldemo_mdlref_bus</tt> には、単純なカウンターのモデル <tt>sldemo_mdlref_counter_bus</tt> を参照する Model ブロック CounterA が含まれています。COUNTERBUS と呼ばれるバス信号により、データと、このカウンターの飽和の上限および下限が、モデルに入力されます。COUNTERBUS には、データと LIMITBUS の 2 つの信号が含まれています。データ信号はカウントに使用され、LIMITBUS にはカウンターの上限値および下限値が含まれています。COUNTERBUS の構造は以下のとおりです。</p><pre>  <pre>  * COUNTERBUS (バス信号)
             	* データ
             	* LIMITBUS (バス信号)
                       * upper_saturation_limit
                       * lower_saturation_limit</pre></pre><p>このデモには <tt>sldemo_mdlref_counter_bus.mat</tt> という名前の MAT ファイルも含まれています。このファイルにより、COUNTERBUS および LIMITBUS の要素を定義する Bus オブジェクトが作成されます。このモデルが読み込まれると、<tt>sldemo_mdlref_bus</tt> のプリロード関数によってこの MAT ファイルが読み込まれ、Bus オブジェクトが MATLAB&reg; ワークスペースに作成されます。</p><p><b>メモ:</b> モデル エクスプローラーで MATLAB ワークスペースを選択することにより、これらのオブジェクトを表示できます。バス エディターでバスの構造体を表示することもできます。MATLAB コマンド プロンプトで <tt>buseditor</tt> と入力することにより、バス エディターを開くことができます。これらの Bus オブジェクトは、以下の Bus Creator ブロックの出力を指定するために使用されます。</p><div><ul><li>COUNTERBUSCreator</li><li>LIMITBUSCreator</li></ul></div><p>参照モデル <tt>sldemo_mdlref_counter_bus</tt> の Inport によって、COUNTERBUS バス オブジェクトが <b>[入力バスを有効にするための Bus オブジェクト]</b> フィールドで指定され、パラメーター ダイアログの <b>[信号の指定]</b> タブの <b>[Bus オブジェクトによりプロパティを指定]</b> オプションがオンになり、端子が COUNTERBUS タイプのバスを受け入れるように設定されます。</p><p>COUNTERBUS 信号は <tt>sldemo_mdlref_bus</tt> で信号のログを作成するマーカーが指定されています。このモデルをシミュレートすると、ログが作成された信号は <tt>topOut</tt> という変数の MATLAB ワークスペースで使用可能になります。参照モデル <tt>sldemo_mdlref_counter_bus</tt> は、ログが作成された信号データをルートの Inport ブロックを通じて読み込むように設定されています。これがどのように行われるかを見るには、参照モデルの [コンフィギュレーション パラメーター] ダイアログを開き、<b>[データのインポート/エクスポート]</b> タブをクリックします。このダイアログの <b>[インポート]</b> フィールドは、ログ データ <tt>topOut</tt> が読み込まれるように設定されています。</p><h2>シミュレートして出力を表示<a name="4"></a></h2><p>これで、<a href="matlab:sim('sldemo_mdlref_bus')">sldemo_mdlref_bus をシミュレート</a> し、Scope ウィンドウで出力を表示することができます。</p><p>ログが作成された信号データは、変数 <tt>topOut</tt> の下の MATLAB ワークスペースにあるはずです。参照モデル <tt>sldemo_mdlref_counter_bus</tt> により、上記のようにログが作成された TimeSeries データが読み込まれます。</p><p><a href="matlab:open_system('sldemo_mdlref_counter_bus');">参照モデル sldemo_mdlref_counter_bus を開く</a></p><p><a href="matlab:sim('sldemo_mdlref_counter_bus')">sldemo_mdlref_counter_bus をシミュレート</a> し、Scope ウィンドウで出力を表示することができます。<tt>sldemo_mdlref_bus</tt> と <tt>sldemo_mdlref_counter_bus</tt> からの Scope に同じトレースが表示されます。参照モデルの Scope に入力する信号もログが作成されます。ログが作成されたデータは、変数 <tt>subOut</tt> の下の MATLAB ワークスペースにあります。<tt>topOut</tt> と <tt>subOut</tt> のデータが同じであることを検証できます。</p><h2>スタンドアロン アプリケーション用のコード生成 (Real-Time Workshop&reg; が必要)<a name="5"></a></h2><p><a href="matlab:slbuild('sldemo_mdlref_bus','StandaloneRTWTarget')">実行可能ファイルを作成</a>し、<tt>sldemo_mdlref_bus</tt> のコードを調べます。</p><h2>終了<a name="6"></a></h2><p><a href="matlab:close_system('sldemo_mdlref_counter_bus',0);close_system('sldemo_mdlref_bus',0);"><tt>sldemo_mdlref_counter_bus</tt> と <tt>sldemo_mdlref_bus</tt> を閉じます</a>。</p><p class="footer">Copyright 1990-2007 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Interface Specification Using Bus Objects % This demo explains how to propagate bus signals into referenced % models. It also shows how the referenced models can be simulated independently using  % logged signal data from the parent model. (For a quick introduction to Model Reference,  % see <sldemo_mdlref_basic.html Component-Based Modeling with Model Reference>. See Simulink(R) % documentation for more information about configuring signals for data logging.)  % Copyright 1990-2007 The MathWorks, Inc. % $Revision: 1.1.4.10.2.1 $  $Date: 2010/07/29 21:29:17 $   %% Open The Demo Model % <matlab:open_system('sldemo_mdlref_bus'); Open the demo model> tmpdir = tempname; mkdir(tmpdir); origdir = cd(tmpdir); open_system('sldemo_mdlref_bus'); [c] = evalc('set_param(''sldemo_mdlref_bus'',''SimulationCommand'',''update'');'); cd(origdir);   %% Demo Requirements % During this demo, Simulink and Real-Time Workshop(R) may generate code % in a Simulink project directory created in the current working directory. % If you do not want to (or cannot) generate files in this % directory, you should change the working directory to a suitable directory.     % Real-Time Workshop is required to generate Model Reference Real-Time  % Workshop target to be deployed in standalone applications.     % %% Description of Bus Signal Setup for the Demo % This model, |sldemo_mdlref_bus| contains a Model block, CounterA, that  % references |sldemo_mdlref_counter_bus|, a model of a simple counter. A bus  % signal called COUNTERBUS feeds the data and the saturation limits of the % counter into the model. COUNTERBUS contains two signals:  the % data and LIMITBUS. The data signal is used in counting, and  % LIMITBUS contains the upper and lower limit values of the counter. % The following shows the structure of COUNTERBUS:  % %    * COUNTERBUS (bus signal) %               * data %               * LIMITBUS (bus signal)  %                         * upper_saturation_limit  %                         * lower_saturation_limit         % % The demo also includes a MAT-file named |sldemo_mdlref_counter_bus.mat| % that creates bus objects that define the elements of COUNTERBUS % and LIMITBUS. The preload function of |sldemo_mdlref_bus|  % loads this MAT-file when the model is loaded, causing the bus  % objects to be created in the MATLAB(R) workspace.      % % *Note:* You can view these objects by selecting the MATLAB workspace in the % Model Explorer. You can also view the bus structures in the Bus % Editor. You can open the bus editor by typing |buseditor| at the MATLAB % command prompt. The model uses these bus objects to specify the outputs of the % following Bus Creator Blocks:   % % * COUNTERBUSCreator  % * LIMITBUSCreator % % The Inport of the referenced model |sldemo_mdlref_counter_bus| specifies % the COUNTERBUS bus object in its *Bus object for validating input % bus* field and enables the *Specify properties via bus object* option in the % *Signal specification* tab of the parameter dialog, thereby configuring % the port to accept buses of the COUNTERBUS type.      % % Note that the COUNTERBUS signal in |sldemo_mdlref_bus| has been marked for signal logging.  % When the model is simulated, the logged signal will be available in the MATLAB workspace in a  % variable called |topOut|. The referenced model |sldemo_mdlref_counter_bus| has % been configured to read the logged signal data through the root Inport block. % You can see how this is done by opening the Configuration Parameters % dialog of the referenced model and selecting the *Data Inport/Export* tab. The *Inport* % field in the dialog is configured to read the logged data |topOut|.  %% Simulate and View the Output % Now you can <matlab:sim('sldemo_mdlref_bus') simulate sldemo_mdlref_bus>  % to see the output in the scope window. % % The logged signal data should be available in the MATLAB workspace under % the variable |topOut|. The referenced model |sldemo_mdlref_counter_bus| reads the % logged TimeSeries data as described above.  % % <matlab:open_system('sldemo_mdlref_counter_bus'); Open the referenced model sldemo_mdlref_counter_bus> % % You can <matlab:sim('sldemo_mdlref_counter_bus')  % simulate sldemo_mdlref_counter_bus> to see the output in the scope % window. The scope from |sldemo_mdlref_bus| and |sldemo_mdlref_counter_bus| % will show the same trace. The signal feeding the scope in the referenced model % is also logged. The logged data will be available in the MATLAB workspace % under the variable |subOut|. You can verify that the data in |topOut| and % |subOut| is the same.  %% Code Generation For Standalone Applications (Requires Real-Time Workshop(R))  % <matlab:slbuild('sldemo_mdlref_bus','StandaloneRTWTarget') Create the % executable> and inspect the code for |sldemo_mdlref_bus|.      %% Exit % <matlab:close_system('sldemo_mdlref_counter_bus',0);close_system('sldemo_mdlref_bus',0); Close % |sldemo_mdlref_counter_bus| and |sldemo_mdlref_bus|>.     bdclose all clear mex rmdir(tmpdir,'s'); clear tmpdir origdir ##### SOURCE END ##### --></body></html>