
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>シミュレーションベースの手法を使った周波数応答の推定</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="scdenginepad.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit scdenginepad">エディターで scdenginepad.m を開く</a></div><div class="right"><a href="matlab:echodemo scdenginepad">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>シミュレーションベースの手法を使った周波数応答の推定</h1><!--introduction--><p>このデモでは、線形化パスのイベントベースのダイナミクスによって、ブロックごとの解析的な線形化から正確な解が得られない場合に Simulink&reg; モデルの周波数応答を取得する方法を説明します。そのようなシステムには、Triggered Subsystem を持つモデルやパルス幅変調 (PWM) の入力信号を使用したモデルなどがあります。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">手順 1: モデルを開く</a></li><li><a href="#2">手順 2: Sinestream の入力信号を使用した周波数応答の推定</a></li><li><a href="#7">手順 3: チャープ入力信号を使用した周波数応答の推定</a></li></ul></div><h2>手順 1: モデルを開く<a name="1"></a></h2><p>エンジン タイミング用の Simulink&reg; モデルを開きます。このモデルをスロットル角からエンジン スピードまでブロックごとに解析的な線形化を行うと、線形化パスの Triggered Subsystem による &quot;圧縮&quot; によって、線形化の結果がゼロになります。</p><pre class="codeinput">scdengine
mdl = <span class="string">'scdengine'</span>;
io = getlinio(mdl);
linsys = linearize(mdl,io)
</pre><pre class="codeoutput"> 
d = 
                ThrottleAngl
   EngineSpeed             0
 
Static gain.
</pre><img vspace="5" hspace="5" src="../scdenginepad_01.png" alt=""> <h2>手順 2: Sinestream の入力信号を使用した周波数応答の推定<a name="2"></a></h2><p>Sinestream の入力信号は、FRESTIMATE を使用した Simulink&reg; モデルの正確な周波数応答を推定するうえで最も信頼性の高い入力信号です。これは、互いの末尾に追加される個々の正弦波信号で構成される信号です。FRESTIMATE コマンドは、&quot;Frequency&quot; パラメーターで指定された sinestream の入力信号の各周波数と、&quot;NumPeriods&quot; パラメーターで指定された対応する期間に対してモデルをシミュレートします。シミュレーションが終了したら、FRESTIMATE は出力信号を使用して、各周波数で応答を計算します。FRESTIMATE は、システムが &quot;SettlingPeriods&quot; パラメーターで指定された、その入力信号の定常状態に到達した後の期間のみを使用することに注意してください。0.1 ～ 10 rad/s の対数的に等間隔な異なる周波数を使用して sinestream 信号を作成します。</p><pre class="codeinput">in = frest.Sinestream(<span class="string">'Frequency'</span>,logspace(-1,1,50),<span class="string">'Amplitude'</span>,1e-3)
</pre><pre class="codeoutput"> 
The sinestream input signal:
 
      Frequency           : [0.1 0.10985 0.12068 0.13257 ...] (rad/s)
      Amplitude           : 0.001
      SamplesPerPeriod    : 40
      NumPeriods          : 4
      RampPeriods         : 0
      FreqUnits (rad/s,Hz): rad/s
      SettlingPeriods     : 1
      ApplyFilteringInFRESTIMATE (on/off)    : on
      SimulationOrder (Sequential/OneAtATime): Sequential
 
</pre><p>既定の設定では、sinestream の入力信号の各周波数は、4 つの期間に対してシミュレートされることに注意してください。つまり、&quot;NumPeriods&quot; はすべての周波数に対して 4 であり、最初の期間の最後はシステムが定常状態に到達するように指定されます。すなわち、&quot;SettlingPeriods&quot; はすべての周波数に対して 1 であるため、FRESTIMATE は出力信号の最後の 3 つの期間を使用します。</p><p>この sinestream の入力信号を使用し、FRESTIMATE コマンドを使用して周波数応答を推定し、結果の周波数応答データをプロットします。</p><pre class="codeinput">[sys,simout] = frestimate(mdl,io,in);
bode(sys)
</pre><img vspace="5" hspace="5" src="../scdenginepad_02.png" alt=""> <p>FRESTIMATE シミュレーション結果のビューアを使用して、推定結果を調べることができます。 ビューアには、選択した周波数に対する時間領域および周波数領域のシミュレーション結果と、周波数を対話形式で切り替えることができる概要ボード線図が表示されます。 sinestream 信号の周波数は、すべてのプロットで色分けされます。</p><pre class="codeinput">frest.simView(simout,in,sys);
</pre><img vspace="5" hspace="5" src="../scdenginepad_03.png" alt=""> <p>ビューアは、問題を診断するツールとして使用できます。 周波数応答の推定の精度に影響を与える問題には、次のようなものがあります。</p><div><ul><li>定常状態に到達しない</li><li>非線形性の励起</li><li>不安定になる</li></ul></div><h2>手順 3:  チャープ入力信号を使用した周波数応答の推定<a name="7"></a></h2><p>Simulink&reg; モデルから周波数応答データを推定するときに使用できる別の入力信号は、周波数チャープです。 周波数チャープは、周波数が即座に変化する sinestream とは異なります。</p><p>チャープ入力信号を使用すると、周波数応答の推定を迅速に取得できます。 ただし、チャープ入力を使用して取得された周波数推定結果は、sinestream 入力を使用して取得された結果ほどの信頼性はありません。これは、各周波数が、システムがその周波数で定常状態になるまでの十分な時間シミュレートされないためです。 周波数 0.1 ～ 10 rad/s を対数的にスイープするチャープ信号を作成します。</p><pre class="codeinput">in_chirp = frest.Chirp(<span class="string">'FreqRange'</span>,[0.1 10],<span class="string">'Amplitude'</span>,1e-3,<span class="keyword">...</span>
    <span class="string">'SweepMethod'</span>,<span class="string">'logarithmic'</span>,<span class="string">'NumSamples'</span>,3000);
</pre><p>チャープ信号を使用して、周波数応答推定を実行します。</p><pre class="codeinput">sys_chirp = frestimate(mdl,io,in_chirp);
</pre><p>sinestream の入力信号とチャープ入力信号を一緒に使用して取得された結果をプロットします。</p><pre class="codeinput">bode(sys,sys_chirp,<span class="string">'r'</span>)
</pre><img vspace="5" hspace="5" src="../scdenginepad_04.png" alt=""> <p>モデルを閉じます。</p><pre class="codeinput">bdclose(<span class="string">'scdengine'</span>);
</pre><p class="footer">Copyright 2005-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Frequency Response Estimation Using Simulation-Based Techniques % Copyright 2005-2009 The MathWorks, Inc. % $Revision: 1.1.4.2.2.1 $ $Date: 2010/07/29 21:29:23 $ % % This demo illustrates how to obtain the frequency % response of Simulink(R) models when analytical block-by-block % linearization does not provide accurate answer due to event-based dynamics % in the linearization path. Examples of such systems are models with % triggered subsystems or models using Pulse Width Modulation(PWM) input % signals.   %% Step 1: Opening the Model % Open the Simulink(R) model for engine timing. Note       % that analytical block-by-block linearization of this model from throttle angle % to engine speed gives a linearization result of zero due to the triggered % subsystem "Compression" in the linearization path. scdengine mdl = 'scdengine'; io = getlinio(mdl); linsys = linearize(mdl,io)  %% Step 2: Estimating Frequency Response Using Sinestream Input Signal % Sinestream input signal is the most reliable input signal for estimating an % accurate frequency response of a Simulink(R) model using FRESTIMATE. It % is a signal that is composed of individual sinusoidal signals that are % appended to the end of each other. FRESTIMATE command simulates the model % for each frequency in the sinestream input signal, specified in % "Frequency" parameter, for the corresponding amount of periods, specified % in "NumPeriods" parameter. After the simulation, FRESTIMATE uses the output signal to compute % the response at each frequency. Note that FRESTIMATE uses only the  % periods after the system reaches to steady state for that input % frequency, specified in "SettlingPeriods" parameter. Create a % sinestream signal with logarithmically-spaced distinct  % frequencies between 0.1 and 10 rad/s: in = frest.Sinestream('Frequency',logspace(-1,1,50),'Amplitude',1e-3)  %% % Note that by default, each frequency in sinestream input signal is % simulated for 4 periods, i.e. "NumPeriods" is 4 for all frequencies, and % the end of first period is specified to be where the system reaches to % steady state, i.e. "SettlingPeriods" is 1 for all frequencies, thus % FRESTIMATE uses the last 3 periods of the output signals.  %% % Using this sinestream input signal, perform the % frequency response estimation using FRESTIMATE command and plot the % resulting frequency response data: [sys,simout] = frestimate(mdl,io,in); bode(sys)  %% % You can inspect the estimation results using the FRESTIMATE Simulation Results % Viewer. The viewer shows time-domain and frequency-domain simulation results % for the selected frequency(s) and a summary bode plot where you can % interactively switch between frequencies. The frequencies of the sinestream % signal are color-coded in all plots. frest.simView(simout,in,sys);  %% % You can use the viewer as a tool to diagnose issues. Examples of issues % that impact the accuracy of the frequency response estimation include: % % * Not reaching steady state % * Excitation of nonlinearities % * Running into instabilities %  %% Step 3: Estimating Frequency Response Using Chirp Input Signal % Another input signal you can use when estimating frequency response data from a % Simulink(R) model is frequency chirp. Frequency chirp differs from % sinestream in that the frequency is instantenously varied.  %% % You can use chirp input signals to obtain quicker frequency % response estimation. However, the frequency estimation results obtained % with chirp input could be less reliable than the ones obtained with % sinestream input because each frequency is not simulated long enough to % drive the system to steady state at that frequency. Create a chirp signal     % that sweeps between the frequencies 0.1 and 10 rad/s logarithmically: in_chirp = frest.Chirp('FreqRange',[0.1 10],'Amplitude',1e-3,...     'SweepMethod','logarithmic','NumSamples',3000);  %% % Using the chirp signal, perform the frequency response estimation: sys_chirp = frestimate(mdl,io,in_chirp);  %% % Plot the results obtained with sinestream and chirp input signals % together: bode(sys,sys_chirp,'r')  %% % Close the model: bdclose('scdengine'); displayEndOfDemoMessage(mfilename)                  ##### SOURCE END ##### --></body></html>