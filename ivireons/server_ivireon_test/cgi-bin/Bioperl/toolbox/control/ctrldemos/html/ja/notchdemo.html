
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>ノッチ フィルターの離散化</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="notchdemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit notchdemo">エディターで notchdemo.m を開く</a></div><div class="right"><a href="matlab:echodemo notchdemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>ノッチ フィルターの離散化</h1><!--introduction--><p>制御システムのコンポーネントはしばしば連続時間において設計されますが、それらは一般的に、デジタル コンピューターや組み込みプロセッサー上で実装するために離散化されなければなりません。このデモでは、ノッチ フィルターを離散化するためのさまざまな手法を比較します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">連続時間ノッチ フィルター</a></li><li><a href="#3">離散化方法の選択</a></li><li><a href="#8">サンプリング レートの選択</a></li><li><a href="#10">対話型 GUI</a></li></ul></div><h2>連続時間ノッチ フィルター<a name="1"></a></h2><p>ノッチ フィルターは、特定の周波数におけるゲインを急激に減衰させることによって、その周波数の信号成分を拒否するように設計されています。このデモでは、次のノッチ フィルターを想定します。</p><p><img src="../notchdemo_eq52640.png" alt="$$ H(s) = {s^2 + 0.5 s + 100 \over s^2 + 5 s + 100} $$"></p><p><tt>bode</tt> コマンドを使用すると、このフィルターの周波数応答をプロットできます。</p><pre class="codeinput">H = tf([1 0.5 100],[1 5 100]);
bode(H), grid
</pre><img vspace="5" hspace="5" src="../notchdemo_01.png" alt=""> <p>このノッチ フィルターでは、周波数 w = 1 rad/sec において 20dB の減衰が生じます。</p><h2>離散化方法の選択<a name="3"></a></h2><p><tt>c2d</tt> コマンドを使用すると、連続時間システムを離散化できます。Control System Toolbox™ では、以下をはじめとした離散化アルゴリズムがサポートされています。</p><div><ul><li>ゼロ次ホールド</li><li>1 次ホールド</li><li>インパルス不変応答法</li><li>Tustin (双一次近似)</li><li>周波数プリワーピングを持つ Tustin 変換</li><li>極と零点のマッチング法</li></ul></div><p>どの方法を選択すべきかは、適用性や要件によって決まります。</p><p>ゼロ次ホールド方法と 1 次ホールド方法、およびインパルス不変応答法は、時間領域における離散近似に適しています。たとえば、ZOH 離散化のステップ応答は、各時間ステップにおける連続時間ステップ応答と一致します (サンプリング レートに依存しません)。</p><pre class="codeinput">Ts = 0.1;
Hdz = c2d(H,Ts,<span class="string">'zoh'</span>);
step(H,<span class="string">'b'</span>,Hdz,<span class="string">'r'</span>),
legend(<span class="string">'Continuous'</span>,<span class="string">'Discretized at 10 Hz'</span>)
</pre><img vspace="5" hspace="5" src="../notchdemo_02.png" alt=""> <p>同様に、インパルス不変応答法による離散化では、インパルス応答が元のシステムと同じになります。</p><pre class="codeinput">G = tf([1 -3],[1 2 10]);
Gd = c2d(G,Ts,<span class="string">'imp'</span>);
impulse(G,<span class="string">'b'</span>,Gd,<span class="string">'r'</span>)
legend(<span class="string">'Continuous'</span>,<span class="string">'Discretized at 10 Hz'</span>)
</pre><img vspace="5" hspace="5" src="../notchdemo_03.png" alt=""> <p>一方、Tustin 方法とマッチング法は、ゲインと位相ひずみがナイキスト周波数の近傍において少なくなるため、周波数領域において性能が向上する傾向があります。たとえば、ZOH、Tustin、およびマッチング法の各アルゴリズムを使用して、連続時間ノッチ フィルターとその離散化のボード応答を比較します。</p><pre class="codeinput">Hdt = c2d(H,Ts,<span class="string">'tustin'</span>);
Hdm = c2d(H,Ts,<span class="string">'match'</span>);
bode(H,<span class="string">'b'</span>,Hdz,<span class="string">'r'</span>,Hdt,<span class="string">'m'</span>,Hdm,<span class="string">'g'</span>,{1 100}), grid
legend(<span class="string">'Continuous'</span>,<span class="string">'ZOH'</span>,<span class="string">'Tustin'</span>,<span class="string">'Matched'</span>)
</pre><img vspace="5" hspace="5" src="../notchdemo_04.png" alt=""> <p>この比較が示すとおり、マッチング法では、ノッチ フィルターの最も正確な周波数領域近似が得られます。ただし、ノッチ周波数と等しいプリワーピング周波数を指定することで、Tustin アルゴリズムの精度をさらに高めることができます。これにより、w = 10 rad/sec の近傍で正確なマッチングが確実に行われるようになります。</p><pre class="codeinput">Hdp = c2d(H,Ts,<span class="string">'prewarp'</span>,10);
bode(H,<span class="string">'b'</span>,Hdt,<span class="string">'m'</span>,Hdp,<span class="string">'g'</span>,{1 100}), grid
legend(<span class="string">'Continuous'</span>,<span class="string">'Tustin'</span>,<span class="string">'Tustin with prewarping'</span>)
</pre><img vspace="5" hspace="5" src="../notchdemo_05.png" alt=""> <h2>サンプリング レートの選択<a name="8"></a></h2><p>サンプリング レートが高いほど、連続応答と離散化応答がより厳密に一致するようになります。ただし、サンプリング レートはどこまで小さくでき、同様に、サンプリング間隔はどこまで大きくできるでしょうか。大ざっぱに言うと、連続モデルと離散化モデルを周波数 <tt>wm</tt> と厳密に一致させるには、ナイキスト周波数 (サンプリング レート&times; Pi) が <tt>wm</tt> の 2 倍以上であることを確認します。ノッチ フィルターの場合は、10 rad/sec の近傍で形状を維持する必要があるため、ナイキスト周波数を 20 rad/sec より高くして、サンプリング周期が最大 pi/20 = 0.16 s になるようにします。</p><p>この選択肢を確認するには、サンプリング周期を 0.1、0.15、および 0.3 に設定して、一致した離散化を比較します。</p><pre class="codeinput">Hd1 = c2d(H,0.1,<span class="string">'m'</span>);
Hd2 = c2d(H,0.15,<span class="string">'m'</span>);
Hd3 = c2d(H,0.3,<span class="string">'m'</span>);
bode(H,<span class="string">'b'</span>,Hd1,<span class="string">'r'</span>,Hd2,<span class="string">'m'</span>,Hd3,<span class="string">'g'</span>,{1 100}), grid
legend(<span class="string">'Continuous'</span>,<span class="string">'Ts = 0.1'</span>,<span class="string">'Ts = 0.15'</span>,<span class="string">'Ts = 0.3'</span>)
</pre><img vspace="5" hspace="5" src="../notchdemo_06.png" alt=""> <p>予想どおり、離散化は <tt>Ts &lt; 0.16</tt> の場合に精度が高いままになりますが、サンプリング間隔がそれより大きくなると精度が低くなり始めます。</p><h2>対話型 GUI<a name="10"></a></h2><p>対話型 GUI を起動して、離散化アルゴリズムとサンプリング レートの選択内容によって離散化ノッチ フィルターがどのような影響を受けるかを調べるには、次のリンクをクリックしてください。</p><p><a href="matlab:notch_gui">ノッチ離散化 GUI を開く</a></p><pre class="codeinput">notch_gui
</pre><img vspace="5" hspace="5" src="../notchdemo_07.png" alt=""> <p class="footer">Copyright 1986-2007 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Discretizing a Notch Filter % While control system components are often designed in continuous time,  % they must generally be discretized for implementation on digital % computers and embedded processors. This demo compares several techniques % for discretizing a notch filter.  %   Copyright 1986-2007 The MathWorks, Inc. %   $Revision: 1.1.4.2.2.1 $  $Date: 2010/07/29 21:28:40 $  %% Continuous-Time Notch Filter % Notch filters are designed to reject signal content at a specific frequency by sharply % attenuating the gain at that frequency. For this demo we consider the % following notch filter: % % $$ H(s) = {s^2 + 0.5 s + 100 \over s^2 + 5 s + 100} $$ % % You can plot the frequency response of this filter with the |bode| % command: H = tf([1 0.5 100],[1 5 100]); bode(H), grid  %% % This notch filter provides a 20dB attenuation at the frequency w = 1 % rad/s.  %% Choosing the Discretization Method % You can discretize a continuous-time system with the |c2d| command. % Several discretization algorithms are supported by Control System Toolbox(TM), including: % % * Zero-order hold % * First-order hold % * Impulse invariant % * Tustin (bilinear approximation) % * Tustin with frequency prewarping % * Matched poles and zeros % % Which method to choose depends on the application and requirements.  %% % The zero- and first-order % hold methods and the impulse-invariant method are well-suited for discrete  % approximations in the time domain. For example, the step response of the ZOH  % discretization matches the continuous-time step response at each time step  % (independently of the sampling rate): Ts = 0.1; Hdz = c2d(H,Ts,'zoh'); step(H,'b',Hdz,'r'), legend('Continuous','Discretized at 10 Hz')  %%  % Similarly, the impulse-invariant discretization has the same impulse % response as the original system: G = tf([1 -3],[1 2 10]); Gd = c2d(G,Ts,'imp'); impulse(G,'b',Gd,'r') legend('Continuous','Discretized at 10 Hz')  %% % By contrast, the Tustin and Matched methods tend to perform better in the % frequency domain because they introduce less gain and phase distortion near the Nyquist % frequency. For example, compare the Bode responses of the continuous-time % notch filter and its discretizations using the ZOH, Tustin, and Matched % algorithms: Hdt = c2d(H,Ts,'tustin'); Hdm = c2d(H,Ts,'match'); bode(H,'b',Hdz,'r',Hdt,'m',Hdm,'g',{1 100}), grid legend('Continuous','ZOH','Tustin','Matched')  %%  % This comparison indicates that the Matched method provides the most % accurate frequency-domain approximation of the notch filter. However, you % can further improve the accuracy of the Tustin algorithm by specifying a % prewarping frequency equal to the notch frequency. This ensures accurate % match near w = 10 rad/s: Hdp = c2d(H,Ts,'prewarp',10); bode(H,'b',Hdt,'m',Hdp,'g',{1 100}), grid legend('Continuous','Tustin','Tustin with prewarping')   %% Choosing the Sampling Rate % The higher the sampling rate, the closer the match between the % continuous and discretized responses. But how small can the sampling  % rate be, or equivalently, how large can the sampling interval be? % As a rule of thumb, if you want the continuous and discretized models % to match closely up to some frequency |wm|, make sure that the   % Nyquist frequency (sampling rate times Pi) is at least twice |wm|. % For the notch filter, you need to preserve  % the shape near 10 rad/s, so the Nyquist frequency should be beyond  % 20 rad/s, which gives a sampling period of at most pi/20 = 0.16 s.  % % To confirm this choice, compare the matched discretizations with sampling period % 0.1, 0.15, and 0.3: Hd1 = c2d(H,0.1,'m'); Hd2 = c2d(H,0.15,'m'); Hd3 = c2d(H,0.3,'m'); bode(H,'b',Hd1,'r',Hd2,'m',Hd3,'g',{1 100}), grid legend('Continuous','Ts = 0.1','Ts = 0.15','Ts = 0.3')   %%  % As predicted, the discretization remains fairly accurate for  % |Ts < 0.16| but starts breaking down for larger sampling intervals.  %% Interactive GUI % Click on the link below to launch an interactive GUI that further  % demonstrates how the discretized notch filter is affected by  % the choice of discretization algorithm and sampling rate.  % % <matlab:notch_gui Open the Notch Discretization GUI> notch_gui   displayEndOfDemoMessage(mfilename) ##### SOURCE END ##### --></body></html>