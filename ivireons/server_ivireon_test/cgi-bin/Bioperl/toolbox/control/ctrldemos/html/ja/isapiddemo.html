
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>PID チューナーを使用した外乱抑圧用 PID の設計</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="isapiddemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit isapiddemo">エディターで isapiddemo.m を開く</a></div><div class="right"><a href="matlab:echodemo isapiddemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>PID チューナーを使用した外乱抑圧用 PID の設計</h1><!--introduction--><p>PID チューナーとは、PID コントローラー設計用の対話型 GUI ツールです。このデモでは、PID チューナーを使用して、外乱抑圧性能の高い PI コントローラーを設計する方法と、それを ISA-PID コントローラーに拡張して基準追従性能を高める方法を示します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">初期 PID 設計を持つ PID チューナーの起動</a></li><li><a href="#4">外乱抑圧に対する PID の調整</a></li><li><a href="#11">PID コントローラーの ISA-PID コントローラーへの拡張</a></li><li><a href="#14">性能の比較</a></li></ul></div><h2>初期 PID 設計を持つ PID チューナーの起動<a name="1"></a></h2><p>プラント モデルは以下のようになります。</p><p><img src="../isapiddemo_eq91962.png" alt="$$ G(s) = \frac{6(s+5)}{(s+1)(s+2)(s+3)(s+4)}e^{-s} $$"></p><pre class="codeinput">G = zpk(-5,[-1 -2 -3 -4],6,<span class="string">'OutputDelay'</span>,1);
G.InputName = <span class="string">'u'</span>;
G.OutputName = <span class="string">'y'</span>;
</pre><p>次のコマンドを使用して PID チューナーを起動し、プラント G のための並列型 PI コントローラーを設計します。</p><pre> pidtool(G,'pi')</pre><p>PID チューナーにより、初期 PI コントローラーが自動的に設計されます。[パラメーターを表示する] ボタンをクリックして、コントローラーのゲインと性能の判定基準を表示します。</p><p><img vspace="5" hspace="5" src="../../html/isapiddemo1.png" alt=""> </p><p>ステップ基準追従では、整定時間は約 12 秒、オーバーシュートは約 6.3 パーセントで、この例では許容範囲にあります。</p><h2>外乱抑圧に対する PID の調整<a name="4"></a></h2><p>ステップ外乱は、プラント入力で発生すると想定されます。PI コントローラーの主な目的は、この外乱をすばやく抑圧することです。このセクションの残りの部分では、PID チューナーでより優れた外乱抑圧を行う PI コントローラーを設計する方法を示します。また、外乱抑圧性能が向上するにつれて、基準追従性能が低下すると予想されます。</p><p>低周波外乱の減衰は積分ゲイン Ki に反比例するため、積分ゲインを最大化することは、外乱抑圧に優れた PI コントローラーを得るための有益な経験則です。詳細は、Karl Astrom et al., &quot;Advanced PID Control&quot;, Chapter 4 &quot;Controller Design&quot;, 2006, The ISA Society を参照してください。</p><p><b>[応答]</b> を <b>[入力の外乱抑圧]</b> に切り替えます。ピーク偏差は約 1 で、約 9 秒以内に 0.1 未満に整定します。</p><p><img vspace="5" hspace="5" src="../../html/isapiddemo2.png" alt=""> </p><p>応答速度 (開ループ帯域幅) を向上させるため、スライダーを右に移動します。<b>コントローラー パラメーター</b> テーブルの Ki ゲインはまず上がってから下がります。最大値は 0.3 です。Ki が 0.3 になると、ピーク偏差は 0.9 に下がります (約 10% 向上)。そして、約 6.7 秒後に 0.1 未満に整定します (約 25% 向上)。</p><p><img vspace="5" hspace="5" src="../../html/isapiddemo3.png" alt=""> </p><p>応答を <b>[設定値のトラッキング]</b> に戻します。帯域幅を上げたため、ステップ基準追従応答は、より大きく振動します。また、オーバーシュートは 15% を超え、通常は許容範囲外となります。基準追従と外乱抑圧の性能トレードオフとなることはよくありますが、これは単一の PID コントローラーでは両方の設計目標が同時に達成できないためです。</p><p><img vspace="5" hspace="5" src="../../html/isapiddemo4.png" alt=""> </p><p>2 つ目のツールバー ボタンをクリックして、設計した PI コントローラーを MATLAB ワークスペースにエクスポートします。コントローラーは PID オブジェクトによって表現され、次のセクションで ISA-PID コントローラーを作成する際に必要となります。</p><p><img vspace="5" hspace="5" src="../../html/isapiddemo5.png" alt=""> </p><p><b>pid</b> コマンドを使用すれば、MATLAB ワークスペースで同じ PI コントローラーを手動で作成することもできます。このコマンドで、PID チューナーのパラメーター テーブルで取得した Kp ゲインや Ki ゲインを直接指定できます。</p><pre class="codeinput">C = pid(0.64362,0.30314);
C.InputName = <span class="string">'e'</span>;
C.OutputName = <span class="string">'u'</span>;
C
</pre><pre class="codeoutput">Continuous-time PI controller in parallel form, from input &quot;e&quot; to output &quot;u&quot;:
 
           1 
Kp + Ki * ---
           s 
 
with Kp = 0.64362, Ki = 0.30314
 
</pre><h2>PID コントローラーの ISA-PID コントローラへの拡張<a name="11"></a></h2><p>基準追従と外乱抑圧の両方の PI コントローラー性能を向上させる簡単な解決法は、それを ISA-PID コントローラーにアップグレードすることです。これには、基準信号の比例アクションへの影響を個々に制御することを許可する調整パラメーター <b>b</b> が追加提供されているため、基準追従応答が向上します。</p><p><img vspace="5" hspace="5" src="../../html/isapiddemo6.png" alt=""> </p><p>上記の ISA-PID 構造では、フィードバック コントローラー C とフィードフォワード フィルター F があります。この例では、C は、PID オブジェクトで表現可能な標準の並列 PI コントローラーです。</p><p><img src="../isapiddemo_eq34968.png" alt="$$ C(s) = pid(Kp,Ki) = Kp + \frac{Ki}{s} $$"></p><p>F は、C と設定値の重み <b>b</b> の合計からの Kp ゲインと Ki ゲインに関するプレフィルターです。</p><p><img src="../isapiddemo_eq10932.png" alt="$$ F(s) = \frac{b*Kp*s+Ki}{Kp*s+Ki} $$"></p><p>したがって、ISA-PID コントローラーには、入力が 2つ (r および y)、出力が 1 つ (u) あります。</p><p>設定値の重み <b>b</b> は、0 ～ 1 の実数です。これが減少すると、基準追従応答におけるオーバーシュートが削減されます。この例では、<b>b</b> は 0.7 が選択されています。</p><pre class="codeinput">b = 0.7;
<span class="comment">% the following code constructs an ISA-PID from the feedback controller PID</span>
F = tf([b*C.Kp C.Ki],[C.Kp C.Ki]);
F.InputName = <span class="string">'r'</span>;
F.OutputName = <span class="string">'uf'</span>;
Sum = sumblk(<span class="string">'e'</span>,<span class="string">'uf'</span>,<span class="string">'y'</span>,<span class="string">'+-'</span>);
ISAPID = connect(C,F,Sum,{<span class="string">'r'</span>,<span class="string">'y'</span>},<span class="string">'u'</span>);
ISAPID
</pre><pre class="codeoutput"> 
Transfer function from input &quot;r&quot; to output &quot;u&quot;:
0.4505 s^2 + 0.5153 s + 0.1428
------------------------------
        s^2 + 0.471 s
 
Transfer function from input &quot;y&quot; to output &quot;u&quot;:
-0.6436 s - 0.3031
------------------
        s
 
</pre><h2>性能の比較<a name="14"></a></h2><p>ISA-PID コントローラーでは、基準追従応答のオーバーシュートは、より少なくなっています。これは、設定値の重み <b>b</b> により、オーバーシュートが削減されるためです。</p><pre class="codeinput"><span class="comment">% Closed-loop system with PI controller for reference tracking</span>
sys1 = feedback(ss(G)*C,1);
set(sys1,<span class="string">'Name'</span>,<span class="string">'PID'</span>);
<span class="comment">% Closed-loop ISA-PID system with ISA-PID controller for reference tracking</span>
sys2 = connect(ISAPID,ss(G),<span class="string">'r'</span>,<span class="string">'y'</span>);
set(sys2,<span class="string">'Name'</span>,<span class="string">'ISA-PID'</span>);
<span class="comment">% Compare responses</span>
figure;
step(sys1,<span class="string">'r-'</span>,sys2,<span class="string">'b.'</span>);
legend(<span class="string">'show'</span>,<span class="string">'location'</span>,<span class="string">'southeast'</span>)
title(<span class="string">'Reference Tracking'</span>)
</pre><img vspace="5" hspace="5" src="../isapiddemo_01.png" alt=""> <p>設定値の重み <b>b</b> は、基準追従にのみ影響するため、外乱抑圧応答は同じです。</p><pre class="codeinput"><span class="comment">% Closed-loop system with PI controller for disturbance rejection</span>
sysd1 = feedback(ss(G),C);
set(sysd1,<span class="string">'Name'</span>,<span class="string">'PID'</span>);
<span class="comment">% Closed-loop system with ISA-PID controller for disturbance rejection</span>
sys2 = connect(ISAPID,ss(G),<span class="string">'r'</span>,<span class="string">'y'</span>);
set(sysd2,<span class="string">'Name'</span>,<span class="string">'ISA-PID'</span>);
<span class="comment">% Compare responses</span>
figure;
step(sysd1,<span class="string">'r-'</span>,sysd2,<span class="string">'b.'</span>);
legend(<span class="string">'PID'</span>,<span class="string">'ISA-PID'</span>);
title(<span class="string">'Disturbance Rejection'</span>)
</pre><img vspace="5" hspace="5" src="../isapiddemo_02.png" alt=""> <p class="footer">Copyright 2009-2010 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Designing PID for Disturbance Rejection with PID Tuner % PID Tuner is an interactive GUI tool for PID controller design. This demo % shows how to use the PID Tuner to design a PI controller with good % disturbance rejection performance and then extend it to a ISA-PID % controller to enhance reference tracking performance.  %   Copyright 2009-2010 The MathWorks, Inc. %   $Revision: 1.1.2.1 $  $Date: 2010/07/29 21:28:40 $  %% Launching the PID Tuner with Initial PID Design % The plant model is % % $$ G(s) = \frac{6(s+5)}{(s+1)(s+2)(s+3)(s+4)}e^{-s} $$ % G = zpk(-5,[-1 -2 -3 -4],6,'OutputDelay',1); G.InputName = 'u';   G.OutputName = 'y';  %% % Use the following command to launch the PID Tuner to design a PI % controller in parallel form for plant G. % %   pidtool(G,'pi') % % The PID Tuner automatically designs an initial PI controller. Click "Show % parameters" button to display the controller gains and performance % metrics. % % <<../html/isapiddemo1.png>>  %%  % For step reference tracking, the settling time is about 12 seconds and % the overshoot is about 6.3 percent, which is acceptable for this example.  %% Tuning PID for Disturbance Rejection % Assume that a step disturbance occurs at the plant input and the main % purpose of the PI controller is to reject this disturbance quickly. % In the rest of this section, we will demonstrate how to design the PI % controller for better disturbance rejection in the PID Tuner. We also % expect that the reference tracking performance is degraded as disturbance % rejection performance improves.  %% % Because the attenuation of low frequency disturbance is inversely % proportional to integral gain Ki, maximizing the integral gain is a % useful heuristic to obtain a PI controller with good disturbance % rejection. For background, see Karl Astrom et al., "Advanced PID % Control", Chapter 4 "Controller Design", 2006, The ISA Society.  %% % Switch *Response* to *Input disturbance rejection*, The peak deviation is % about 1 and it settles to less than 0.1 in about 9 seconds. % % <<../html/isapiddemo2.png>>  %% % Move the slider to the right to increase the response speed (open loop % bandwidth). The Ki gain in the *Controller parameters* table first % increases and then decreases, with the maximum value occurring at % 0.3. When Ki is 0.3, the peak deviation is reduced to 0.9 (about 10% % improvement) and it settles to less than 0.1 in about 6.7 seconds (about % 25% improvement). % % <<../html/isapiddemo3.png>>  %% % Switch the response back to *Reference tracking*. Because we increase the % bandwidth, the step reference tracking response becomes more oscillated. % Additionally the overshoot exceeds 15 percent, which is usually % unacceptable. This type of performance trade off between reference % tracking and disturbance rejection often exists because a single PID % controller is not able to satisfy both design goals at the same time. % % <<../html/isapiddemo4.png>>  %% % Export the designed PI controller to MATLAB Workspace by clicking the % second toolbar button. The controller is represented by a PID object and % you need it to create an ISA-PID controller in the next section. % % <<../html/isapiddemo5.png>>  %% % You can also manually create the same PI controller in MATLAB Workspace % by using the *pid* command. In this command you can directly specify the % Kp and Ki gains obtained from the parameter table of the PID Tuner. C = pid(0.64362,0.30314); C.InputName = 'e';   C.OutputName = 'u'; C  %% Extending PID controller to ISA-PID Controller  % A simple solution to make a PI controller perform well for both % reference tracking and disturbance rejection is to upgrade it to an % ISA-PID controller. It improves reference tracking response by providing % an additional tuning parameters *b* that allows independent control of % the impact of the reference signal on the proportional action. % % <<../html/isapiddemo6.png>>  %% % In the above ISA-PID structure, there is a feedback controller C and a % feed-forward filter F. In this example, C is a regular PI controller in % parallel form that can be represented by a PID object: % % $$ C(s) = pid(Kp,Ki) = Kp + \frac{Ki}{s} $$ % % F is a pre-filter that involves Kp and Ki gains from C plus the set-point % weight *b*: % % $$ F(s) = \frac{b*Kp*s+Ki}{Kp*s+Ki} $$ % % Therefore the ISA-PID controller has two inputs (r and y) and one output % (u).  %% % Set-point weight *b* is a real number between 0 and 1.  When it decreases, % the overshoot in the reference tracking response is reduced. In this % example, *b* is chosen to be 0.7.  b = 0.7; % the following code constructs an ISA-PID from the feedback controller PID F = tf([b*C.Kp C.Ki],[C.Kp C.Ki]); F.InputName = 'r';   F.OutputName = 'uf'; Sum = sumblk('e','uf','y','+-'); ISAPID = connect(C,F,Sum,{'r','y'},'u'); ISAPID  %% Compare Performance % The reference tracking response with ISA-PID controller has much less % overshoot because set-point weight *b* reduces overshoot.  % Closed-loop system with PI controller for reference tracking  sys1 = feedback(ss(G)*C,1); set(sys1,'Name','PID'); % Closed-loop ISA-PID system with ISA-PID controller for reference tracking  sys2 = connect(ISAPID,ss(G),'r','y'); set(sys2,'Name','ISA-PID'); % Compare responses figure; step(sys1,'r-',sys2,'b.'); legend('show','location','southeast') title('Reference Tracking')  %% % The disturbance rejection responses are the same because set-point weight % *b* only affects reference tracking.  % Closed-loop system with PI controller for disturbance rejection sysd1 = feedback(ss(G),C); set(sysd1,'Name','PID'); % Closed-loop system with ISA-PID controller for disturbance rejection sysd2 = connect(ISAPID,ss(G),'u','y'); set(sysd2,'Name','ISA-PID'); % Compare responses figure; step(sysd1,'r-',sysd2,'b.'); legend('PID','ISA-PID'); title('Disturbance Rejection')  %% displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>