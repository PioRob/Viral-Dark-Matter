function warns=sllastwarning(newWarns)
%SLLASTWARNING Simulink last warning message.
%   SLLASTWARNING by itself returns a Simulink diagnostic structure array
%   containing the last warning(s) generated by Simulink.  The fields of
%   the diagnostic structure are:
%
%     Type        'warning'
%     MessageID   the message ID for the warning (e.g., 'Simulink:Commands:InvSimulinkObjectName')
%     Message     the warning message
%     Handle      Simulink object handle(s) associated with the warning
%
%   SLLASTWARNING([]) resets the Simulink last warning so that it will return
%   an empty array until the next Simulink warning is encountered.
%
%   SLLASTWARNING(DIAGSTRUCT) will set the Simulink last warning(s) to those
%   specified in the DIAGSTRUCT.
%   
%   See also SLLASTDIAGNOSTIC, SLLASTERROR.

%   Copyright 1990-2005 The MathWorks, Inc.
%   $Revision: 1.5.2.2 $

%
% if no input args, return the last warning, otherwise, set it
%
if nargin == 0,
  
  warns = get_param(0, 'LastWarning');

else
  %
  % make sure that only warnings are being set
  %
  
  if ~isempty(newWarns),
    isSetProperly = true;
    if isstruct(newWarns)
      if ~isequal(sort(fieldnames(newWarns)), ...
              {'Handle';'Message';'MessageID';'Type'})
          isSetProperly = false;
      end
      if isSetProperly && (~all(strcmp({ newWarns(:).Type }, 'warning')))
        isSetProperly = false;
      end
    else
      isSetProperly = false;
    end    
    
    if ~isSetProperly
      error('Simulink:InvalidDiagnosticType', ...
        ['Simulink diagnostic structure must be a MATLAB structure', ...
         ' with the fieldnames Type, Message, MessageID, Handle.', ...
         ' The Type field should be set to ''error'' or ''warning''']);
    end
  end
  set_param(0, 'LastWarning', newWarns); 
end
