
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Rotating Membrane with MATLAB&reg; GUI</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-06-30"><meta name="DC.source" content="vrmemb.m"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit vrmemb">Open vrmemb.m in the Editor</a></div><div class="right"><a href="matlab:echodemo vrmemb">Run in the Command Window</a></div></div><div class="content"><h1>Rotating Membrane with MATLAB&reg; GUI</h1><!--introduction--><p>The vrmemb example shows how to use a MATLAB&reg; generated 3-D graphic object with the Simulink&reg; 3D Animation&#8482;. The famous membrane was generated by the logo function and saved in the VRML format using the MATLAB standard function vrml. You can save all Handle Graphics&reg; objects this way and use them with the Simulink 3D Animation as components of associated virtual worlds.</p><p>After starting the demo, you will see a control panel with two sliders and three check boxes. Use the sliders to rotate and zoom the membrane while you use the check boxes to determine which axis to rotate around.</p><p>In the VRML scene, it is interesting to notice the text object. It is a child of the VRML Billboard node. You can configure this node so that its local Z-axis turns to point to the viewer at all times. This can be useful for modeling virtual control panels and head-up displays (HUD).</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Create a World Object</a></li><li><a href="#3">Open the Virtual World</a></li><li><a href="#4">Accessing VRML Nodes</a></li><li><a href="#5">Create Dialog</a></li><li><a href="#6">Create Rotation Control</a></li><li><a href="#7">Create Zoom Control</a></li><li><a href="#8">Add Checkboxes</a></li><li><a href="#9">View the Virtual World</a></li></ul></div><h2>Create a World Object<a name="1"></a></h2><p>We begin by creating an object of class VRWORLD that represents the virtual world. The VRML file that constitutes the world was previously made using the V-Realm VRML builder contained in the Simulink 3D Animation product. The name of the file is MEMBRANE.WRL.</p><pre class="codeinput">wh = vrworld(<span class="string">'membrane.wrl'</span>);
</pre><p>The membrane object was generated using the function 'logo' and saved in VRML format using the function 'vrml'. After some minor modifications in the VRML editor, it is directly usable by the Simulink 3D Animation.</p><p>After starting the demo you will see a control panel with two sliders and three checkboxes. The sliders are used to rotate and zoom the membrane while the checkboxes determine around which axis to rotate.</p><h2>Open the Virtual World<a name="3"></a></h2><p>The world must be opened before it can be used.  This is accomplished with the OPEN command.</p><pre class="codeinput">open(wh);
</pre><h2>Accessing VRML Nodes<a name="4"></a></h2><p>To access a VRML node, an appropriate VRNODE object must be created. The node is identified by its name and the world it belongs to.</p><pre class="codeinput">H.membrane = vrnode(wh, <span class="string">'Membrane'</span>);
H.view1 = vrnode(wh, <span class="string">'View1'</span>);
</pre><h2>Create Dialog<a name="5"></a></h2><p>The dialog is used to interactively change field values of the VRML node referred to by the VRNODE object just created.</p><pre class="codeinput">figh = dialog(<span class="string">'Position'</span>,[358 402 530 107], <span class="string">'Name'</span>, <span class="string">'Simulink 3D Animation Demo'</span>, <span class="keyword">...</span>
              <span class="string">'WindowStyle'</span>, <span class="string">'normal'</span>, <span class="keyword">...</span>
              <span class="string">'CloseRequestFcn'</span>, <span class="keyword">...</span>
              <span class="string">'w = vrworld(''membrane.wrl''); close(w); try; delete(w); end; closereq'</span>);
</pre><img vspace="5" hspace="5" src="vrmemb_01.png" alt=""> <h2>Create Rotation Control<a name="6"></a></h2><pre class="codeinput">uicontrol(<span class="string">'Parent'</span>,figh, <span class="string">'Position'</span>,[108 68 50 14], <span class="string">'HorizontalAlignment'</span>,<span class="string">'left'</span>, <span class="keyword">...</span>
          <span class="string">'String'</span>,<span class="string">'Rotation'</span>, <span class="string">'Style'</span>,<span class="string">'text'</span>);

H.rotation = uicontrol(<span class="string">'Parent'</span>,figh, <span class="string">'Style'</span>,<span class="string">'slider'</span>, <span class="string">'Position'</span>,[164 65 352 20], <span class="keyword">...</span>
                       <span class="string">'Min'</span>, 0, <span class="string">'Max'</span>, 2*pi, <span class="keyword">...</span>
                       <span class="string">'Callback'</span>, [<span class="string">'cur_rot = get(H.rotation,''Value'');'</span>, <span class="keyword">...</span>
                                    <span class="string">'cur_x = get(H.xaxis,''Value'');'</span>, <span class="keyword">...</span>
                                    <span class="string">'cur_y = get(H.yaxis,''Value'');'</span>, <span class="keyword">...</span>
                                    <span class="string">'cur_z = get(H.zaxis,''Value'');'</span>, <span class="keyword">...</span>
                                    <span class="string">'if (cur_x || cur_y || cur_z)'</span>, <span class="keyword">...</span>
                                    <span class="string">'  H.membrane.rotation = [cur_x cur_y cur_z cur_rot];'</span>, <span class="keyword">...</span>
                                    <span class="string">'end'</span> ]);
</pre><img vspace="5" hspace="5" src="vrmemb_02.png" alt=""> <h2>Create Zoom Control<a name="7"></a></h2><pre class="codeinput">H.zoom = uicontrol(<span class="string">'Parent'</span>,figh, <span class="string">'Style'</span>,<span class="string">'slider'</span>, <span class="keyword">...</span>
                   <span class="string">'Position'</span>,[164 24 352 20], <span class="string">'Value'</span>, 1, <span class="keyword">...</span>
                   <span class="string">'Callback'</span>, <span class="string">'H.view1.fieldOfView = 0.25 + 0.55 * (1-get(H.zoom,''Value''));'</span>);

uicontrol(<span class="string">'Parent'</span>,figh, <span class="string">'Position'</span>,[108 27 50 14], <span class="string">'String'</span>,<span class="string">'Zoom'</span>, <span class="keyword">...</span>
          <span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="string">'HorizontalAlignment'</span>,<span class="string">'left'</span>);
</pre><img vspace="5" hspace="5" src="vrmemb_03.png" alt=""> <h2>Add Checkboxes<a name="8"></a></h2><pre class="codeinput">H.xaxis = uicontrol(<span class="string">'Parent'</span>,figh, <span class="string">'Position'</span>,[24 70 60 20], <span class="string">'String'</span>,<span class="string">'X'</span>, <span class="keyword">...</span>
                    <span class="string">'Style'</span>,<span class="string">'checkbox'</span>);
H.yaxis = uicontrol(<span class="string">'Parent'</span>,figh, <span class="string">'Position'</span>,[24 42 60 20], <span class="string">'String'</span>,<span class="string">'Y'</span>, <span class="keyword">...</span>
                    <span class="string">'Style'</span>,<span class="string">'checkbox'</span>);
H.zaxis = uicontrol(<span class="string">'Parent'</span>,figh, <span class="string">'Position'</span>,[24 14 60 20], <span class="string">'String'</span>,<span class="string">'Z'</span>, <span class="keyword">...</span>
                    <span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="string">'Value'</span>, 1);
setappdata(figh, <span class="string">'Handles'</span>, H);
</pre><img vspace="5" hspace="5" src="vrmemb_04.png" alt=""> <h2>View the Virtual World<a name="9"></a></h2><p>The virtual world can be viewed in the VRML viewer. Simulink 3D Animation offers two ways of viewing virtual worlds - internal viewer (default method) and external viewer (integrated with your Web browser, available on some platforms). We will view the virtual world using the VIEW function.</p><pre class="codeinput">view(wh);
</pre><img vspace="5" hspace="5" src="vrmemb_05.png" alt=""> <p>The demo is finished by closing the control panel.</p><p class="footer">Copyright 1998-2009 HUMUSOFT s.r.o. and The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Rotating Membrane with MATLAB(R) GUI
%
% The vrmemb example shows how to use a MATLAB(R) generated 3-D graphic object
% with the Simulink(R) 3D Animation(TM). The famous membrane was generated by
% the logo function and saved in the VRML format using the MATLAB standard
% function vrml. You can save all Handle Graphics(R) objects this way and use
% them with the Simulink 3D Animation as components of associated virtual
% worlds.
%
% After starting the demo, you will see a control panel with two sliders
% and three check boxes. Use the sliders to rotate and zoom the membrane
% while you use the check boxes to determine which axis to rotate around.  
%
% In the VRML scene, it is interesting to notice the text object. It is a
% child of the VRML Billboard node. You can configure this node so that its
% local Z-axis turns to point to the viewer at all times. This can be
% useful for modeling virtual control panels and head-up displays (HUD).

%   Copyright 1998-2009 HUMUSOFT s.r.o. and The MathWorks, Inc.
%   $Revision: 1.1.6.4 $ $Date: 2009/11/07 21:29:58 $ $Author: batserve $


%% Create a World Object
% We begin by creating an object of class VRWORLD that represents
% the virtual world. The VRML file that constitutes the world was
% previously made using the V-Realm VRML builder contained in the Simulink
% 3D Animation product. The name of the file is MEMBRANE.WRL.

wh = vrworld('membrane.wrl');

%%
% The membrane object was generated using the function 'logo' and saved in
% VRML format using the function 'vrml'. After some minor modifications
% in the VRML editor, it is directly usable by the Simulink 3D Animation.
%
% After starting the demo you will see a control panel with two sliders
% and three checkboxes. The sliders are used to rotate and zoom the
% membrane while the checkboxes determine around which axis to rotate.

%% Open the Virtual World
% The world must be opened before it can be used.  This is accomplished
% with the OPEN command. 

open(wh);

%% Accessing VRML Nodes
% To access a VRML node, an appropriate VRNODE object must be created.
% The node is identified by its name and the world it belongs to.

H.membrane = vrnode(wh, 'Membrane');
H.view1 = vrnode(wh, 'View1');

%% Create Dialog
% The dialog is used to interactively change field values of the VRML node
% referred to by the VRNODE object just created.

figh = dialog('Position',[358 402 530 107], 'Name', 'Simulink 3D Animation Demo', ...
              'WindowStyle', 'normal', ...
              'CloseRequestFcn', ...
              'w = vrworld(''membrane.wrl''); close(w); try; delete(w); end; closereq');

%% Create Rotation Control

uicontrol('Parent',figh, 'Position',[108 68 50 14], 'HorizontalAlignment','left', ...
          'String','Rotation', 'Style','text');
      
H.rotation = uicontrol('Parent',figh, 'Style','slider', 'Position',[164 65 352 20], ...
                       'Min', 0, 'Max', 2*pi, ...
                       'Callback', ['cur_rot = get(H.rotation,''Value'');', ...
                                    'cur_x = get(H.xaxis,''Value'');', ...
                                    'cur_y = get(H.yaxis,''Value'');', ...
                                    'cur_z = get(H.zaxis,''Value'');', ...
                                    'if (cur_x || cur_y || cur_z)', ...
                                    '  H.membrane.rotation = [cur_x cur_y cur_z cur_rot];', ...
                                    'end' ]);

%% Create Zoom Control

H.zoom = uicontrol('Parent',figh, 'Style','slider', ...
                   'Position',[164 24 352 20], 'Value', 1, ...
                   'Callback', 'H.view1.fieldOfView = 0.25 + 0.55 * (1-get(H.zoom,''Value''));');

uicontrol('Parent',figh, 'Position',[108 27 50 14], 'String','Zoom', ...
          'Style','text', 'HorizontalAlignment','left');

%% Add Checkboxes

H.xaxis = uicontrol('Parent',figh, 'Position',[24 70 60 20], 'String','X', ...
                    'Style','checkbox');
H.yaxis = uicontrol('Parent',figh, 'Position',[24 42 60 20], 'String','Y', ...
                    'Style','checkbox');
H.zaxis = uicontrol('Parent',figh, 'Position',[24 14 60 20], 'String','Z', ...
                    'Style','checkbox', 'Value', 1);
setappdata(figh, 'Handles', H);

%% View the Virtual World
% The virtual world can be viewed in the VRML viewer. Simulink 3D Animation
% offers two ways of viewing virtual worlds - internal viewer
% (default method) and external viewer (integrated with your Web browser,
% available on some platforms). We will view the virtual world
% using the VIEW function.

view(wh);

%%
% The demo is finished by closing the control panel.


displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
--></body></html>