
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>AUTOSAR クライアント/サーバー インターフェイスの使用</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="rtwdemo_autosar_clientserver_script.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit rtwdemo_autosar_clientserver_script">エディターで rtwdemo_autosar_clientserver_script.m を開く</a></div><div class="right"><a href="matlab:echodemo rtwdemo_autosar_clientserver_script">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>AUTOSAR クライアント/サーバー インターフェイスの使用</h1><!--introduction--><p>このデモでは、AUTOSAR クライアント/サーバー インターフェイスを使用して AUTOSAR 準拠のコードを設定および生成し、AUTOSAR 準拠の XML ファイルを Simulink&reg; モデルにエクスポートする方法を示します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">サーバー処理を起動するクライアント モデルに対するシミュレーションとコード生成</a></li><li><a href="#4">サーバー処理を実装するモデルに対するコード生成</a></li><li><a href="#11">AUTOSAR クライアント/サーバー記述ファイルのインポートによる Invoke AUTOSAR Server Operation ブロック実装の作成</a></li></ul></div><h2>サーバー処理を起動するクライアント モデルに対するシミュレーションとコード生成<a name="1"></a></h2><p>AUTOSAR クライアント/サーバー インターフェイスを使用して、インターフェイスを提供するソフトウェア コンポーネント (サーバー) とインターフェイスを必要とするソフトウェア コンポーネント (クライアント) 間での対話を定義します。クライアント モデルでは、2 種類の実装を使用してサーバー処理を起動できます。1 つはコード生成に使用し、もう 1 つはシミュレーションに使用します。モデル内でこれらのすべてのブロックを切り替えるために、便利なブロックが用意されています。Invoke AUTOSAR Server Operation ブロック実装の作成方法は、このデモで後述します。</p><pre class="codeinput">open_system( <span class="string">'rtwdemo_autosar_client'</span> );
</pre><img vspace="5" hspace="5" src="../rtwdemo_autosar_clientserver_script_01.png" alt=""> <img vspace="5" hspace="5" src="../rtwdemo_autosar_clientserver_script_02.png" alt=""> <p>このモデルは次のようにシミュレーションできます。</p><div><ol><li>AUTOSAR Server Operation ブロックのモード スイッチをダブルクリックして、現在のモードを「コード生成」から「シミュレーション」に変更します。</li><li>[<b></b>シミュレーション]、[<b></b>開始] を選択します。</li></ol></div><p>モデルに対するコードは次のように生成できます。</p><div><ol><li>AUTOSAR Server Operation ブロックのモード スイッチをダブルクリックして、現在のモードを「シミュレーション」から「コード生成」に変更します。</li><li>[<b></b>ツール]、[<b></b>Real-Time Workshop]、[<b></b>モデルのビルド] を選択します。 </li></ol></div><h2>サーバー処理を実装するモデルに対するコード生成<a name="4"></a></h2><p>サーバー処理モデルは、次の目的に使用できます。</p><div><ul><li>サーバー処理に使用する AUTOSAR 準拠コードと XML ファイルの生成</li><li>クライアントに対するシミュレーションのサポート</li></ul></div><pre class="codeinput">open_system( <span class="string">'rtwdemo_autosar_server_operation'</span> );
</pre><img vspace="5" hspace="5" src="../rtwdemo_autosar_clientserver_script_03.png" alt=""> <p>このようなモデルの入力と出力は、サーバー処理の引数に対応しています。次のコマンドを使用して、AUTOSAR 設定 GUI を開きます。ここで、処理のプロトタイプは既に指定されています。</p><pre class="codeinput">autosar_gui_launch( <span class="string">'rtwdemo_autosar_server_operation'</span> );
</pre><p>サーバー処理モデルに対するコードを生成するには、[<b></b>ツール]、[<b></b>Real-Time Workshop]、[<b></b>モデルのビルド] を選択します。あるいは、次のコマンドを実行します。</p><pre class="codeinput">rtwbuild( <span class="string">'rtwdemo_autosar_server_operation'</span> );
</pre><pre class="codeoutput">### Starting Real-Time Workshop build procedure for model:rtwdemo_autosar_server_operation
### Generating XML files description for model:rtwdemo_autosar_server_operation
### Successful completion of Real-Time Workshop code generation for model:rtwdemo_autosar_server_operation
</pre><p><img vspace="5" hspace="5" src="../rtwdemo_autosar_server_operation_code.jpg" alt=""> </p><p><b>図 1:サーバー処理のために生成されたコードの一部</b></p><p><img vspace="5" hspace="5" src="../rtwdemo_autosar_server_operation_arxml.jpg" alt=""> </p><p><b>図 2:サーバー処理のために生成された xml の一部</b></p><h2>AUTOSAR クライアント/サーバー記述ファイルのインポートによる Invoke AUTOSAR Server Operation ブロック実装の作成<a name="11"></a></h2><p>クライアント/サーバー インターフェイスを定義する AUTOSAR 記述ファイルを使用して、設定可能なサブシステムで構成される Simulink ライブラリを生成できます。このサブシステムは、コード生成に使用される Invoke AUTOSAR Server Operation ブロックと、シミュレーションに使用される Server Operation Model Reference ブロックを参照します。</p><p>クライアント/サーバー インターフェイスを生成するには、さまざまな方法があります。たとえば、サーバー処理モデルを作成してからインターフェイスを生成するモデルをビルドしたり、AUTOSAR オーサリング ツールを使用したりすることができます。</p><p>クライアント/サーバー インターフェイスを作成したら、次のコマンドを使用して、設定可能なサブシステムを生成できます。</p><pre class="codeinput"><span class="comment">% Create an AUTOSAR importer object</span>
obj = arxml.importer(<span class="string">'rtwdemo_autosar_csinterface.arxml'</span>);

<span class="comment">% Create the client/server operation configurable subsystem library</span>
obj.createOperationAsConfigurableSubsystems(<span class="string">'/PortInterface/csinterface'</span>, <span class="keyword">...</span>
                                            <span class="string">'CreateSimulinkObject'</span>, false);
</pre><img vspace="5" hspace="5" src="../rtwdemo_autosar_clientserver_script_04.png" alt=""> <img vspace="5" hspace="5" src="../rtwdemo_autosar_clientserver_script_05.png" alt=""> <p>これで、作成したクライアント モデルに Template ブロックをドラッグできます。「シミュレーション」と「コード生成」を切り替えられるようにするには、モデル内に Invoke AUTOSAR Server Operation ブロックのモード スイッチを配置します。このブロックをダブルクリックすると、2 つのモードを切り替えることができます。</p><p class="footer">Copyright 2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Using an AUTOSAR Client-Server Interface % This demonstration shows you how to configure and generate AUTOSAR-compliant % code and export AUTOSAR-compliant XML files for a Simulink(R) model with an AUTOSAR % client-server interface. % %  %   Copyright 2009 The MathWorks, Inc. %   $Revision: 1.1.4.2.2.1 $  $Date: 2010/07/29 21:28:58 $   %% Simulation and Code Generation for a Client Model that Invokes a Server Operation % An AUTOSAR client-server interface defines the interaction between a software % component that provides the interface (the server) and a software component % that requires the interface (the client). A client model can invoke server % operations using two different implementations. One which is used for code % generation and one for simulation. A convenience block is provided to switch % between all these blocks in your model. Creating the implementations of the % Invoke AUTOSAR Server Operation block is described later in this % demonstration.  open_system( 'rtwdemo_autosar_client' );  %% % You can simulate the model as follows: % % # Double-click the Mode Switch for AUTOSAR Server Operation block to change the % current mode from "code generation" to "simulation" % # Select *Simulation* > *Start*  %% % You can generate code for the model as follows: % % # Double-click the Mode Switch for AUTOSAR Server Operation block to change the % current mode from "simulation" to "code generation" % # Select *Tools* > *Real-Time Workshop* > *Build Model*  %% Code Generation for a Model Implementing a Server Operation % You can use the server operation model to: % % * Generate AUTOSAR-compliant code and XML files for server operations. % * Provide simulation support for the client.  open_system( 'rtwdemo_autosar_server_operation' );  %% % The inports and outports of such a model correspond to the arguments of the % server operation. Use the following command to open the AUTOSAR configuration % GUI, where the operation prototype is already specified: autosar_gui_launch( 'rtwdemo_autosar_server_operation' );  %% % To generate code for the server operation model, select *Tools* > *Real-Time % Workshop* > *Build Model*. Alternatively, run the following command: rtwbuild( 'rtwdemo_autosar_server_operation' );  %% % % <<rtwdemo_autosar_server_operation_code.jpg>>  %%  % *Figure 1: Portion of the generated code for the server operation*  %% % % <<rtwdemo_autosar_server_operation_arxml.jpg>> %% % *Figure 2: Portion of the generated xml for the server operation*   %% Importing an AUTOSAR Client-Server Description File to Create the Invoke AUTOSAR Server Operation Block Implementations % Using an AUTOSAR description file that defines the client-server interface, % you can generate a Simulink library containing configurable subsystems that % reference the Invoke AUTOSAR Server Operation used for code generation and % Server Operation Model Reference blocks used for simulation.  %% % Note that there are different ways of generating the client-server % interface. For example, you can construct a server operation model and then % build the model to generate the interface, or you can use an AUTOSAR authoring % tool.  %% % Once the client-server interface is created, you can generate the configurable % subsystems using the following commands:  % Create an AUTOSAR importer object obj = arxml.importer('rtwdemo_autosar_csinterface.arxml');  % Create the client/server operation configurable subsystem library obj.createOperationAsConfigurableSubsystems('/PortInterface/csinterface', ...                                             'CreateSimulinkObject', false);  %% % You can now drag the Template block into your client model. To allow switching % between "simulation" and "code generation", place the Mode Switch for Invoke % AUTOSAR Server Operation block in your model. Double-click this block to % toggle between the two modes.  displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>