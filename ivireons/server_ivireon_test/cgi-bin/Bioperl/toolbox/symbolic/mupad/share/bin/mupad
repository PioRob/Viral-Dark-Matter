#!/bin/sh

SHARE_BIN=`dirname "$0"`

if test `basename "${SHARE_BIN}"` = bin  ; then
  SHARE=`dirname "${SHARE_BIN}"`
  if test `basename "${SHARE}"` = share ; then
    MuPAD_ROOT_PATH=`dirname "${SHARE}"`
  else
    MuPAD_ROOT_PATH=..
  fi
else
  MuPAD_ROOT_PATH=../..
fi
export MuPAD_ROOT_PATH

SYSINFO=`${MuPAD_ROOT_PATH}/share/bin/muparch`

if test -d ${MuPAD_ROOT_PATH}/../../../bin/${SYSINFO} ; then
  LD_LIBRARY_PATH="${MuPAD_ROOT_PATH}/${SYSINFO}/lib:${MuPAD_ROOT_PATH}/../../../bin/${SYSINFO}/:${MuPAD_ROOT_PATH}/../../../sys/os/${SYSINFO}/:${LD_LIBRARY_PATH}"
else
  LD_LIBRARY_PATH="${MuPAD_ROOT_PATH}/${SYSINFO}/lib:${LD_LIBRARY_PATH}"
fi
export LD_LIBRARY_PATH
 
# for Macs
export DYLD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${DYLD_LIBRARY_PATH}
if [ "${SYSINFO}" = "maci64" ] ; then 
  export DYLD_FRAMEWORK_PATH=${LD_LIBRARY_PATH}:${DYLD_FRAMEWORK_PATH}
fi

# Path for Qt plugins
if test -d ${MuPAD_ROOT_PATH}/../../../bin/${SYSINFO} ; then
  export QT_PLUGIN_PATH="${MuPAD_ROOT_PATH}/../../../bin/${SYSINFO}/:${QT_PLUGIN_PATH}"
fi

if test -d ${MuPAD_ROOT_PATH}/../../../bin/ ; then
  export PATH="${MuPAD_ROOT_PATH}/../../../bin/:${PATH}"
fi

# workaround for problems with accelerated NVidia hardware on 64 bit systems
# LD_PRELOAD=${MuPAD_ROOT_PATH}/${SYSINFO}/lib/libGLU/libGLU.so.1.3 "${MuPAD_ROOT_PATH}/${SYSINFO}/bin/mupad" "$@"
"${MuPAD_ROOT_PATH}/${SYSINFO}/bin/mupad" "$@"

