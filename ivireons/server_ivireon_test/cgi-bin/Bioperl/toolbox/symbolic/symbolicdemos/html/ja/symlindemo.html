
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>シンボリック行列演算</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-26"><meta name="DC.source" content="symlindemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit symlindemo">エディターで symlindemo.m を開く</a></div><div class="right"><a href="matlab:echodemo symlindemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>シンボリック行列演算</h1><!--introduction--><!--/introduction--><p>一般的なテスト行列である 5 行 5 列のヒルベルト行列を生成します。</p><pre class="codeinput">H = sym(hilb(5))
</pre><pre class="codeoutput"> 
H =
 
[   1, 1/2, 1/3, 1/4, 1/5]
[ 1/2, 1/3, 1/4, 1/5, 1/6]
[ 1/3, 1/4, 1/5, 1/6, 1/7]
[ 1/4, 1/5, 1/6, 1/7, 1/8]
[ 1/5, 1/6, 1/7, 1/8, 1/9]
 
</pre><p>この行列式は非常に小さいです。</p><pre class="codeinput">d = det(H)
</pre><pre class="codeoutput"> 
d =
 
1/266716800000
 
</pre><p>逆行列の要素は整数です。</p><pre class="codeinput">X = inv(H)
</pre><pre class="codeoutput"> 
X =
 
[    25,   -300,    1050,   -1400,    630]
[  -300,   4800,  -18900,   26880, -12600]
[  1050, -18900,   79380, -117600,  56700]
[ -1400,  26880, -117600,  179200, -88200]
[   630, -12600,   56700,  -88200,  44100]
 
</pre><p>この逆行列が正しいことを確認します。</p><pre class="codeinput">I = X*H
</pre><pre class="codeoutput"> 
I =
 
[ 1, 0, 0, 0, 0]
[ 0, 1, 0, 0, 0]
[ 0, 0, 1, 0, 0]
[ 0, 0, 0, 1, 0]
[ 0, 0, 0, 0, 1]
 
</pre><p>特性多項式を求めます。</p><pre class="codeinput">p = poly(H)
</pre><pre class="codeoutput"> 
p =
 
x^5 - (563*x^4)/315 + (735781*x^3)/2116800 - (852401*x^2)/222264000 + (61501*x)/53343360000 - 1/266716800000
 
</pre><p>この特性多項式の因数分解を試みます。</p><pre class="codeinput">factor(p)
</pre><pre class="codeoutput"> 
ans =
 
(266716800000*x^5 - 476703360000*x^4 + 92708406000*x^3 - 1022881200*x^2 + 307505*x - 1)/266716800000
 
</pre><p>この結果は、この特性多項式を有理数上で因数分解できないことを示しています。</p><p>固有値を 50 桁の精度で近似計算します。</p><pre class="codeinput">digits(50)
e = eig(vpa(H))
</pre><pre class="codeoutput"> 
e =
 
       1.5670506910982307955330110055207246339493152522334
      0.20853421861101333590500251006882005503858202260343
      0.01140749162341980655945145886658934504234843052664
   0.00030589804015119172687949784069272282565614514909247
 0.0000032879287721718629571150047605447313997367890230746
 
</pre><p>自由変数 t を含む一般化ヒルベルト行列を作成します。</p><pre class="codeinput">t = sym(<span class="string">'t'</span>);
[I,J] = meshgrid(1:5);
H = 1./(I+J-t)
</pre><pre class="codeoutput"> 
H =
 
[ -1/(t - 2), -1/(t - 3), -1/(t - 4), -1/(t - 5),  -1/(t - 6)]
[ -1/(t - 3), -1/(t - 4), -1/(t - 5), -1/(t - 6),  -1/(t - 7)]
[ -1/(t - 4), -1/(t - 5), -1/(t - 6), -1/(t - 7),  -1/(t - 8)]
[ -1/(t - 4), -1/(t - 5), -1/(t - 6), -1/(t - 7),  -1/(t - 8)]
[ -1/(t - 4), -1/(t - 5), -1/(t - 6), -1/(t - 7),  -1/(t - 8)]
 
</pre><p>t = 1 を代入すると、元のヒルベルト行列が得られます。</p><pre class="codeinput">subs(H,t,1)
</pre><pre class="codeoutput">
ans =

    1.0000    0.5000    0.3333    0.2500    0.2000
    0.5000    0.3333    0.2500    0.2000    0.1667
    0.3333    0.2500    0.2000    0.1667    0.1429
    0.2500    0.2000    0.1667    0.1429    0.1250
    0.2000    0.1667    0.1429    0.1250    0.1111

</pre><p>行列式の逆行列は、t の多項式です。</p><pre class="codeinput">d = 1/det(H)

d = expand(d)

pretty(d)
</pre><pre class="codeoutput"> 
d =
 
-((t - 2)*(t - 3)^2*(t - 4)^3*(t - 5)^4*(t - 6)^5*(t - 7)^4*(t - 8)^3*(t - 9)^2*(t - 10))/82944
 
 
d =
 
- t^25/82944 + (25*t^24)/13824 - (5375*t^23)/41472 + (40825*t^22)/6912 - (15940015*t^21)/82944 + (21896665*t^20)/4608 - (240519875*t^19)/2592 + (1268467075*t^18)/864 - (1588946776255*t^17)/82944 + (2885896606895*t^16)/13824 - (79493630114675*t^15)/41472 + (34372691161375*t^14)/2304 - (8194259295156385*t^13)/82944 + (7707965729450845*t^12)/13824 - (55608098247105175*t^11)/20736 + (37909434298793825*t^10)/3456 - (197019820623693025*t^9)/5184 + (10640296363350955*t^8)/96 - (38821472549340925*t^7)/144 + (12958201048605475*t^6)/24 - (1748754621252377*t^5)/2 + 1115685328012530*t^4 - 1078920141906600*t^3 + 742618453752000*t^2 - 323874210240000*t + 67212633600000
 
 
    25        24         23          22             21             20 
   t      25 t     5375 t     40825 t     15940015 t     21896665 t 
- ----- + ------ - -------- + --------- - ------------ + ------------ - 
  82944   13824     41472       6912         82944           4608 
 
              19               18                  17                  16 
   240519875 t     1268467075 t     1588946776255 t     2885896606895 t 
   ------------- + -------------- - ----------------- + ----------------- - 
       2592             864               82944               13824 
 
                   15                   14                     13 
   79493630114675 t     34372691161375 t     8194259295156385 t 
   ------------------ + ------------------ - -------------------- + 
         41472                 2304                 82944 
 
                     12                      11                      10 
   7707965729450845 t     55608098247105175 t     37909434298793825 t 
   -------------------- - --------------------- + --------------------- - 
          13824                   20736                   3456 
 
                       9                      8                      7 
   197019820623693025 t    10640296363350955 t    38821472549340925 t 
   --------------------- + -------------------- - -------------------- + 
           5184                     96                    144 
 
                      6                     5 
   12958201048605475 t    1748754621252377 t                      4 
   -------------------- - ------------------- + 1115685328012530 t  - 
            24                     2 
 
                     3                    2 
   1078920141906600 t  + 742618453752000 t  - 323874210240000 t + 
 
   67212633600000
</pre><p>この逆数の要素も t の多項式です。</p><pre class="codeinput">X = inv(H)
</pre><pre class="codeoutput"> 
X =
 
[ -((t - 3)^3*(t - 5)^6*(t - 6)^8*(t - 8)^2*(t^2 - 11*t + 18)*(t^2 - 11*t + 28)^3)/(576*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 18*t^3 + 119*t^2 - 342*t + 360)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)), ((t - 4)^4*(t - 5)^6*(t - 6)^8*(t - 7)^5*(t^2 - 11*t + 18)*(t^2 - 11*t + 24)^2)/(144*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 18*t^3 + 119*t^2 - 342*t + 360)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)), -((t - 3)^2*(t - 5)^6*(t - 6)^8*(t - 7)^5*(t^2 - 11*t + 18)*(t^2 - 12*t + 32)^3)/(96*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 18*t^3 + 119*t^2 - 342*t + 360)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)), ((t - 2)*(t - 6)^8*(t^2 - 12*t + 27)^2*(t^2 - 12*t + 32)^3*(t^2 - 12*t + 35)^5)/(144*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 18*t^3 + 119*t^2 - 342*t + 360)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)), -((t - 6)^7*(t^2 - 12*t + 20)*(t^2 - 12*t + 27)^2*(t^2 - 12*t + 32)^3*(t^2 - 12*t + 35)^5)/(576*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 18*t^3 + 119*t^2 - 342*t + 360)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024))]
[                        ((t - 4)^3*(t - 6)^7*(t - 8)^2*(t^2 - 12*t + 35)^5*(t^3 - 14*t^2 + 51*t - 54))/(144*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                   -((t - 5)^5*(t - 6)^7*(t - 7)^6*(t - 9)*(t^3 - 15*t^2 + 68*t - 96)^2)/(36*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                   ((t - 5)^4*(t - 6)^7*(t - 7)^6*(t^2 - 12*t + 27)*(t^2 - 12*t + 32)^3)/(24*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                                      -((t - 3)*(t - 5)^5*(t - 8)^3*(t^2 - 13*t + 36)^2*(t^2 - 13*t + 42)^4)/(36*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                   ((t - 5)^4*(t - 6)^7*(t - 7)^5*(t - 8)^3*(t^2 - 13*t + 30)*(t^2 - 13*t + 36)^2)/(144*(t^2 - 11*t + 28)*(t^2 - 11*t + 30)^2*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024))]
[                                                                              -((t - 6)^5*(t - 7)^4*(t^2 - 13*t + 40)^2*(t^4 - 18*t^3 + 107*t^2 - 258*t + 216))/(96*(t^2 - 13*t + 42)^2*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                                                                              ((t - 8)^3*(t^2 - 9*t + 20)^2*(t^2 - 12*t + 27)*(t^2 - 13*t + 42)^3)/(24*(t^2 - 13*t + 40)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                                                                  -((t - 4)^2*(t - 5)^3*(t - 7)^5*(t - 9)*(t^2 - 14*t + 48)^4)/(16*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                                                                   ((t - 4)*(t - 5)^3*(t - 6)^5*(t - 9)^2*(t^2 - 15*t + 56)^4)/(24*(t^2 - 13*t + 40)*(t^2 - 13*t + 42)^2*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)),                                                                                                                       -((t - 8)^3*(t^2 - 14*t + 40)*(t^2 - 13*t + 42)^3*(t^2 - 14*t + 45)^2)/(96*(t^2 - 13*t + 40)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024))]
[                                                                                                                                   ((t - 6)^2*(t^7 - 38*t^6 + 598*t^5 - 5036*t^4 + 24433*t^3 - 68078*t^2 + 100536*t - 60480))/144,                                                                                                                                                                     -((t^2 - 12*t + 35)^2*(t^5 - 30*t^4 + 347*t^3 - 1926*t^2 + 5112*t - 5184))/36,                                                                                                                                                                                  ((t^3 - 19*t^2 + 118*t - 240)^2*(t^3 - 20*t^2 + 127*t - 252))/24,                                                                                                                                                                                          -((t - 8)*(t^4 - 27*t^3 + 269*t^2 - 1173*t + 1890)^2)/36,                                                                                                                                                                                            ((t^3 - 21*t^2 + 146*t - 336)^2*(t^3 - 24*t^2 + 185*t - 450))/144]
[                                                                                  - t^9/576 + (3*t^8)/32 - (211*t^7)/96 + (469*t^6)/16 - (46963*t^5)/192 + (42287*t^4)/32 - (663941*t^3)/144 + (79913*t^2)/8 - (24305*t)/2 + 6300,                                                                                                                                                  ((t - 6)^2*(t^7 - 46*t^6 + 886*t^5 - 9244*t^4 + 56305*t^3 - 199798*t^2 + 381720*t - 302400))/144,                                                                                                                                                                   -((t^2 - 13*t + 42)^2*(t^5 - 36*t^4 + 505*t^3 - 3438*t^2 + 11320*t - 14400))/96,                                                                                                                                                                                 ((t^3 - 21*t^2 + 146*t - 336)^2*(t^3 - 24*t^2 + 185*t - 450))/144,                                                                                                                                                                                                   -((t - 10)*(t^4 - 30*t^3 + 335*t^2 - 1650*t + 3024)^2)/576]
 
</pre><p>t = 1 を代入すると、ヒルベルト行列の逆行列が生成されます。</p><pre class="codeinput">X = subs(X,t,<span class="string">'1'</span>)
X = double(X)
</pre><pre class="codeoutput"> 
X =
 
[    25,   -300,    1050,   -1400,    630]
[  -300,   4800,  -18900,   26880, -12600]
[  1050, -18900,   79380, -117600,  56700]
[ -1400,  26880, -117600,  179200, -88200]
[   630, -12600,   56700,  -88200,  44100]
 

X =

          25        -300        1050       -1400         630
        -300        4800      -18900       26880      -12600
        1050      -18900       79380     -117600       56700
       -1400       26880     -117600      179200      -88200
         630      -12600       56700      -88200       44100

</pre><p>別の例を調べます。</p><pre class="codeinput">A = sym(gallery(5))
</pre><pre class="codeoutput"> 
A =
 
[   -9,    11,   -21,     63,   -252]
[   70,   -69,   141,   -421,   1684]
[ -575,   575, -1149,   3451, -13801]
[ 3891, -3891,  7782, -23345,  93365]
[ 1024, -1024,  2048,  -6144,  24572]
 
</pre><p>これは &quot;冪零行列&quot; です。この行列を 5 乗すると、ゼロ行列になります。</p><pre class="codeinput">A^5
</pre><pre class="codeoutput"> 
ans =
 
[ 0, 0, 0, 0, 0]
[ 0, 0, 0, 0, 0]
[ 0, 0, 0, 0, 0]
[ 0, 0, 0, 0, 0]
[ 0, 0, 0, 0, 0]
 
</pre><p>これは冪零行列であるため、その特性多項式は非常に単純です。</p><pre class="codeinput">p = poly(A,<span class="string">'lambda'</span>)
</pre><pre class="codeoutput"> 
p =
 
lambda^5
 
</pre><p>ここで、この固有値の計算は暗算ができるぐらい単純です。固有値は、方程式 lambda^5 = 0 の零点です。</p><p>シンボリック計算によって、正確な固有値を求めることができます。</p><pre class="codeinput">lambda = eig(A)
</pre><pre class="codeoutput"> 
lambda =
 
 0
 0
 0
 0
 0
 
</pre><p>数値計算は丸め誤差を伴い、lambda^5 = eps*norm(A) のような方程式の零点を求めます。このため、計算された固有値は概ね lambda = (eps*norm(A))^(1/5) となります。ここで、Symbolic Math Toolbox によって 16 桁の精度で、固有値の計算をします。すべての解が 0 になるべきですが、計算結果を確認すると、そうではないことが分かります。</p><pre class="codeinput">digits(16)
lambda = eig(vpa(A))
</pre><pre class="codeoutput"> 
lambda =
 
                            0.0005617448486395847
  0.0001737348850386136 - 0.0005342985684139864*i
  0.0005342985684139864*i + 0.0001737348850386136
   0.0003303865815979566*i - 0.000454607309358406
 - 0.0003303865815979566*i - 0.000454607309358406
 
</pre><p>これは、&quot;欠陥&quot; 行列でもあります。この行列は、対数行列ではありません。この行列の Jordan 標準形は非対角です。</p><pre class="codeinput">J = jordan(A)
</pre><pre class="codeoutput"> 
J =
 
[ 0, 1, 0, 0, 0]
[ 0, 0, 1, 0, 0]
[ 0, 0, 0, 1, 0]
[ 0, 0, 0, 0, 1]
[ 0, 0, 0, 0, 0]
 
</pre><p>行列の指数関数 expm(t*A) は通常、固有値 exp(lambda(i)*t) を含むスカラーの指数関数によって表されます。しかし、この行列の場合、expm(t*A) の要素はすべて t の多項式です。</p><pre class="codeinput">t = sym(<span class="string">'t'</span>);
E = simplify(expm(t*A))
</pre><pre class="codeoutput"> 
E =
 
[             - (2*t^3)/3 + (11*t^2)/2 - 9*t + 1,                      (t*(4*t^2 - 27*t + 33))/3,                          -(t*(20*t^2 - 117*t + 126))/6,                                (t*(2*t - 3)*(16*t - 63))/3,                            -(t*(85*t^2 - 464*t + 504))/2]
[          -(t*(7*t^3 - 81*t^2 + 230*t - 140))/2,        7*t^4 - 67*t^3 + (301*t^2)/2 - 69*t + 1,                -(t*(35*t^3 - 293*t^2 + 598*t - 282))/2,                   (t*(112*t^3 - 876*t^2 + 1799*t - 842))/2,          -(t*(1785*t^3 - 14012*t^2 + 28776*t - 13472))/8]
[     (t*(142*t^3 - 1710*t^2 + 5151*t - 3450))/6,    -(t*(142*t^3 - 1426*t^2 + 3438*t - 1725))/3, (355*t^4)/3 - (3139*t^3)/3 + (4585*t^2)/2 - 1149*t + 1,             -(t*(1136*t^3 - 9420*t^2 + 20625*t - 10353))/3,      (t*(18105*t^3 - 150646*t^2 + 329952*t - 165612))/12]
[ -(t*(973*t^3 - 11675*t^2 + 35022*t - 23346))/6, (t*(1946*t^3 - 19458*t^2 + 46695*t - 23346))/6,        -(t*(4865*t^3 - 42807*t^2 + 93390*t - 46692))/6, (7784*t^4)/3 - (64210*t^3)/3 + (93391*t^2)/2 - 23345*t + 1, -(t*(248115*t^3 - 2053748*t^2 + 4482036*t - 2240760))/24]
[          -(128*t*(t^3 - 12*t^2 + 36*t - 24))/3,           (256*t*(t^3 - 10*t^2 + 24*t - 12))/3,                -(128*t*(5*t^3 - 44*t^2 + 96*t - 48))/3,                     (512*t*(4*t^3 - 33*t^2 + 72*t - 36))/3,     - 2720*t^4 + (67552*t^3)/3 - 49144*t^2 + 24572*t + 1]
 
</pre><p>ところで、関数 &quot;exp&quot; は要素ごとの指数を計算します。</p><pre class="codeinput">X = exp(t*A)
</pre><pre class="codeoutput"> 
X =
 
[   1/exp(9*t),     exp(11*t),   1/exp(21*t),      exp(63*t),   1/exp(252*t)]
[    exp(70*t),   1/exp(69*t),    exp(141*t),   1/exp(421*t),    exp(1684*t)]
[ 1/exp(575*t),    exp(575*t), 1/exp(1149*t),    exp(3451*t), 1/exp(13801*t)]
[  exp(3891*t), 1/exp(3891*t),   exp(7782*t), 1/exp(23345*t),   exp(93365*t)]
[  exp(1024*t), 1/exp(1024*t),   exp(2048*t),  1/exp(6144*t),   exp(24572*t)]
 
</pre><p class="footer">Copyright 1993-2008 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Symbolic Matrix Computation % %  Copyright 1993-2008 The MathWorks, Inc. %  $Revision: 1.1.4.8.2.1 $  $Date: 2010/07/29 21:29:30 $  %% % Generate a possibly familiar test matrix, the 5-by-5 Hilbert matrix.  H = sym(hilb(5))  %% % The determinant is very small.  d = det(H)  %% % The elements of the inverse are integers.  X = inv(H)  %% % Verify that the inverse is correct.  I = X*H  %% % Find the characteristic polynomial.  p = poly(H)  %% % Try to factor the characteristic polynomial.  factor(p)  %% % % The result indicates that the characteristic polynomial % cannot be factored over the rational numbers.  %% % Compute 50 digit numerical approximations to the eigenvalues.  digits(50) e = eig(vpa(H))  %% % Create a generalized Hilbert matrix involving a free variable, t.  t = sym('t'); [I,J] = meshgrid(1:5); H = 1./(I+J-t)  %% % Substituting t = 1 retrieves the original Hilbert matrix.  subs(H,t,1)  %% % The reciprocal of the determinant is a polynomial in t.  d = 1/det(H)  d = expand(d)  pretty(d)  %% % The elements of the inverse are also polynomials in t.  X = inv(H)  %% % Substituting t = 1 generates the Hilbert inverse.  X = subs(X,t,'1') X = double(X)  %% % Investigate a different example.  A = sym(gallery(5))  %% % % This matrix is "nilpotent".  It's fifth power is the zero matrix.  A^5  %% % Because this matrix is nilpotent, its characteristic polynomial is very simple.  p = poly(A,'lambda')  %% % You should now be able to compute the matrix eigenvalues in your head. % They are the zeros of the equation lambda^5 = 0.  %% % Symbolic computation can find the eigenvalues exactly.  lambda = eig(A)   %% % Numeric computation involves roundoff error and finds the zeros of an equation % that is something like %     lambda^5 = eps*norm(A) % So the computed eigenvalues are roughly %     lambda = (eps*norm(A))^(1/5) % Here are the eigenvalues, computed by the Symbolic Toolbox using 16 digit % floating point arithmetic.  It is not obvious that they should all be zero.  digits(16) lambda = eig(vpa(A))  %% % This matrix is also "defective".  It is not similar to a diagonal matrix. % Its Jordan Canonical Form is not diagonal.  J = jordan(A)  %% % The matrix exponential, expm(t*A), is usually expressed in terms of scalar % exponentials involving the eigenvalues, exp(lambda(i)*t).  But for this matrix, % the elements of expm(t*A) are all polynomials in t.  t = sym('t'); E = simplify(expm(t*A))  %% % By the way, the function "exp" computes element-by-element exponentials.  X = exp(t*A)   displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>