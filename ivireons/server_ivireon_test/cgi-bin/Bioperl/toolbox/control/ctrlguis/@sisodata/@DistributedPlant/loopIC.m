function ICMat = loopIC(this,Config,e)
% Defines connectivity matrix for various loop configurations

%   Copyright 1986-2006 The MathWorks, Inc.
%   $Revision: 1.1.8.1 $  $Date: 2006/06/20 20:00:40 $

% UDDREVISIT: private static
switch Config
    case 1
      ICMat = [...
            0 0 0 0 1 0 1 0;...
            1 0 0 1 0 0 0 0;...
            1 0 0 1 0 0 0 0;...
            0 0 0 0 1 0 1 0;...
            0 e 0 0 0 e 0 1;...
            0 0 1 0 0 0 0 0];
        
    case 2
      ICMat = [...
            0 0 0 0 1 0 e 1;...
            1 0 0 1 0 0 0 0;...
            1 0 0 1 0 0 0 0;...
            0 0 0 0 1 0 e 1;...
            0 1 0 0 0 1 0 0;...
            0 0 1 0 0 0 0 0];  
        
    case 3
      ICMat = [...
            0 0 0 0 1 0 1 1;...
            1 0 0 1 0 0 0 0;...
            1 0 0 1 0 0 0 0;...
            0 0 0 0 1 0 1 1;...
            0 e 1 0 0 e 0 0;...
            0 0 1 0 0 0 0 0];
      
    case 4
      ICMat = [...
            0 0 0 0 1 0 1 e(2);...
            1 0 0 1 0 0 0 0;...
            1 0 0 1 0 0 0 0;...
            0 0 0 0 1 0 1 e(2);...
            0 e(1) 1 0 0 e(1) 0 0;...
            0 1 0 0 0 1 0 0];
               
    case 5
      ICMat = [...
            0  0 0 0 1 0 1 0;...
            0  0 0 0 0 0 1 0;...
            0  0 0 0 0 1 0 0;...
            1  0 1 0 0 0 0 0;...
            0  0 0 0 1 0 1 0;...
            1 -1 1 0 0 0 0 0; ...
            e(1) -e(1) e(1) 0 0 0 0 1; ...
            0  0 0 1 0 0 0 0];
        
    case 6
      ICMat = [...
            0 0 0 0 0 1 0 0 0 0 0 1 0;...
            1 0 0 0 0 0 1 0 0 0 0 0 0;...
            1 0 0 0 0 0 0 0 0 0 0 0 0;...
            0 1 0 0 0 0 0 1 0 0 0 0 0;...
            0 0 0 0 0 1 0 0 0 0 0 1 0;...
            1 0 0 0 0 0 0 0 0 0 0 0 0;...
            1 0 0 0 0 0 1 0 0 0 0 0 0;... 
            0 1 0 0 0 0 0 1 0 0 0 0 0;...
            0 0 0 e(1) 0 0 0 0 0 e(1) 0 0 1;...
            0 0 e(2) 0 0 0 0 0 e(2) 0 1 0 0;...
            0 0 0 0 1 0 0 0 0 0 0 0 0];
            
end