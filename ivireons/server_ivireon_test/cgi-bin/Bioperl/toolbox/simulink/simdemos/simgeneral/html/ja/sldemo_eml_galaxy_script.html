
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>Embedded MATLAB&reg; Function を使った螺旋状の銀河形成シミュレーション</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="sldemo_eml_galaxy_script.m"><link rel="stylesheet" type="text/css" href="../../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit sldemo_eml_galaxy_script">エディターで sldemo_eml_galaxy_script.m を開く</a></div><div class="right"><a href="matlab:echodemo sldemo_eml_galaxy_script">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>Embedded MATLAB&reg; Function を使った螺旋状の銀河形成シミュレーション</h1><!--introduction--><p>このモデルは、有名な論文 &quot;Galactic Bridges and Tails&quot; (Toomre &amp; Toomre 1972) に影響を受けて作られました。 この論文では、円盤型の銀河に渦巻腕ができる過程が説明されていました。 2 つの円盤型の銀河はもともと互いに遠く離れていました。 しかし、衝突しそうなほど互いに接近しました。 銀河が互いに接近すると、相互重力がはたらいて渦巻腕が形成されます。</p><p>&quot;PlotAll&quot; 可視化ブロックでプロット ルーチンが使用されることを別にすれば、このモデル内のすべての Embedded MATLAB&reg; 関数ブロックで、Real-Time Workshop&reg; と Real-Time Workshop&reg; Embedded Coder™ を使用したコード生成がサポートされています。</p><div><ul><li><b>デモの要件: </b> このデモの実行中、現在の作業ディレクトリ (pwd) 内に作成された Simulink プロジェクト ディレクトリにシミュレーションのコードが生成されます。 現在のディレクトリに影響を与えたくない (またはこのディレクトリにファイルを生成できない) 場合は、作業ディレクトリを変更する必要があります。</li></ul></div><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">モデルを開いてシミュレーションを実行</a></li><li><a href="#2">モデルの説明</a></li><li><a href="#8">モデルを閉じる</a></li><li><a href="#10">このモデルに関するコメント</a></li><li><a href="#11">参照</a></li></ul></div><h2>モデルを開いてシミュレーションを実行<a name="1"></a></h2><p>モデルを開き、以下のコードを実行することによってシミュレーションを実行します。 MATLAB&reg; ヘルプを使用している場合は、実行するコードを選択し、F9 を押します (またはコードを選択し、右クリックして [選択を実行] をクリックします)。 Simulink モデルが読み込まれ、コンパイルされ、実行されます。</p><pre class="codeinput">model = <span class="string">'sldemo_eml_galaxy'</span>;
open_system(model);
sim(model);
</pre><img vspace="5" hspace="5" src="../sldemo_eml_galaxy_script_01.png" alt=""> <img vspace="5" hspace="5" src="../sldemo_eml_galaxy_script_02.png" alt=""> <h2>モデルの説明<a name="2"></a></h2><p>この節では、このモデルについて詳述し、このモデル内の各ブロックの役割を説明します。 緑色のブロックの役割はシミュレーションの初期化です。オレンジ色のブロックはシミュレーションの中核です。黄色のブロックの役割は銀河アニメーションの表示です。</p><p><b>初期条件</b></p><p>このモデルでは、各銀河に初期条件が必要です。 これらの初期条件は、 銀河の半径がパーセク (rp)、質量が太陽質量単位 (cm)、位置がパーセク (pos)、速度が m/ 秒 (vel) として与えられます。</p><p>このモデルでは、Constant ブロックで初期条件が指定されます。 初期条件は、ある時点で銀河が互いに衝突しそうなほど接近するように選択されています。</p><p><b>&quot;ConstructGalaxy&quot; ブロック</b></p><p>初期条件は Embedded MATLAB 関数ブロック Construct Galaxy 1 および Construct Galaxy 2 に渡されます。これらの Embedded MATLAB 関数ブロックには、銀河モデルを作成する MATLAB コードが含まれています。</p><p>典型的な銀河では、質量の大半がその中心部に集中し、超大質量ブラック ホールまたは星の凝集 (あるいはその両方) を形成しています。 私たちは銀河を、半径が r で大半の質量が半径 r/3 の内円に集中している円盤状のものとしてモデル化しています。この超大質量の中心核に加えて、&quot;ConstructGalaxy&quot; Embedded MATLAB 関数ブロックでは、太陽質量が 4 ～ 24 のランダムな星が 349 個作成されます。 これらの星は、銀河の中心から r/3 ～ r の範囲内にランダムに配置されます。 これらの星は最初、銀河の中心核を中心とする円軌道上を進んでいます。 各オブジェクト (星または銀河の中心核) には、質量、位置 (x、y、z)、速度 (Vx、Vy、Vz) が設定されています。</p><p><b>&quot;Matrix Concatenation&quot; ブロック</b></p><p>このブロックでは、両方の銀河に関する情報が結びつけられます。 この時点で、このモデルには 750 個のオブジェクトがあります。 中心核が各銀河に 1 個、星が 各中心核の周囲に 349 個あります。  これら 750 個のオブジェクトの相互作用は、ニュートン力学に基づいています。</p><p><b>&quot;Partition&quot; ブロック</b></p><p>この Embedded MATLAB 関数ブロックにより、750 個すべてのオブジェクトが、 重量体と軽量体という 2 つのグループに分けられます。 重量体は銀河の中心核です。 軽量体は星です。 銀河の中心核と個々の星とでは質量に大きな差があるため、このモデルでは、重量体と重量体、重量体と軽量体との相互作用のみが考慮されます。 軽量体どうしの相互作用は無視できます。 そうすることで時間を大幅に節約できます。750 個のうち 748 個が軽量体であるからです。</p><p><b>&quot;ApplyGravity&quot; ブロック</b></p><p>この Embedded MATLAB 関数ブロックでは、各ステップで物体の速度および位置の計算にニュートン力学が使用されます。  &quot;combine&quot; ブロックも Embedded MATLAB 関数ブロックです。 重量体と軽量体に関するデータがマージされます。</p><p><b>&quot;PlotAll&quot; ブロック</b></p><p>この Embedded MATLAB 関数ブロックでは、シミュレーションの各ステップで物体が Figure にプロットされ、各星の位置が更新されます。</p><h2>モデルを閉じる<a name="8"></a></h2><p>変更内容を保存せずにモデルを閉じます。 シミュレーションやデモによって生成されたデータを消去します。</p><pre class="codeinput">close_system(model,0);
clear <span class="string">model</span> <span class="string">sldemo_eml_galaxy_output</span>;
</pre><p><b>メモ:</b></p><div><ul><li>このモデルでは、信号ログがオンになっています ([GalaxyBodies] 信号とその隣の小さな青い矢印を参照)。 このモデルでは、出力データが <tt>Simulink.ModelDataLogs</tt> 構造体に保存されます。 その他のデータで MATLAB ワークスペースをあふれさせることがないように、モデル ワークスペースで保存、変更されます。</li></ul></div><div><ul><li>信号ログ設定を変更するには、信号の行を右クリックし、[信号プロパティ] をクリックします。 このデモでは、信号名は [GalaxyBodies] であり、[信号データのログ] チェック ボックスがオンになっています。</li></ul></div><div><ul><li>ログが作成された信号は、MATLAB ワークスペースに [sldemo_eml_galaxy_output] として保存されます。 これは <tt>Simulink.ModelDataLogs</tt> データ構造体です。 [GalaxyBodies] 信号は、<tt>sldemo_eml_galaxy_output.GalaxyBodies</tt> と入力することによって、この構造体から取得できます。 データ構造体の取り扱いの詳細は、MATLAB Help 『構造体配列内のデータへのアクセス』を参照してください。</li></ul></div><h2>このモデルに関するコメント<a name="10"></a></h2><p>このモデルは単純ですが、私たちの銀河が進化した過程についての洞察を与えてくれます。 このデモを使用すると、このモデルを可能な限り単純化し、シミュレーションを短時間で実行することができます。 銀河を追加してデモを変更するのも簡単です。</p><h2>参照<a name="11"></a></h2><p>Toomre, Alar; Toomre, Juri; &quot;Galactic Bridges and Tails&quot;; Astrophysical Journal, Vol. 178, pp. 623-666 (1972); 12/1972;</p><p class="footer">Copyright 2006-2009 The MathWorks, Inc.<br> Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Spiral Galaxy Formation Simulation Using Embedded MATLAB(R) Functions %  % This model was inspired by the classic paper "Galactic Bridges and Tails" % (Toomre & Toomre 1972). The original paper explained how disc shaped galaxies % could develop spiral arms. Two disc shape galaxies originally are far apart. % They then fly by each other and almost collide. Once the galaxies are close % enough, mutual gravitational forces cause spiral arms to form. %  % Except for the "PlotAll" visualization block's use of plotting routines, all % Embedded MATLAB(R) function blocks in this model support code generation with % Real-Time Workshop(R) and Real-Time Workshop(R) Embedded Coder(TM). %  % * *Demo Requirements:* During this demonstration, Simulink(R) generates code for % the simulation in a Simulink project directory created in the current working % directory (pwd). If you do not want to affect the current directory (or if you % cannot generate files in this directory), you should change your working % directory. %   %   Copyright 2006-2009 The MathWorks, Inc.  %% Opening the Model and Running the Simulation % % Open the model and run the simulation by executing the code below. If you % are using MATLAB(R) Help, select the code you want to execute and press F9 % (or select code, right click on selection and select "Evaluate % Selection"). The Simulink model will load, compile, and run.  model = 'sldemo_eml_galaxy'; open_system(model);   sim(model);  %% Model Description % % This section describes the model in detail and explains the role of each block % in the model. The green blocks initialize the simulation, the orange blocks % are the core of the simulation, and the yellow block makes the galaxy % animation view. % % *Initial Conditions* % % The model requires initial conditions for each galaxy. The initial conditions % are: galaxy radius in parsecs (rp), galaxy mass in solar mass units (cm), % galaxy position in parsecs (pos), and galaxy velocity in m/s (vel). % % In the model, constant blocks specify the initial conditions. The initial % conditions have been chosen such that the galaxies will nearly collide at some % point in time.  %% % *"ConstructGalaxy" Blocks* % % The initial conditions are passed to the Embedded MATLAB function blocks % Construct Galaxy 1 and Construct Galaxy 2. These Embedded MATLAB function % blocks contain MATLAB code that builds the galaxy models. % % In a typical galaxy, most of the mass is concentrated in its center as a % super-massive black hole and/or star agglomeration. We model the galaxy as a % disc with radius r with most of its mass concentrated in the inner circle of % radius r/3. In addition to this super-massive nucleus, the "ConstructGalaxy" % Embedded MATLAB function block creates 349 random stars with masses ranging % from 4 to 24 solar masses. These stars are randomly positioned within distance % r/3 and r from the center of the galaxy. The stars initially move in circular % orbits around the galaxy core. Every object (star or galaxy core) has mass, % position (x, y, z), and velocity (Vx, Vy, Vz).  %% % *"Matrix Concatenation" Block* % % This block joins information about both galaxies. At this point the model has % 750 objects: 1 core for each galaxy and 349 stars around each core.  These 750 % objects interact according to Newtonian mechanics. %  %% % *"Partition" Block* % % This Embedded MATLAB function block separates all 750 objects into % two groups: heavy bodies and light bodies. The heavy bodies are the galaxy cores.  % The light bodies are the stars. Because the galaxy cores % are much heavier than individual stars, the model will consider only % the heavy-heavy and heavy-light interactions. We can ignore the light-light % body interactions. This will save a lot of time since 748 % out of 750 bodies in the model are light.  %% % *"ApplyGravity" Block* % % This Embedded MATLAB function block uses Newtonian mechanics to compute the % velocities and positions of the bodies at each step.  The "combine" block is % also an embedded MATLAB function block. It merges the data about heavy and % light objects together.  %%  % *"PlotAll" Block* % % This Embedded MATLAB function block plots the bodies in a figure and updates % the position of each star at every step in the simulation.  %% Closing the Model % % Close the model without saving any changes. Clear data generated by simulation/demo.  close_system(model,0); clear model sldemo_eml_galaxy_output;  %% % *Note:*  % % * In this model signal logging is turned on (see the 'GalaxyBodies' % signal and the little blue arrow next to it). The model saves output data % in a |Simulink.ModelDataLogs| structure. Any other data is saved/modified % in the model workspace to avoid cluttering MATLAB workspace. % % * To modify signal logging settings right-click on the signal line and % select "Signal Properties". In this demo the signal name is % 'GalaxyBodies' and "Log signal data" checkbox is checked.  % % * The logged signal is saved to MATLAB workspace as % 'sldemo_eml_galaxy_output'. This is a |Simulink.ModelDataLogs| data % structure. 'GalaxyBodies' signal can be retrieved from this structure by % typing |sldemo_eml_galaxy_output.GalaxyBodies|. See more about working % with data structures in MATLAB Help "Accessing Data in Structure Arrays".   %% Comments About the Model % % Despite its simplicity, this model provides insight into how our own galaxy % evolved. The demo allows the user to maximally simplify the model and run a % fast simulation. The user can easily modify the demo by adding more galaxies.  %% References % % Toomre, Alar; Toomre, Juri; "Galactic Bridges and Tails"; Astrophysical % Journal, Vol. 178, pp. 623-666 (1972); 12/1972;  displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>