
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>推定周波数応答を使用して Simulink で PID コントローラーを設計</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="scdenginectrlpidpad.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit scdenginectrlpidpad">エディターで scdenginectrlpidpad.m を開く</a></div><div class="right"><a href="matlab:echodemo scdenginectrlpidpad">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>推定周波数応答を使用して Simulink で PID コントローラーを設計</h1><!--introduction--><p>このデモでは、Simulink でビルドされたプラントから推定される周波数応答を使用して PI コントローラーを設計する方法を説明します。これは、線形化プラント モデルが PID 設計に対して無効な場合 (たとえば、プラント モデルにゼロ ゲインがある場合など) に使用できる PID 設計の代替ワークフローです。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">モデルを開く</a></li><li><a href="#4">線形化 からのゼロ ゲインを伴うプラント モデルを取得する PID 調整器 </a></li><li><a href="#8">Sinestream 信号を使用した推定周波数応答データの取得</a></li><li><a href="#10">PID 調整器内の FRD システムを伴う PI の設計</a></li><li><a href="#13">Simulink モデルでの閉ループ性能のシミュレーション</a></li></ul></div><h2>モデルを開く<a name="1"></a></h2><p>少し時間をとって、モデルを調べます。</p><p><a href="matlab:open_system('scdenginectrlpidblock')">エンジン制御モデルを開く</a></p><pre class="codeinput">mdl = <span class="string">'scdenginectrlpidblock'</span>;
open_system(mdl)
</pre><img vspace="5" hspace="5" src="../scdenginectrlpidpad_01.png" alt=""> <p>PID ループには、スロットル角度を操作してエンジン速度を制御する並列形式の PI コントローラーが含まれています。PI コントローラーには、閉ループ システムを振動させる既定のゲインがあります。PID ブロックのダイアログから起動する PID 調整器を使用してコントローラーを設計します。</p><pre class="codeinput">open_system([mdl <span class="string">'/Engine Speed (rpm)'</span>])
sim(mdl);
</pre><img vspace="5" hspace="5" src="../scdenginectrlpidpad_02.png" alt=""> <h2>線形化 からのゼロ ゲインを伴うプラント モデルを取得する PID 調整器<a name="4"></a></h2><p>この例では、PID ブロックによって検知されるプラントは、スロットル角度からエンジン速度です。線形化の入出力ポイントは、PID ブロック出力とエンジン速度測定でそれぞれ既に定義済みです。初期操作点での線形化では、ゼロ ゲインのあるプラント モデルが作成されます。</p><pre class="codeinput"><span class="comment">% Hide scope</span>
close_system([mdl <span class="string">'/Engine Speed (rpm)'</span>])
<span class="comment">% Obtain the linearization input and output points</span>
io = getlinio(mdl);
<span class="comment">% Linearize the plant at initial operating point</span>
linsys = linearize(mdl,io)
</pre><pre class="codeoutput"> 
d = 
                Throttle Ang
   EngineSpeed             0
 
Static gain.
</pre><p>ゼロ ゲイン取得は、線形化パス内にトリガーされたサブシステム &quot;Compression&quot; が存在すること、および分析的なブロックごとの線形化がイベント ベースのサブシステムをサポートしていないことが原因です。PID 調整器は線形プラント モデルを取得する場合と同じ方法を使用するため、PID 調整器は、ゼロ ゲインのあるプラントモデルも取得し、処理の起動中にそれを拒否します。</p><p>PID 調整器を起動するには、PID ブロック ダイアログを開き、[調整] ボタンをクリックします。初期操作点で線形化されたプラント モデルにゼロ ゲインがあること、および PID コントローラーの設計に使用できないことが示された情報ダイアログが表示されます。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdenginectrlpidblock/pid_informationdialog.png" alt=""> </p><p>線形プラント モデルを取得する別の方法として、Simulink モデルから周波数応答データを直接推定してから MATLAB ワークスペースで FRD システムを作成し、PID 調整器にインポートし直して PID 設計を継続する方法があります。</p><h2>Sinestream 信号を使用した推定周波数応答データの取得<a name="8"></a></h2><p>Sinestream の入力信号は、<b>frestimate</b> コマンドを使用した Simulink&reg; モデルの正確な周波数応答を推定するうえで最も信頼性の高い入力信号です。<b>frestimate</b> の使用方法についての詳細は、Simulink Control Design のデモ<a href="scdenginepad.html">シミュレーションベースの手法を使った周波数応答の推定</a>を参照してください。</p><p>この例では、0.1 ～ 10 ラジアン/秒の間の周波数をスイープする正弦ストリームを作成します。このストリームの振幅は、1e-3 に設定されています。推定結果は、ボード線図を使用して調査できます。</p><pre class="codeinput"><span class="comment">% Construct sine signal</span>
in = frest.Sinestream(<span class="string">'Frequency'</span>,logspace(-1,1,50),<span class="string">'Amplitude'</span>,1e-3);
<span class="comment">% Estimate frequency response</span>
sys = frestimate(mdl,io,in); <span class="comment">% this command may take a few minutes to finish</span>
<span class="comment">% Display Bode plot</span>
figure;
bode(sys);
</pre><img vspace="5" hspace="5" src="../scdenginectrlpidpad_03.png" alt=""> <h2>PID 調整器内の FRD システムを伴う PI の設計<a name="10"></a></h2><p>SYS は、初期操作点でプラント周波数応答を表現する FRD システムです。PID 調整器で使用するには、調整器の起動後にインポートする必要があります。PID ブロック ダイアログを開き、[調整] ボタンをもう一度クリックします。情報ダイアログが表示されたら、[継続] をクリックして起動プロセスを再開します。PID 調整器が起動されると、PID 設計用に新しいプラント モデルをインポートするかどうかを尋ねる [プラント モデルの取得] ダイアログが表示されます。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdenginectrlpidblock/pid_importdialog.png" alt=""> </p><p>中央のラジオ ボタンをクリックして、リスト内の [sys] を選択し、[OK] をクリックして FRD システムを PID 調整器にインポートします。自動化された設計によって、安定化コントローラーが返されます。ボード線図で応答として [開ループ] を選択すると、その線図に適切なゲイン余裕と位相余裕が表示されます。時間領域応答プロットは、FRD プラント モデルでは使用できません。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdenginectrlpidblock/pid_boderesponse.png" alt=""> </p><p>PID 調整器で [OK] ボタンをクリックします。PID 調整器は、P ゲインと I ゲインを PID ブロックに書き込み、終了します。</p><h2>Simulink モデルでの閉ループ性能のシミュレーション<a name="13"></a></h2><p>Simulink でのシミュレーションには、新しい PI コントローラーが非線形モデルの制御時に良好な性能で動作することが示されています。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdenginectrlpidblock/pid_stepresponse.png" alt=""> </p><p>モデルを閉じます。</p><pre class="codeinput">bdclose(mdl);
</pre><p class="footer">Copyright 2009-2010 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Designing PID Controller in Simulink with Estimated Frequency Response % This demo shows how to design a PI controller with frequency response % estimated from a plant built in Simulink. This is an alternative PID % design workflow when the linearized plant model is invalid for PID % design (for example, when the plant model has zero gain).  %   Copyright 2009-2010 The MathWorks, Inc. %   $Revision: 1.1.2.1 $  $Date: 2010/07/29 21:29:23 $  %% Opening the Model % Take a few moments to explore the model.  %% % <matlab:open_system('scdenginectrlpidblock') Open the engine control model> mdl = 'scdenginectrlpidblock'; open_system(mdl)  %% % The PID loop includes a PI controller in parallel form that manipulates % the throttle angle to control the engine speed. The PI controller has % default gains that makes the closed loop system oscillate. We want to % design the controller using the PID Tuner that is launched from the PID % block dialog. open_system([mdl '/Engine Speed (rpm)']) sim(mdl);  %% PID Tuner Obtaining a Plant Model with Zero Gain From Linearization % In this example, the plant seen by the PID block is from throttle angle % to engine speed. Linearization input and output points are already % defined at the PID block output and the engine speed measurement % respectively. Linearization at the initial operating point gives a plant % model with zero gain.  % Hide scope close_system([mdl '/Engine Speed (rpm)']) % Obtain the linearization input and output points  io = getlinio(mdl); % Linearize the plant at initial operating point linsys = linearize(mdl,io)  %% % The reason for obtaining zero gain is that there is a triggered subsystem % "Compression" in the linearization path and the analytical block-by-block % linearization does not support events-based subsystems. Since the PID % Tuner uses the same approach to obtain a linear plant model, the PID % Tuner also obtains a plant model with zero gain and reject it during the % launching process.  %% % To launch the PID Tuner, open the PID block dialog and click Tune button. % An information dialog shows up and indicates that the plant model % linearized at initial operating point has zero gain and cannot be used to % design a PID controller. % % <<../html_extra/scdenginectrlpidblock/pid_informationdialog.png>>  %% % The alternative way to obtain a linear plant model is to directly % estimate the frequency response data from the Simulink model, create % an FRD system in MATLAB Workspace, and import it back to the PID Tuner % to continue PID design.  %% Obtaining Estimated Frequency Response Data Using Sinestream Signals % Sinestream input signal is the most reliable input signal for estimating % an accurate frequency response of a Simulink® model using *frestimate* % command. More information on how to use *frestimate* can be found in the % demonstration <scdenginepad.html "Frequency Response Estimation Using % Simulation-Based Techniques"> in Simulink Control Design demos.  %% % In this example, we create a sine stream that sweeps frequency from 0.1 % to 10 rad/sec. Its amplitude is set to be 1e-3. You can inspect the % estimation results using the bode plot.  % Construct sine signal in = frest.Sinestream('Frequency',logspace(-1,1,50),'Amplitude',1e-3); % Estimate frequency response sys = frestimate(mdl,io,in); % this command may take a few minutes to finish % Display Bode plot figure; bode(sys);  %% Designing PI with the FRD System in PID Tuner % SYS is a FRD system that represents the plant frequency response at the % initial operating point. To use it in the PID Tuner, we need to import it % after the Tuner is launched. Open the PID block dialog and click Tune % button again. When the information dialog shows up, click "Continue" to % resume the launching process. After the PID Tuner is launched, an "Obtain % Plant Model" dialog shows up and asks you to import a new plant model for % PID design. % % <<../html_extra/scdenginectrlpidblock/pid_importdialog.png>>  %% % Click the radio button in the middle, select "sys" from the list, and % click "OK" to import the FRD system into the PID Tuner. The automated % design returns a stabilizing controller. Select "Open-loop" as the % response in the Bode plot and the plot shows reasonable gain and phase % margin. Time domain response plots are not available for FRD plant % models. % % <<../html_extra/scdenginectrlpidblock/pid_boderesponse.png>>  %% % Click "OK" button in the PID Tuner. The PID Tuner writes the P and I % gains to the PID block and closes.  %% Simulating Closed-Loop Performance in Simulink Model % Simulation in Simulink shows that the new PI controller provides good % performance when controlling the nonlinear model. % % <<../html_extra/scdenginectrlpidblock/pid_stepresponse.png>>  %% % Close the model. bdclose(mdl); displayEndOfDemoMessage(mfilename)    ##### SOURCE END ##### --></body></html>