
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>航空機の周波数領域特性の確認</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="scdaircraftpad.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit scdaircraftpad">エディターで scdaircraftpad.m を開く</a></div><div class="right"><a href="matlab:echodemo scdaircraftpad">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>航空機の周波数領域特性の確認</h1><!--introduction--><p>Simulink&reg; Control Design™ ソフトウェアには、シミュレーション中にモデルの線形応答が周波数領域特性を満たすかどうかを確認するための Simulink&reg; モデルを追加できるブロックが用意されています。このデモでは、航空機速度制御ループのゲイン余裕と位相余裕が装荷燃料の変化に従って確認されます。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">航空機モデル</a></li><li><a href="#3">ループのゲイン余裕と位相余裕の確認</a></li><li><a href="#5">線形システムのログ</a></li></ul></div><h2>航空機モデル<a name="1"></a></h2><p>以下のように航空機の Simulink モデルを開きます。</p><pre class="codeinput">open_system(<span class="string">'scdaircraft'</span>)
</pre><img vspace="5" hspace="5" src="../scdaircraftpad_01.png" alt=""> <p>航空機モデルは、巡航高度および巡航速度で飛行している長距離旅客機に基づいて作成されています。航空機は燃料満載の状態を開始点とし、あらかじめ指定された 8 時間の速度プロファイルに追従します。Simulink モデルは、機体速度を制御するために燃料の流量を調整する、非常に簡略化されたバージョンの速度制御ループです。モデルには、燃料消費をモデル化するための要素、結果として発生する機体質量の変化、および機体速度を制限する非線形ドラフト効果が含まれています。抵抗係数など、モデル内で使用されている定数は、モデル ワークスペースで定義済みで、スクリプトから初期化されます。</p><h2>ループのゲイン余裕と位相余裕の確認<a name="3"></a></h2><p>航空機モデルには、Simulink Control Design Model Verification ライブラリにある <tt>Check Gain and Phase Margins</tt> ブロックが含まれています。このブロックは、シミュレーション時間の 30 分ごとに <tt>Velocity Controller</tt> ブロックによって検知されたループの線形化を計算します。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdaircraft/LinearizationTab.png" alt=""> </p><p>ループのゲイン余裕と位相余裕がこのブロックによって計算され、以下が確認されます。</p><div><ul><li>ゲイン余裕が 30 dB より大きい</li></ul></div><div><ul><li>ゲイン余裕が 60&deg;より大きい</li></ul></div><p>余裕の計算中には、ループのフィードバック符号が指定されなければなりません。フィードバック符号を判定するには、IO によって定義済みのパスにフィードバックの和が含まれているかどうかを以下のように確認します。</p><div><ul><li>パスに加算ブロックがある場合、正のフィードバックを使用します。</li></ul></div><div><ul><li>パスに加算ブロックがない場合、加算ブロックで定義されているフィードバックを使用します。</li></ul></div><p><tt>Check Gain and Phase Margins</tt> ブロックで指定されている線形化 IO には、負のフィードバックのある加算ブロックがあります。したがって、ゲイン余裕および位相余裕を計算するために使用するフィードバック符号は正でなければなりません。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdaircraft/BoundsTab.png" alt=""> </p><p>ブロックには、計算済みのゲイン余裕と位相余裕がテーブル形式で表示されます。<b>[プロットの表示]</b> ボタンをクリックして、テーブル表示を開きます。</p><p>ブロック内の <b>[アサーション]</b> タブでは、ゲイン余裕および位相余裕が満たされなかった場合など、アサーションが失敗したときの警告のスローを指定します。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdaircraft/AssertionTab.png" alt=""> </p><p>モデルには、Simulink Control Design Linear Analysis Plots ライブラリにある <tt>Nichols Plot</tt> ブロックも含まれています。このブロックは、シミュレーション中の燃料質量の低下に伴うループ応答を計算します。<tt>Generate dynamic range events</tt> ブロックは、燃料質量がその最大質量の 10% の倍数になるごとに立ち上がりエッジを生成します。これらの立ち上がりエッジは、線形化をトリガーし、ニコルス線図に結果を表示します。[ブロック パラメーター] ダイアログ ボックスの <b>[プロットの表示]</b> を使用するとニコルス線図が開きます。</p><p>モデル内の <tt>Signal Builder</tt> ブロックは、航空機の速度プロファイルを定義します。Simulink Verification and Validation™ ソフトウェアがインストールされている場合、このブロックをダブルクリックすると、モデル内に含まれているチェック ブロックを表示する Verification Manager Tool が表示されます。詳細は、「<a href="http://www.mathworks.com/access/helpdesk/help/toolbox/slvnv/ug/f6010dfi2.html">Verification Manager の使用</a>」を参照してください。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdaircraft/SignalBuilderDlg.png" alt=""> </p><p>指定されているゲイン余裕と位相余裕が満たされているかどうかを確認するには、<tt>Signal Builder</tt> ブロックのウィンドウまたは Simulink モデルの <tt>[シミュレーションの開始]</tt> ボタンをクリックしてモデルをシミュレーションします。</p><pre class="codeinput">sim(<span class="string">'scdaircraft'</span>);
</pre><pre class="codeoutput">Warning:Assertion detected in 'scdaircraft/Check Gain and Phase Margins' at
time 27007.9 
Warning:Assertion detected in 'scdaircraft/Check Gain and Phase Margins' at
time 28800 
</pre><p><img vspace="5" hspace="5" src="../../html_extra/scdaircraft/TabularDisplay.png" alt=""> </p><p><img vspace="5" hspace="5" src="../../html_extra/scdaircraft/NicholsPlot.png" alt=""> </p><p>テーブルには以下の項目が表示されます。</p><div><ul><li>制御ループが線形化された時刻</li></ul></div><div><ul><li>計算済みのゲイン余裕と位相余裕</li></ul></div><p>指定された範囲外の余裕は、赤で表示されます。シミュレーションの終盤に燃料質量と機体速度が低下したときに位相余裕が限界を超えています。ニコルス線図には、装荷燃料と機体速度の変化に伴って小規模なループ応答が示されています。</p><p>このテーブルは、線形化の計算が正確に 30 分ごとに行われたのではなく、30 分前後で計算されたことを示しています。これは、ブロックのゼロ クロッシング検出が有効になっていないためです。ブロックのゼロ クロッシングを有効にすると、正確に 30 分の間隔で線形化が計算されるようになりますが、シミュレーションの実行時間が増加する可能性があります。</p><p>[ブロック パラメーター] ダイアログ ボックスの <b>[ゼロ クロッシング検出を有効にする]</b> オプションをオンにするか、ブロック コマンド ライン API を使用して以下のようにゼロ クロッシング検出を有効にします。</p><pre class="codeinput">set_param(<span class="string">'scdaircraft/Check Gain and Phase Margins'</span>,<span class="string">'ZeroCross'</span>,<span class="string">'on'</span>)
sim(<span class="string">'scdaircraft'</span>);
</pre><pre class="codeoutput">Warning:Assertion detected in 'scdaircraft/Check Gain and Phase Margins' at
time 27000 
Warning:Assertion detected in 'scdaircraft/Check Gain and Phase Margins' at
time 28800 
</pre><h2>線形システムのログ<a name="5"></a></h2><p><tt>Check Gain and Phase Margins</tt> ブロックの <b>[ログ]</b> タブでは、計算された線形システムがワークスペース変数に保存されるように指定できます。</p><p><img vspace="5" hspace="5" src="../../html_extra/scdaircraft/LoggingTab.png" alt=""> </p><p>線形システムは、<tt>time</tt> フィールドと <tt>values</tt> フィールドのある構造体にログされます。</p><pre class="codeinput">LinearAircraft
</pre><pre class="codeoutput">
LinearAircraft = 

         time: [17x1 double]
       values: [4-D ss]
    blockName: 'scdaircraft/Check Gain and Phase Margins'

</pre><p><tt>values</tt> フィールドは、線形システムを LTI 状態空間システムの配列として保存します (詳細は、Control System Toolbox ドキュメンテーションの「<a href="matlab:helpview([docroot,'/toolbox/control/control.map'],'concept_of_an_lti_array')">LTI モデルの配列</a>」を参照してください)。</p><p>個別のシステムは、<tt>values</tt> フィールド内にインデックス化することで取得できます。</p><pre class="codeinput">L = LinearAircraft.values(:,:,17)
</pre><pre class="codeoutput"> 
a = 
                 scdaircraft/  scdaircraft/  scdaircraft/
   scdaircraft/      -0.01021             0             0
   scdaircraft/      -0.01149             0             0
   scdaircraft/      0.7793             0             -0.4038
 
b = 
                 Actuator
   scdaircraft/    0.3313
   scdaircraft/         0
   scdaircraft/         0
 
c = 
             scdaircraft/  scdaircraft/  scdaircraft/
   Actuator   -8.882e-016             1       -0.4038
 
d = 
             Actuator
   Actuator         0
 
Continuous-time model.
</pre><p>Simulink モデルを閉じます。</p><pre class="codeinput">bdclose(<span class="string">'scdaircraft'</span>)
clear(<span class="string">'LinearAircraft'</span>,<span class="string">'L'</span>)
</pre><p class="footer">Copyright 2010 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Verifying Frequency-Domain Characteristics of an Aircraft % % The Simulink(R) Control Design(TM) software provides blocks that you can % add to Simulink(R) models to check that the model's linear response  % satisfies frequency-domain characteristics during simulation. In this demo, % the gain and phase margins of an aircraft velocity control loop are checked % as the fuel load changes.    % Copyright 2010 The MathWorks, Inc. % $Revision: 1.1.2.1 $ $Date: 2010/07/29 21:29:21 $  %% Aircraft Model % % Open the Simulink model of an aircraft:  open_system('scdaircraft') %% % % The aircraft model is based on a long-haul passenger aircraft flying at cruising  % altitude and speed. The aircraft starts with a full fuel load and follows   % a pre-specified eight hour velocity profile. The Simulink model is a  % much simplified version of a velocity control loop % which adjusts the fuel flow rate to control the aircraft velocity. The % model includes elements to model fuel consumption and resulting changes in  % aircraft mass as well as nonlinear draft effects limiting aircraft % velocity. Constants used in the model, such as the drag coefficient, are  % defined in the model workspace and initializated from a script.   %% Verifying Loop Gain and Phase Margins % % The aircraft model contains a |Check Gain and Phase Margins| block from  % the Simulink Control Design Model Verification library. This block computes % the linearization of the loop seen by the |Velocity Controller| block  % every 30 minutes of simulated time. % % <<../html_extra/scdaircraft/LinearizationTab.png>> % % The block computes the loop gain and phase margins and % checks that: % % * The gain margin is greater than 30 dB % % * The phase margin is greater than 60 degrees % % When computing the margins, the loop feedback sign must be specified. To determine  % the feedback sign, check if the path defined by the IOs includes % the feedback summation: % % * If the path includes the summation block, use positive feedback. % % * If the path does not include the summation block, use the feedback defined by % the summation block. % % The linearization IOs specified in the |Check Gain and Phase Margins| block includes  % the summation block with negative feedback. Therefore, the feedback sign used to compute  % the gain and phase margins must be positive.  % % <<../html_extra/scdaircraft/BoundsTab.png>> % % The block shows the computed gain and phase margins in a % tabular format. Clicking *Show Plot* button opens the tabular % display.  % % The *Assertion* tab in the block specifies that a warning be thrown when  % the assertion fails, i.e., the gain and phase margins are not satisfied. % % <<../html_extra/scdaircraft/AssertionTab.png>> % % The model also includes a |Nichols Plot| block from the Simulink Control Design  % Linear Analysis Plots library, which computes the loop response as the  % fuel mass drops during the simulation. The |Generate dynamic range events| block  % generates a rising edge whenever the fuel mass is a  % multiple of 10% of the maximum fuel mass. These rising edges trigger a linearization  % and display the results on the Nichols plot. The *Show Plot* in the Block  % Parameters dialog box opens the Nichols plot.  % % The |Signal Builder| block in the model defines the  % velocity profile for the aircraft. If Simulink Verification and Validation(TM)  % software is installed, double-clicking the block shows the Verification Manager Tool  % which displays the check blocks included in the model. See % <http://www.mathworks.com/access/helpdesk/help/toolbox/slvnv/ug/f6010dfi2.html % Using the Verification Manager> for more information. % % <<../html_extra/scdaircraft/SignalBuilderDlg.png>> % % To check if the specified gain and phase margins are satisfied, simulate % the model by clicking the |Start simulation| button in the |Signal Builder| block window % or the Simulink model.    sim('scdaircraft');  %% % <<../html_extra/scdaircraft/TabularDisplay.png>> % % <<../html_extra/scdaircraft/NicholsPlot.png>> % % The tabular display shows: %  % * The times when the control loop is linearized. %  % * The computed gain and phase margins.  % % Margins that violate the specified bounds are shown in red. The phase  % margin bound is violated towards the end of the simulation when the fuel  % mass and airplane velocity have dropped. The Nichols plot indicates the % small loop response variations as the fuel load and aircraft velocity % change.  % % The table shows that the linearizations are not computed at % exactly every 30 min but at small variations of 30 min. This is % because zero-crossing detection for the block is not enabled. Enabling % zero-crossing for the block ensures that the linearizations are computed % at exactly 30 min intervals but may increase the time the simulation % takes to run. % % You can select the *Enable zero-crossing detection* option in the Block  % Parameters dialog box or use the block command line API to enable % zero-crossing detection: set_param('scdaircraft/Check Gain and Phase Margins','ZeroCross','on') sim('scdaircraft');  %% Logging the Linear Systems % The *Logging* tab in the |Check Gain and Phase Margins| block specifies  % that the computed linear systems be saved to a workspace variable.   % % <<../html_extra/scdaircraft/LoggingTab.png>> % % The linear systems are logged in a structure with |time| and |values| fields. LinearAircraft  %% % The |values| field stores the linear systems as an array of LTI state-space % systems (see <matlab:helpview([docroot,'/toolbox/control/control.map'],'concept_of_an_lti_array') Arrays of LTI Models>) % in Control System Toolbox documentation for more information).  % % You can retrieve the individual systems by indexing into the |values| field. L = LinearAircraft.values(:,:,17)  %% % Close the Simulink model: bdclose('scdaircraft') clear('LinearAircraft','L') displayEndOfDemoMessage(mfilename)    ##### SOURCE END ##### --></body></html>