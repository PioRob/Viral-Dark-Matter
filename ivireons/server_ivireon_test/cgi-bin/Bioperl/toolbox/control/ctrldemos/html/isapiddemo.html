
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Designing PID for Disturbance Rejection with PID Tuner</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-06-29"><meta name="DC.source" content="isapiddemo.m"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit isapiddemo">Open isapiddemo.m in the Editor</a></div><div class="right"><a href="matlab:echodemo isapiddemo">Run in the Command Window</a></div></div><div class="content"><h1>Designing PID for Disturbance Rejection with PID Tuner</h1><!--introduction--><p>PID Tuner is an interactive GUI tool for PID controller design. This demo shows how to use the PID Tuner to design a PI controller with good disturbance rejection performance and then extend it to a ISA-PID controller to enhance reference tracking performance.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Launching the PID Tuner with Initial PID Design</a></li><li><a href="#4">Tuning PID for Disturbance Rejection</a></li><li><a href="#11">Extending PID controller to ISA-PID Controller</a></li><li><a href="#14">Compare Performance</a></li></ul></div><h2>Launching the PID Tuner with Initial PID Design<a name="1"></a></h2><p>The plant model is</p><p><img src="isapiddemo_eq91962.png" alt="$$ G(s) = \frac{6(s+5)}{(s+1)(s+2)(s+3)(s+4)}e^{-s} $$"></p><pre class="codeinput">G = zpk(-5,[-1 -2 -3 -4],6,<span class="string">'OutputDelay'</span>,1);
G.InputName = <span class="string">'u'</span>;
G.OutputName = <span class="string">'y'</span>;
</pre><p>Use the following command to launch the PID Tuner to design a PI controller in parallel form for plant G.</p><pre> pidtool(G,'pi')</pre><p>The PID Tuner automatically designs an initial PI controller. Click "Show parameters" button to display the controller gains and performance metrics.</p><p><img vspace="5" hspace="5" src="../html/isapiddemo1.png" alt=""> </p><p>For step reference tracking, the settling time is about 12 seconds and the overshoot is about 6.3 percent, which is acceptable for this example.</p><h2>Tuning PID for Disturbance Rejection<a name="4"></a></h2><p>Assume that a step disturbance occurs at the plant input and the main purpose of the PI controller is to reject this disturbance quickly. In the rest of this section, we will demonstrate how to design the PI controller for better disturbance rejection in the PID Tuner. We also expect that the reference tracking performance is degraded as disturbance rejection performance improves.</p><p>Because the attenuation of low frequency disturbance is inversely proportional to integral gain Ki, maximizing the integral gain is a useful heuristic to obtain a PI controller with good disturbance rejection. For background, see Karl Astrom et al., "Advanced PID Control", Chapter 4 "Controller Design", 2006, The ISA Society.</p><p>Switch <b>Response</b> to <b>Input disturbance rejection</b>, The peak deviation is about 1 and it settles to less than 0.1 in about 9 seconds.</p><p><img vspace="5" hspace="5" src="../html/isapiddemo2.png" alt=""> </p><p>Move the slider to the right to increase the response speed (open loop bandwidth). The Ki gain in the <b>Controller parameters</b> table first increases and then decreases, with the maximum value occurring at 0.3. When Ki is 0.3, the peak deviation is reduced to 0.9 (about 10% improvement) and it settles to less than 0.1 in about 6.7 seconds (about 25% improvement).</p><p><img vspace="5" hspace="5" src="../html/isapiddemo3.png" alt=""> </p><p>Switch the response back to <b>Reference tracking</b>. Because we increase the bandwidth, the step reference tracking response becomes more oscillated. Additionally the overshoot exceeds 15 percent, which is usually unacceptable. This type of performance trade off between reference tracking and disturbance rejection often exists because a single PID controller is not able to satisfy both design goals at the same time.</p><p><img vspace="5" hspace="5" src="../html/isapiddemo4.png" alt=""> </p><p>Export the designed PI controller to MATLAB Workspace by clicking the second toolbar button. The controller is represented by a PID object and you need it to create an ISA-PID controller in the next section.</p><p><img vspace="5" hspace="5" src="../html/isapiddemo5.png" alt=""> </p><p>You can also manually create the same PI controller in MATLAB Workspace by using the <b>pid</b> command. In this command you can directly specify the Kp and Ki gains obtained from the parameter table of the PID Tuner.</p><pre class="codeinput">C = pid(0.64362,0.30314);
C.InputName = <span class="string">'e'</span>;
C.OutputName = <span class="string">'u'</span>;
C
</pre><pre class="codeoutput">Continuous-time PI controller in parallel form, from input "e" to output "u":
 
           1 
Kp + Ki * ---
           s 
 
with Kp = 0.64362, Ki = 0.30314
 
</pre><h2>Extending PID controller to ISA-PID Controller<a name="11"></a></h2><p>A simple solution to make a PI controller perform well for both reference tracking and disturbance rejection is to upgrade it to an ISA-PID controller. It improves reference tracking response by providing an additional tuning parameters <b>b</b> that allows independent control of the impact of the reference signal on the proportional action.</p><p><img vspace="5" hspace="5" src="../html/isapiddemo6.png" alt=""> </p><p>In the above ISA-PID structure, there is a feedback controller C and a feed-forward filter F. In this example, C is a regular PI controller in parallel form that can be represented by a PID object:</p><p><img src="isapiddemo_eq34968.png" alt="$$ C(s) = pid(Kp,Ki) = Kp + \frac{Ki}{s} $$"></p><p>F is a pre-filter that involves Kp and Ki gains from C plus the set-point weight <b>b</b>:</p><p><img src="isapiddemo_eq10932.png" alt="$$ F(s) = \frac{b*Kp*s+Ki}{Kp*s+Ki} $$"></p><p>Therefore the ISA-PID controller has two inputs (r and y) and one output (u).</p><p>Set-point weight <b>b</b> is a real number between 0 and 1.  When it decreases, the overshoot in the reference tracking response is reduced. In this example, <b>b</b> is chosen to be 0.7.</p><pre class="codeinput">b = 0.7;
<span class="comment">% the following code constructs an ISA-PID from the feedback controller PID</span>
F = tf([b*C.Kp C.Ki],[C.Kp C.Ki]);
F.InputName = <span class="string">'r'</span>;
F.OutputName = <span class="string">'uf'</span>;
Sum = sumblk(<span class="string">'e'</span>,<span class="string">'uf'</span>,<span class="string">'y'</span>,<span class="string">'+-'</span>);
ISAPID = connect(C,F,Sum,{<span class="string">'r'</span>,<span class="string">'y'</span>},<span class="string">'u'</span>);
ISAPID
</pre><pre class="codeoutput"> 
Transfer function from input "r" to output "u":
0.4505 s^2 + 0.5153 s + 0.1428
------------------------------
        s^2 + 0.471 s
 
Transfer function from input "y" to output "u":
-0.6436 s - 0.3031
------------------
        s
 
</pre><h2>Compare Performance<a name="14"></a></h2><p>The reference tracking response with ISA-PID controller has much less overshoot because set-point weight <b>b</b> reduces overshoot.</p><pre class="codeinput"><span class="comment">% Closed-loop system with PI controller for reference tracking</span>
sys1 = feedback(ss(G)*C,1);
set(sys1,<span class="string">'Name'</span>,<span class="string">'PID'</span>);
<span class="comment">% Closed-loop ISA-PID system with ISA-PID controller for reference tracking</span>
sys2 = connect(ISAPID,ss(G),<span class="string">'r'</span>,<span class="string">'y'</span>);
set(sys2,<span class="string">'Name'</span>,<span class="string">'ISA-PID'</span>);
<span class="comment">% Compare responses</span>
figure;
step(sys1,<span class="string">'r-'</span>,sys2,<span class="string">'b.'</span>);
legend(<span class="string">'show'</span>,<span class="string">'location'</span>,<span class="string">'southeast'</span>)
title(<span class="string">'Reference Tracking'</span>)
</pre><img vspace="5" hspace="5" src="isapiddemo_01.png" alt=""> <p>The disturbance rejection responses are the same because set-point weight <b>b</b> only affects reference tracking.</p><pre class="codeinput"><span class="comment">% Closed-loop system with PI controller for disturbance rejection</span>
sysd1 = feedback(ss(G),C);
set(sysd1,<span class="string">'Name'</span>,<span class="string">'PID'</span>);
<span class="comment">% Closed-loop system with ISA-PID controller for disturbance rejection</span>
sysd2 = connect(ISAPID,ss(G),<span class="string">'u'</span>,<span class="string">'y'</span>);
set(sysd2,<span class="string">'Name'</span>,<span class="string">'ISA-PID'</span>);
<span class="comment">% Compare responses</span>
figure;
step(sysd1,<span class="string">'r-'</span>,sysd2,<span class="string">'b.'</span>);
legend(<span class="string">'PID'</span>,<span class="string">'ISA-PID'</span>);
title(<span class="string">'Disturbance Rejection'</span>)
</pre><img vspace="5" hspace="5" src="isapiddemo_02.png" alt=""> <p class="footer">Copyright 2009-2010 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Designing PID for Disturbance Rejection with PID Tuner
% PID Tuner is an interactive GUI tool for PID controller design. This demo
% shows how to use the PID Tuner to design a PI controller with good
% disturbance rejection performance and then extend it to a ISA-PID
% controller to enhance reference tracking performance.

%   Copyright 2009-2010 The MathWorks, Inc.
%   $Revision: 1.1.8.1 $  $Date: 2010/05/10 16:58:28 $

%% Launching the PID Tuner with Initial PID Design
% The plant model is
%
% $$ G(s) = \frac{6(s+5)}{(s+1)(s+2)(s+3)(s+4)}e^{-s} $$
%
G = zpk(-5,[-1 -2 -3 -4],6,'OutputDelay',1);
G.InputName = 'u';  
G.OutputName = 'y';

%%
% Use the following command to launch the PID Tuner to design a PI
% controller in parallel form for plant G.
%
%   pidtool(G,'pi')
%
% The PID Tuner automatically designs an initial PI controller. Click "Show
% parameters" button to display the controller gains and performance
% metrics.
%
% <<../html/isapiddemo1.png>>

%% 
% For step reference tracking, the settling time is about 12 seconds and
% the overshoot is about 6.3 percent, which is acceptable for this example.

%% Tuning PID for Disturbance Rejection
% Assume that a step disturbance occurs at the plant input and the main
% purpose of the PI controller is to reject this disturbance quickly.
% In the rest of this section, we will demonstrate how to design the PI
% controller for better disturbance rejection in the PID Tuner. We also
% expect that the reference tracking performance is degraded as disturbance
% rejection performance improves.

%%
% Because the attenuation of low frequency disturbance is inversely
% proportional to integral gain Ki, maximizing the integral gain is a
% useful heuristic to obtain a PI controller with good disturbance
% rejection. For background, see Karl Astrom et al., "Advanced PID
% Control", Chapter 4 "Controller Design", 2006, The ISA Society.

%%
% Switch *Response* to *Input disturbance rejection*, The peak deviation is
% about 1 and it settles to less than 0.1 in about 9 seconds.
%
% <<../html/isapiddemo2.png>>

%%
% Move the slider to the right to increase the response speed (open loop
% bandwidth). The Ki gain in the *Controller parameters* table first
% increases and then decreases, with the maximum value occurring at
% 0.3. When Ki is 0.3, the peak deviation is reduced to 0.9 (about 10%
% improvement) and it settles to less than 0.1 in about 6.7 seconds (about
% 25% improvement).
%
% <<../html/isapiddemo3.png>>

%%
% Switch the response back to *Reference tracking*. Because we increase the
% bandwidth, the step reference tracking response becomes more oscillated.
% Additionally the overshoot exceeds 15 percent, which is usually
% unacceptable. This type of performance trade off between reference
% tracking and disturbance rejection often exists because a single PID
% controller is not able to satisfy both design goals at the same time.
%
% <<../html/isapiddemo4.png>>

%%
% Export the designed PI controller to MATLAB Workspace by clicking the
% second toolbar button. The controller is represented by a PID object and
% you need it to create an ISA-PID controller in the next section.
%
% <<../html/isapiddemo5.png>>

%%
% You can also manually create the same PI controller in MATLAB Workspace
% by using the *pid* command. In this command you can directly specify the
% Kp and Ki gains obtained from the parameter table of the PID Tuner.
C = pid(0.64362,0.30314);
C.InputName = 'e';  
C.OutputName = 'u';
C

%% Extending PID controller to ISA-PID Controller 
% A simple solution to make a PI controller perform well for both
% reference tracking and disturbance rejection is to upgrade it to an
% ISA-PID controller. It improves reference tracking response by providing
% an additional tuning parameters *b* that allows independent control of
% the impact of the reference signal on the proportional action.
%
% <<../html/isapiddemo6.png>>

%%
% In the above ISA-PID structure, there is a feedback controller C and a
% feed-forward filter F. In this example, C is a regular PI controller in
% parallel form that can be represented by a PID object:
%
% $$ C(s) = pid(Kp,Ki) = Kp + \frac{Ki}{s} $$
%
% F is a pre-filter that involves Kp and Ki gains from C plus the set-point
% weight *b*:
%
% $$ F(s) = \frac{b*Kp*s+Ki}{Kp*s+Ki} $$
%
% Therefore the ISA-PID controller has two inputs (r and y) and one output
% (u).

%%
% Set-point weight *b* is a real number between 0 and 1.  When it decreases,
% the overshoot in the reference tracking response is reduced. In this
% example, *b* is chosen to be 0.7. 
b = 0.7;
% the following code constructs an ISA-PID from the feedback controller PID
F = tf([b*C.Kp C.Ki],[C.Kp C.Ki]);
F.InputName = 'r';  
F.OutputName = 'uf';
Sum = sumblk('e','uf','y','+-');
ISAPID = connect(C,F,Sum,{'r','y'},'u');
ISAPID

%% Compare Performance
% The reference tracking response with ISA-PID controller has much less
% overshoot because set-point weight *b* reduces overshoot.

% Closed-loop system with PI controller for reference tracking 
sys1 = feedback(ss(G)*C,1);
set(sys1,'Name','PID');
% Closed-loop ISA-PID system with ISA-PID controller for reference tracking 
sys2 = connect(ISAPID,ss(G),'r','y');
set(sys2,'Name','ISA-PID');
% Compare responses
figure;
step(sys1,'r-',sys2,'b.');
legend('show','location','southeast')
title('Reference Tracking')

%%
% The disturbance rejection responses are the same because set-point weight
% *b* only affects reference tracking.

% Closed-loop system with PI controller for disturbance rejection
sysd1 = feedback(ss(G),C);
set(sysd1,'Name','PID');
% Closed-loop system with ISA-PID controller for disturbance rejection
sysd2 = connect(ISAPID,ss(G),'u','y');
set(sysd2,'Name','ISA-PID');
% Compare responses
figure;
step(sysd1,'r-',sysd2,'b.');
legend('PID','ISA-PID');
title('Disturbance Rejection')

%%
displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
--></body></html>