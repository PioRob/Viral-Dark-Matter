
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>AUTOSAR ソフトウェア コンポーネントのインポートとエクスポート</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="rtwdemo_autosar_roundtrip_script.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit rtwdemo_autosar_roundtrip_script">エディターで rtwdemo_autosar_roundtrip_script.m を開く</a></div><div class="right"><a href="matlab:echodemo rtwdemo_autosar_roundtrip_script">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>AUTOSAR ソフトウェア コンポーネントのインポートとエクスポート</h1><!--introduction--><p>このデモでは、Simulink&reg; と共に AUTOSAR オーサリング ツールを使用して、AUTOSAR ソフトウェア コンポーネントを開発する方法を示します。 このデモでは、次の作業に取り組みます。</p><div><ol><li>AUTOSAR オーサリング ツールでソフトウェア コンポーネント インターフェイスを設計し、この情報を Simulink にインポートする</li><li>完成したソフトウェア コンポーネントを Simulink からエクスポートし、この情報を AUTOSAR オーサリング ツールに再びマージする</li></ol></div><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">AUTOSAR ソフトウェア コンポーネントの記述ファイルの概要</a></li><li><a href="#2">ソフトウェア コンポーネント インターフェイスの設計</a></li><li><a href="#3">AUTOSAR ソフトウェア コンポーネントの記述ファイルに必要な arxml.importer オブジェクトの作成</a></li><li><a href="#5">Simulink モデル スケルトンの作成</a></li><li><a href="#6">Simulink モデル スケルトン内での機能の実装</a></li><li><a href="#7">適用できるテスト ハーネスの作成</a></li><li><a href="#8">AUTOSAR ソフトウェア コンポーネントに対するコードのエクスポートと生成</a></li><li><a href="#9">オーサリング ツールへのマージ</a></li><li><a href="#10">詳細情報</a></li></ul></div><h2>AUTOSAR ソフトウェア コンポーネントの記述ファイルの概要<a name="1"></a></h2><p>AUTOSAR ソフトウェア コンポーネントを構成する成果物を複数の XML ファイルに配布できます。 AUTOSAR オーサリング ツールまたは Simulink&reg; を使用してファイルを作成できます。</p><h2>ソフトウェア コンポーネント インターフェイスの設計<a name="2"></a></h2><p>AUTOSAR オーサリング ツールを使用して、ソフトウェア コンポーネントに対して次の情報を定義できます。</p><div><ul><li>データ型</li><li>送信側/受信側、クライアント/サーバーのキャリブレーション インターフェイス</li><li>ソフトウェア コンポーネントとそれぞれのポート (上記のインターフェイスにより入力)</li></ul></div><p>このデモには、デモの目的に合わせて 2 セットのソフトウェア コンポーネント インターフェイスの XML ファイルが含まれています。</p><p>2 つのソフトウェア コンポーネントの AUTOSAR ビューを以下に示します。</p><p><img vspace="5" hspace="5" src="../AutosarComposition.jpg" alt=""> </p><h2>AUTOSAR ソフトウェア コンポーネントの記述ファイルに必要な arxml.importer オブジェクトの作成<a name="3"></a></h2><p>各ソフトウェア コンポーネントには、<tt>arxml.importer</tt> オブジェクトが必要です。 <tt>arxml.importer</tt> オブジェクトごとに、対象となるソフトウェア コンポーネントを含んでいるファイルを指定する必要があります。</p><pre class="codeinput">preprocessingFileName = fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'rtw'</span>, <span class="keyword">...</span>
    <span class="string">'rtwdemos'</span>,<span class="string">'rtwdemo_autosar_preprocessing.arxml'</span>);
controlSystemFileName = fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'rtw'</span>, <span class="keyword">...</span>
    <span class="string">'rtwdemos'</span>,<span class="string">'rtwdemo_autosar_control_system_component.arxml'</span>);

preprocessingImporter = arxml.importer( preprocessingFileName );
controlSystemImporter = arxml.importer( controlSystemFileName );
</pre><p>ここで、ソフトウェア コンポーネントの記述を完成させる情報 (データ型やインターフェイスなど) を含んでいる追加のファイルを指定します。</p><pre class="codeinput">controlSystemFileNameDep1 = fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'rtw'</span>, <span class="keyword">...</span>
    <span class="string">'rtwdemos'</span>,<span class="string">'rtwdemo_autosar_control_system_datatype.arxml'</span>);
controlSystemFileNameDep2 = fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'rtw'</span>, <span class="keyword">...</span>
    <span class="string">'rtwdemos'</span>,<span class="string">'rtwdemo_autosar_control_system_interface.arxml'</span>);
controlSystemImporter.setDependencies( { controlSystemFileNameDep1, <span class="keyword">...</span>
    controlSystemFileNameDep2 } );
</pre><h2>Simulink モデル スケルトンの作成<a name="5"></a></h2><p>これで、2 つのインポート オブジェクトを使用して、スケルトン Simulink モデルおよび関連するデータ型を作成できます。 スケルトン ファイルを作成したら、前処理するスケルトン モデルに、AUTOSAR ポート &quot;in&quot;の 2 つのデータ要素に対応する 2 つの入力があることを確認できます。 これらの入力には、データ要素を定義するための C 構造体データ型に対応するバス オブジェクトが関連付けられています。 障害入力は、一次と二次の 2 つの boolean 型要素を含んでいるバス オブジェクトから構成されます。 値入力は、一次と二次の 2 つの double 型要素を含んでいるバス オブジェクトから構成されます。</p><pre class="codeinput"><span class="comment">% Create the Simulink model skeletons</span>
preprocessingImporter.createComponentAsModel( <span class="string">'/ComponentType/preprocessing'</span> );
controlSystemImporter.createComponentAsModel( <span class="string">'/ComponentType/controlSystem'</span> );

<span class="comment">% View all the imported AUTOSAR data types that you have imported</span>
who
</pre><pre class="codeoutput">
Your variables are:

Boolean                    UInt8                      
Boolean_pair               ans                        
Double                     controlSystemFileName      
Double_pair                controlSystemFileNameDep1  
Float                      controlSystemFileNameDep2  
SInt16                     controlSystemImporter      
SInt32                     preprocessingFileName      
SInt8                      preprocessingImporter      
UInt16                     
UInt32                     

</pre><img vspace="5" hspace="5" src="../rtwdemo_autosar_roundtrip_script_01.png" alt=""> <img vspace="5" hspace="5" src="../rtwdemo_autosar_roundtrip_script_02.png" alt=""> <h2>Simulink モデル スケルトン内での機能の実装<a name="6"></a></h2><p>一般に、制御エンジニアはこの時点で 2 つの Simulink モデルに実装を入力します。このデモでは、完成したモデルを開くことができます。</p><pre class="codeinput"><span class="comment">% open the completed models</span>
open_system( fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'rtw'</span>, <span class="keyword">...</span>
    <span class="string">'rtwdemos'</span>,<span class="string">'rtwdemo_autosar_preprocessing'</span> ) );
open_system( fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'rtw'</span>, <span class="keyword">...</span>
    <span class="string">'rtwdemos'</span>,<span class="string">'rtwdemo_autosar_control_system'</span> ) );
</pre><img vspace="5" hspace="5" src="../rtwdemo_autosar_roundtrip_script_03.png" alt=""> <img vspace="5" hspace="5" src="../rtwdemo_autosar_roundtrip_script_04.png" alt=""> <h2>適用できるテスト ハーネスの作成<a name="7"></a></h2><p>コントローラー機能にテスト ハーネスを作成することをお勧めします。 次のコマンドを使用してモデルを開いたら、[<b></b>実行] ボタンをクリックし、スコープを表示します。</p><pre class="codeinput">testHarnessFileName = fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'rtw'</span>, <span class="keyword">...</span>
    <span class="string">'rtwdemos'</span>,<span class="string">'rtwdemo_autosar_testharness'</span>);
open_system( testHarnessFileName );
sim( testHarnessFileName );
</pre><img vspace="5" hspace="5" src="../rtwdemo_autosar_roundtrip_script_05.png" alt=""> <img vspace="5" hspace="5" src="../rtwdemo_autosar_roundtrip_script_06.png" alt=""> <h2>AUTOSAR ソフトウェア コンポーネントに対するコードのエクスポートと生成<a name="8"></a></h2><p>テスト ハーネスの出力を確認したら、C コードを実装した AUTOSAR ソフトウェア コンポーネント ファイルをエクスポートします。ソフトウェア コンポーネントの XML ファイルがすべてコード生成時にエクスポートされます。</p><pre class="codeinput">rtwbuild( <span class="string">'rtwdemo_autosar_preprocessing'</span> );
rtwbuild( <span class="string">'rtwdemo_autosar_control_system'</span> );
</pre><pre class="codeoutput">### Starting Real-Time Workshop build procedure for model:rtwdemo_autosar_preprocessing
### Generating XML files description for model:rtwdemo_autosar_preprocessing
### Successful completion of Real-Time Workshop code generation for model:rtwdemo_autosar_preprocessing
### Starting Real-Time Workshop build procedure for model:rtwdemo_autosar_control_system
### Generating XML files description for model:rtwdemo_autosar_control_system
### Successful completion of Real-Time Workshop code generation for model:rtwdemo_autosar_control_system
</pre><h2>オーサーリング ツールへのマージ<a name="9"></a></h2><p>これで、生成された AUTOSAR ソフトウェア コンポーネント ファイルを AUTOSAR オーサリング ツールにマージして、さらに改良するか、サインオフすることができます。マージを容易にするには、ソフトウェア コンポーネント情報を別々のファイルに入れます。たとえば、データ型のファイルと内部動作のファイルを作成します。このように分割することにより、実行する必要があるマージの回数が最小限に抑えられます。一般に、データ型ファイルはオーサリング ツールにマージする必要はありません。データ型は通常、設計プロセスの初期段階で定義されるからです。ただし、内部動作ファイルについては、その情報がモデル実装の一部となるので、マージしなければなりません。</p><p><a href="matlab:helpview([docroot,'/toolbox/ecoder/helptargets.map'],'autosar_export_details')">エクスポートされるファイルの詳細</a></p><p>たとえば、生成された AUTOSAR ソフトウェア コンポーネント ファイルを DaVinci System Architect (<a href="matlab:web('http://www.vector-worldwide.com')">Vector Informatik GmbH</a>) にマージするとします。</p><div><ol><li>DaVinci System Architect (2.3 以降) を実行します。</li><li>既存のワークスペースを開くか、新しいワークスペースを作成します。[<tt></tt>ファイル] &gt; [<tt></tt>新規ワークスペース] を選択し、「<tt>Simulink_Demonstration</tt>」のようなワークスペース名を入力します。[<tt></tt>開く]をクリックします。</li><li>[<tt></tt>ファイル] &gt; [<tt></tt>XML ファイルのインポート] &gt; [<tt></tt>追加] を選択します。</li><li>モデル ビルド ディレクトリで生成されたすべての XML ファイルを検索します。</li><li>[<tt></tt>OK] をクリックします。</li><li>さらに表示されたダイアログを受け入れます。</li></ol></div><p>これで、内部動作の詳細な説明を含めて、ソフトウェア コンポーネントが正常にマージされました。結果を確認するには、ソフトウェア コンポーネントの実装タブに移動し、実行可能なエンティティの数を表示します。</p><h2>詳細情報<a name="10"></a></h2><p><a href="matlab:helpview(fullfile(docroot,'toolbox','ecoder','helptargets.map'),'ecoder_autosar')">AUTOSAR ターゲットのドキュメンテーション</a></p><p class="footer">Copyright 1990-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Import and Export an AUTOSAR Software Component % This demonstration shows you how to use an AUTOSAR authoring tool with % Simulink(R) to develop AUTOSAR software components. This demo addresses the % following tasks: % % # Design the software component interfaces in an AUTOSAR authoring tool and import this information into Simulink. % # Export the completed software component from Simulink and merge this information back into an AUTOSAR authoring tool. %  %   Copyright 1990-2009 The MathWorks, Inc. %   $Revision: 1.1.4.2.2.1 $  $Date: 2010/07/29 21:28:58 $   %% Overview of the AUTOSAR Software Component Description Files % You can distribute the artifacts that constitute an AUTOSAR software % component among multiple XML files. You can create the files with an % AUTOSAR authoring tool or Simulink(R). %  %% Design the Software Component Interfaces % You can use an AUTOSAR authoring tool to define the following information for % the software component: % % * Data types % * Sender-receiver, client-server, calibration interfaces % * Software components and their respective ports, which are typed by the above interfaces % % This demonstration includes two sets of software component interface XML files for the purpose of this demonstration. % % An AUTOSAR view of the two software components is shown below: % % <<AutosarComposition.jpg>> % %  %% Create arxml.importer Objects for the AUTOSAR Software Component Description Files % Each software component requires an |arxml.importer| object. For each % |arxml.importer| object, you need to specify the file that contains the software % component of interest.  preprocessingFileName = fullfile(matlabroot,'toolbox','rtw', ...     'rtwdemos','rtwdemo_autosar_preprocessing.arxml'); controlSystemFileName = fullfile(matlabroot,'toolbox','rtw', ...     'rtwdemos','rtwdemo_autosar_control_system_component.arxml');  preprocessingImporter = arxml.importer( preprocessingFileName ); controlSystemImporter = arxml.importer( controlSystemFileName );  %% % Now specify the additional files containing the information that % completes the software component description (e.g., data types,  % interfaces). %  controlSystemFileNameDep1 = fullfile(matlabroot,'toolbox','rtw', ...     'rtwdemos','rtwdemo_autosar_control_system_datatype.arxml'); controlSystemFileNameDep2 = fullfile(matlabroot,'toolbox','rtw', ...     'rtwdemos','rtwdemo_autosar_control_system_interface.arxml'); controlSystemImporter.setDependencies( { controlSystemFileNameDep1, ...     controlSystemFileNameDep2 } );  %% Create the Simulink Model Skeletons % Using the two import objects, you can now create the % skeleton Simulink models and associated data types. After you create % the skeleton files, you can see that the preprocessing skeleton model  % has two inports corresponding to the two data elements of the % AUTOSAR port "in". These inports have bus objects associated with % them that correspond to the C structure data type used to define the data % elements. The fault inport is composed of a bus object that contains two % Boolean elements, primary and secondary. The value inport is composed of % a bus object that contains two elements of type double, primary and % secondary.  % Create the Simulink model skeletons preprocessingImporter.createComponentAsModel( '/ComponentType/preprocessing' ); controlSystemImporter.createComponentAsModel( '/ComponentType/controlSystem' );  % View all the imported AUTOSAR data types that you have imported  who  %% Implement the Functionality Within the Simulink Model Skeletons % Typically, the control engineer would now fill in the implementation for % the two Simulink models. For this demo, you can open completed models:  % open the completed models open_system( fullfile(matlabroot,'toolbox','rtw', ...     'rtwdemos','rtwdemo_autosar_preprocessing' ) ); open_system( fullfile(matlabroot,'toolbox','rtw', ...     'rtwdemos','rtwdemo_autosar_control_system' ) );  %% Create a Suitable Test Harness % It is good practice to construct a test harness for controller functionality. % You should click the *Run* button and view the scope after you open the % model, using the following commands: %  testHarnessFileName = fullfile(matlabroot,'toolbox','rtw', ...     'rtwdemos','rtwdemo_autosar_testharness'); open_system( testHarnessFileName ); sim( testHarnessFileName );  %% Export and Generate Code for the AUTOSAR Software Components % After you verify the output of the test harness, export the AUTOSAR % software component files with the C code implementation. % All the software component XML files are exported during code generation.  rtwbuild( 'rtwdemo_autosar_preprocessing' ); rtwbuild( 'rtwdemo_autosar_control_system' );  %% Merge into the Authoring Tool % You can now merge the generated AUTOSAR software component files into an % AUTOSAR authoring tool for further refinement or sign off. To facilitate % merging, the software component information is in separate files, for example, % one for data types and one for internal behavior. This partitioning minimizes % the number of merges you need to do. In general, the data type file does not % need to be merged into the authoring tool because data types are usually % defined early in the design process.  You must, however, merge the internal % behavior file because this information is part of the model implementation. % % <matlab:helpview([docroot,'/toolbox/ecoder/helptargets.map'],'autosar_export_details') Further details of exported files> %  % For example, to merge the generated AUTOSAR software component files into % DaVinci System Architect (<matlab:web('http://www.vector-worldwide.com') % Vector Informatik GmbH>). % % # Run DaVinci System Architect (2.3 or higher). % # Either open an existing workspace, or create a new one: Select |File| > |New Workspace|, Enter a workspace name such as |Simulink_Demonstration|. Click |Open|. % # Select |File| > |Import XML File| > |Add|. % # Locate all of the generated XML files in the model build directory. % # Click |Okay|. % # Accept any further dialogs. %  % You have now successfully merged the software component, which includes a % complete internal behavior description. You can verify the results by navigating to % the implementation tab of the software component and viewing the number of runnable entities.  %% Further Information % % <matlab:helpview(fullfile(docroot,'toolbox','ecoder','helptargets.map'),'ecoder_autosar') AUTOSAR Target documentation>  displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>