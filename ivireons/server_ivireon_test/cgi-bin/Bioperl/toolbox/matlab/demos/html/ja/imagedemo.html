
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>イメージと行列</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-26"><meta name="DC.source" content="imagedemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit imagedemo">エディターで imagedemo.m を開く</a></div><div class="right"><a href="matlab:echodemo imagedemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>イメージと行列</h1><!--introduction--><p>行列 X に対して、IMAGE(X) は、カラーマップ内のインデックスとして使われる X の要素から選択された色や輝度を使ってグラフィカルなイメージを表示します。このデモは、イメージとして行列を表現することと、一般的に行列として格納されたイメージを表示することの概念を説明します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">シンプルな螺旋状の行列</a></li><li><a href="#2">カラーマップ</a></li><li><a href="#10">SPY の利用</a></li><li><a href="#11">大きなイメージの例</a></li></ul></div><h2>シンプルな螺旋状の行列<a name="1"></a></h2><p>SPIRAL は、行列にシンプルな螺旋状のパターンを格納します。Figure に行列の要素の螺旋状のパターンを表すことができます。行列の要素は、大きさが線形に増加し、中心から遠ざかる螺旋状になります。小さい数 (中心の値) は、黒とダーク グレーに写像され、反対に大きな値 (行列のエッジの周り) は、ライト グレーと白に写像されます。行列の小さい値の黒へ、行列の大きい値の白へ、中間の値をグレーの陰影に割り当てることで、カラーマップを決定します。</p><pre class="codeinput">colormap(gray);
X = spiral(8);
image(X);
</pre><img vspace="5" hspace="5" src="../imagedemo_01.png" alt=""> <h2>カラーマップ<a name="2"></a></h2><p>関数 COLORMAP は、カラー マッピングを変更するために使用されます。マップは前のスクリーンで colormap(gray) に設定されています。ここでカラーマップを色相-彩度-値 (hsv) のカラーマップに変更します。色は赤から始まり、黄、緑、シアン、青、赤紫、そして赤に戻ります。</p><pre class="codeinput">colormap(hsv);
</pre><img vspace="5" hspace="5" src="../imagedemo_02.png" alt=""> <p>別のカラーマップ [hot] です。[hot] のカラーマップは、黒から赤と黄色の陰影を介して白になる範囲です。</p><pre class="codeinput">colormap(hot);
</pre><img vspace="5" hspace="5" src="../imagedemo_03.png" alt=""> <p>関数 COLORMAP で使用される [hsv] と [hot] は、もちろん行列です。(正確に言うと、行列を返す関数名です。) カラーマップ行列は、赤、青、緑のビデオ成分の強度を指定する 3 つの列を持ちます。行数は、特定のイメージに依存します。この例では、X = spiral(8) の要素は 1 から 64 の範囲を持つので、64 の行が使われます。</p><pre class="codeinput">M = hot;
size(M)
</pre><pre class="codeoutput">
ans =

    64     3

</pre><p>X の要素は、カラーマップのインデックスとして使われるため、X は正で、1 と map の長さの間の整数の要素でなければなりません。個々の色がどのように決定するかを確認するためには、X(7,1) のように、X の 1 つの要素を取り出してください。対応するカラーマップ エントリは、M(37,:) です。これは完全な赤の強度と、中間を少し超える緑の強度を持ち、青はありません。左下の隅の近い (7,1) の位置のセルでオレンジの陰影を作り出します。</p><pre class="codeinput">ColorMapIndex = X(7,1)
M(ColorMapIndex,:)
</pre><pre class="codeoutput">
ColorMapIndex =

    37


ans =

    1.0000    0.5417         0

</pre><p>一般的に、以下のステートメント</p><p>image(X), colormap(M);</p><p>は、(i,j) 番目のセルの RGB 強度が 3 要素のベクトル M(X(i,j),:) となるように色付けされたセルの表示を作成します。行列 X は任意のサイズになりますが、その要素は 1 と m の間の正の整数でなければなりません。行列 M はそのとき m 行 3列で、0.0 と 1.0 の間の要素である必要があります。COLORMAP(M) は、PCOLOR(X)、SURF(Z)、MESH(Z) で使用される色も設定しますが、これらのケースのデータ行列 X または Z は、カラーマップのインデックスを与えるためにスケーリングされます。螺旋状の例の全く異なる特性を [flag] カラーマップで示します。[flag] カラーマップは、行列 flag(4) の単に m/4 のコピーで、以下に示すように、相互に積み重ねられます。赤、白、青、黒の色は、X の要素が変化するときに循環的に使用され、イメージ データの細かい部分が視覚的にわかるようになります。この例では、行列内の対角的なパターンを確認することができます。</p><pre class="codeinput">colormap(flag);
flag(4)
</pre><pre class="codeoutput">
ans =

     1     0     0
     1     1     1
     0     0     1
     0     0     0

</pre><img vspace="5" hspace="5" src="../imagedemo_04.png" alt=""> <p>カラーマップは行列であるため、MATLAB&reg; の配列操作を使って、修正、または新たに作成することが可能です。たとえば、hot のカラーマップは、グレーを加えることで和らぐ色にすることができます。</p><pre class="codeinput">S = (hot + gray)/2;
colormap(S)
</pre><img vspace="5" hspace="5" src="../imagedemo_05.png" alt=""> <p>[gray] で和らぐ色になった [hot] のカラーマップは、1 未満のパワーまでカラーマップの要素を高くすることで明るくすることができます。</p><pre class="codeinput">X = spiral(8);
image(X);
gamma = .6;
S = (hot + gray)/2;
S = S.^gamma;
colormap(S)
</pre><img vspace="5" hspace="5" src="../imagedemo_06.png" alt=""> <p>コマンド RGBPLOT は、カラーマップのプロットを作成します。x 軸は、IMAGE(X) 内の X の要素に対応するマップのインデックスで、y 軸は、赤、緑、青の成分の強度です。</p><pre class="codeinput">rgbplot(S)
</pre><img vspace="5" hspace="5" src="../imagedemo_07.png" alt=""> <h2>SPY の利用<a name="10"></a></h2><p>スパース行列表示関数 SPY は、特定のカラーマップ エントリを示す画素の位置を表示するのに役立ちます。次のコード セグメントは、米国東部の New England の標高データを含むファイルを読み込み、カラーマップの 2 番目か 3 番目の要素を使用する要素すべてを表示します。X==1 となる位置は海面に対応するため、海岸線をそのまま表したものを見ていることになります。</p><pre class="codeinput">load <span class="string">cape</span>
spy((X==2) | (X==3))
</pre><img vspace="5" hspace="5" src="../imagedemo_08.png" alt=""> <h2>大きなイメージの例<a name="11"></a></h2><p>8 行 8 列の螺旋状の行列は、例のための小さなものです。大規模な計算からなるより大きな行列や、写真や衛星、スキャナから得られるイメージの方が、より一般的です。demos ディレクトリは、カラーマップを持つさまざまなサンプル イメージを含み、color ディレクトリは、他の実用的なカラーマップを生成する M ファイルを含みます。以下に、これらのイメージとそれらに対応するカラーマップを持つ MAT ファイルのリストを示します。(構造体 imglist から) これらのイメージのいずれかを選択して使用することができ、colorlabels 下にリストされるカラーマップ (イメージと共に読み込まれる既定のカラーマップ [map] を含む) のいずれかを選択できます。これを行うために、次のコードを選択し、実行しなければなりません。さまざまなパラメーターを変更し、変更を確認します。</p><pre class="codeinput">clear <span class="string">X</span> <span class="string">map</span>;
imglist = {<span class="string">'flujet'</span>, <span class="keyword">...</span><span class="comment">Fluid Jet</span>
           <span class="string">'spine'</span>, <span class="keyword">...</span><span class="comment">Bone</span>
           <span class="string">'gatlin'</span>, <span class="keyword">...</span><span class="comment">Gatlinburg</span>
           <span class="string">'durer'</span>, <span class="keyword">...</span><span class="comment">Durer</span>
           <span class="string">'detail'</span>, <span class="keyword">...</span><span class="comment">Durer Detail</span>
           <span class="string">'cape'</span>, <span class="keyword">...</span><span class="comment">Cape Cod</span>
           <span class="string">'clown'</span>, <span class="keyword">...</span><span class="comment">Clown</span>
           <span class="string">'earth'</span>, <span class="keyword">...</span><span class="comment">Earth</span>
           <span class="string">'mandrill'</span>, <span class="keyword">...</span><span class="comment">Mandrill</span>
           <span class="string">'spiral'</span>};

colorlabels = {<span class="string">'default'</span>, <span class="string">'hsv'</span>,<span class="string">'hot'</span>,<span class="string">'pink'</span>,<span class="keyword">...</span>
           <span class="string">'cool'</span>,<span class="string">'bone'</span>,<span class="string">'prism'</span>,<span class="string">'flag'</span>,<span class="keyword">...</span>
           <span class="string">'gray'</span>,<span class="string">'rand'</span>};

load(imglist{4},<span class="string">'X'</span>,<span class="string">'map'</span>);
imagesc(X);
colormap(map);
<span class="comment">%colormap(colorlabels{1});</span>
axis <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="../imagedemo_09.png" alt=""> <p class="footer">Copyright 1984-2008 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Images and Matrices % For any matrix X, IMAGE(X) displays a graphical image with brightness or color % chosen from the elements of X used as indices into a colormap.  This demo % illustrates this idea of representing a matrix as an image and in general % displaying images stored as matrices. % % Copyright 1984-2008 The MathWorks, Inc. % $Revision: 1.1.4.8.2.1 $ $Date: 2010/07/29 21:28:52 $  %% The Simple Spiral Matrix % SPIRAL stores a simple spiral pattern into a matrix.  You can see the spiral % pattern of the matrix elements in the figure.  The elements of the matrix % spiral away from the center, growing in magnitude linearly.  Small numbers % (center values) are mapped to black and dark gray, while the larger values % (around the edge of the matrix) are mapped to light gray and white.  The % assignment of small values of the matrix to black, large values of the % matrix to white and intermediate values to shades of gray determines a % color map.  colormap(gray); X = spiral(8);  image(X);  %% Colormaps % COLORMAP function is used to change the color mapping.  The map had been set % with colormap(gray) in the previous screen.  Here we change the colormap to % hue-saturation-value (hsv) color map.  The colors begin with red, pass through % yellow, green, cyan, blue, magenta, and return to red.  colormap(hsv);  %% % Another color map is 'hot'. The 'hot' colormap ranges from black through % shades of red and yellow to white.  colormap(hot);  %% % The quantities 'hsv' and 'hot' used with the COLORMAP function are, of course, % matrices.  (More precisely, they are the names of functions which return % matrices.)  Color map matrices have three columns which specify intensities of % the red, green and blue video components.  The number of rows depends upon the % particular image.  In this example, the elements of X = spiral(8) range from 1 % to 64, so we are using 64 rows.  M = hot; size(M)  %% % The elements of X are used as indices into the color map and so X must have % positive, integer elements between 1 and the length of the map.  To see how an % individual color is determined, pick one element of X, say X(7,1).  The % corresponding color map entry is M(37,:).  This has full intensity in the red % gun, a little over half intensity in the green gun, and no blue.  It produces % the shade of orange in the cell in the (7,1) position near the lower left % corner.  ColorMapIndex = X(7,1) M(ColorMapIndex,:)  %% % In general, the statements % % image(X), colormap(M); % % produce a display of colored cells where the RGB intensity of the (i,j)-th % cell is the 3-vector M(X(i,j),:).  The matrix X can be of any size, but its % elements must be positive integers between 1 and m.  The matrix M should then % have m rows, 3 columns, and elements between 0.0 and 1.0.  COLORMAP(M) also % sets the colors used by PCOLOR(X), SURF(Z) and MESH(Z), but in these cases the % data matrix, X or Z, is rescaled to provide indices into the color map.  A % completely different feature of our spiral example is revealed by the 'flag' % color map.  The 'flag' colormap is simply m/4 copies of the matrix % flag(4), shown below, stacked on top of each other.  The colors red, white, % blue and black are used cyclically as the elements of X vary and so finer % details of the image data become apparent.  In this example, we can see the % diagonal patterns in the matrix  colormap(flag);   flag(4)  %% % Since color maps are matrices, it is possible to modify them, or create new % ones, with MATLAB(R) array operations.  For example the hot color map can be % softened by adding some gray.  S = (hot + gray)/2; colormap(S)  %% % A 'hot' colormap, softened by 'gray', can be brightened by raising the % elements of the color map to a power less than 1.  X = spiral(8);  image(X); gamma = .6; S = (hot + gray)/2; S = S.^gamma; colormap(S)  %% % The command RGBPLOT, produces a plot of the color map.  The x-axis is the map % index, which corresponds to the elements of X in IMAGE(X), and the y-axis is % the intensity of the red, green and blue components.  rgbplot(S)  %% Using SPY % A sparse matrix display function, SPY, is useful for displaying the location % of image elements which point to a particular color map entry.  The following % code segment loads a file containing altitude data for eastern New England and % displays all the elements which use the second or third element of the color % map.  Locations with X==1 correspond to sea level, so we see a crude % representation of the coast line.  load cape spy((X==2) | (X==3))  %% Examples of Large Images % Our 8-by-8 spiral matrix is only a small, illustrative example.  Larger % matrices resulting from extensive computations, or images obtained from % photographs, satellites, or scanners are more typical.  The demos directory % contains several sample images with their own color maps and the color % directory contains M-files which generate other useful color maps.  Below, you % see a listing of MAT files that have these images and their corresponding % colormaps.  You can choose to use any of these images (from the structure % imglist), and select any of the color maps listed under colorlabels (including % the default colormap 'map' that is loaded with the image).  To do this, you % will have to select the following code and execute it.  Make changes to % different parameters and see the changes.  clear X map; imglist = {'flujet', ... Fluid Jet            'spine', ... Bone            'gatlin', ... Gatlinburg            'durer', ... Durer            'detail', ... Durer Detail            'cape', ... Cape Cod            'clown', ... Clown            'earth', ... Earth            'mandrill', ... Mandrill            'spiral'};   colorlabels = {'default', 'hsv','hot','pink',...                'cool','bone','prism','flag',...                'gray','rand'};   load(imglist{4},'X','map'); imagesc(X); colormap(map);  %colormap(colorlabels{1}); axis off;   displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>