
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Fuzzy C-Means Clustering for Iris Data</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-06-29"><meta name="DC.source" content="irisfcm.m"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit irisfcm">Open irisfcm.m in the Editor</a></div><div class="right"><a href="matlab:echodemo irisfcm">Run in the Command Window</a></div></div><div class="content"><h1>Fuzzy C-Means Clustering for Iris Data</h1><!--introduction--><p>This demo illustrates how to use Fuzzy C-Means clustering for Iris dataset.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Load Data</a></li><li><a href="#2">Plot Data in 2-D</a></li><li><a href="#3">Setup Parameters</a></li><li><a href="#4">Compute Clusters</a></li></ul></div><h2>Load Data<a name="1"></a></h2><p>The dataset is obtained from the data file 'iris.dat'. This dataset was collected by botanist Anderson and contains random samples of flowers belonging to three species of iris flowers  <i>setosa</i> , <i>versicolor</i> , and <i>virginica</i>. For each of the species, 50 observations for sepal length, sepal width, petal length, and petal width are recorded.</p><p>The dataset is partitioned into three groups named <i>setosa</i> , <i>versicolor</i> , and <i>virginica</i>. This is shown in the following code snippet.</p><pre class="codeinput">load <span class="string">iris.dat</span>
setosa = iris((iris(:,5)==1),:);        <span class="comment">% data for setosa</span>
versicolor = iris((iris(:,5)==2),:);    <span class="comment">% data for versicolor</span>
virginica = iris((iris(:,5)==3),:);     <span class="comment">% data for virginica</span>
obsv_n = size(iris, 1);                 <span class="comment">% total number of observations</span>
</pre><h2>Plot Data in 2-D<a name="2"></a></h2><p>The data to be clustered is 4-dimensional data and represents sepal length, sepal width, petal length, and petal width. From each of the three groups(setosa, versicolor and virginica), two characteristics (for example, sepal length vs. sepal width) of the flowers are plotted in a 2-dimensional plot. This is done using the following code snippet.</p><pre class="codeinput">Characteristics = {<span class="string">'sepal length'</span>,<span class="string">'sepal width'</span>,<span class="string">'petal length'</span>,<span class="string">'petal width'</span>};
pairs = [1 2; 1 3; 1 4; 2 3; 2 4; 3 4];
h = figure;
<span class="keyword">for</span> j = 1:6,
    x = pairs(j, 1);
    y = pairs(j, 2);
    subplot(2,3,j);
    plot([setosa(:,x) versicolor(:,x) virginica(:,x)],<span class="keyword">...</span>
         [setosa(:,y) versicolor(:,y) virginica(:,y)], <span class="string">'.'</span>);
    xlabel(Characteristics{x});
    ylabel(Characteristics{y});
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="irisfcm_01.png" alt=""> <h2>Setup Parameters<a name="3"></a></h2><p>Next, the parameters required for Fuzzy C-Means clustering such as number of clusters, exponent for the partition matrix, maximum number of iterations and minimum improvement are defined and set. This are shown in the following code snippet.</p><pre class="codeinput">cluster_n = 3;                          <span class="comment">% Number of clusters</span>
expo = 2.0;                             <span class="comment">% Exponent for U</span>
max_iter = 100;                         <span class="comment">% Max. iteration</span>
min_impro = 1e-6;                       <span class="comment">% Min. improvement</span>
</pre><h2>Compute Clusters<a name="4"></a></h2><p>Fuzzy C-Means clustering is an iterative process. First, the initial fuzzy partition matrix is generated and the initial fuzzy cluster centers are calculated. In each step of the iteration, the cluster centers and the membership grade point are updated and the objective function is minimized to find the best location for the clusters. The process stops when the maximum number of iterations is reached, or when the objective function improvement between two consecutive iterations is less than the minimum amount of improvement specified. This is shown in the following code snippet.</p><pre class="codeinput"><span class="comment">% initialize fuzzy partition</span>
U = initfcm(cluster_n, obsv_n);
<span class="comment">% plot the data if the figure window is closed</span>
<span class="keyword">if</span> ishghandle(h)
    figure(h);
<span class="keyword">else</span>
    <span class="keyword">for</span> j = 1:6,
        x = pairs(j, 1);
        y = pairs(j, 2);
        subplot(2,3,j);
        plot([setosa(:,x) versicolor(:,x) virginica(:,x)],<span class="keyword">...</span>
             [setosa(:,y) versicolor(:,y) virginica(:,y)], <span class="string">'.'</span>);
        xlabel(Characteristics{x});
        ylabel(Characteristics{y});
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">% iteration</span>
<span class="keyword">for</span> i = 1:max_iter,
    [U, center, obj] = stepfcm(iris, U, cluster_n, expo);
    fprintf(<span class="string">'Iteration count = %d, obj. fcn = %f\n'</span>, i, obj);
    <span class="comment">% refresh centers</span>
    <span class="keyword">if</span> i&gt;1 &amp;&amp; (abs(obj - lastobj) &lt; min_impro)
        <span class="keyword">for</span> j = 1:6,
            subplot(2,3,j);
            <span class="keyword">for</span> k = 1:cluster_n,
                text(center(k, pairs(j,1)), center(k,pairs(j,2)), int2str(k), <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">break</span>;
    <span class="keyword">elseif</span> i==1
        <span class="keyword">for</span> j = 1:6,
            subplot(2,3,j);
            <span class="keyword">for</span> k = 1:cluster_n,
                text(center(k, pairs(j,1)), center(k,pairs(j,2)), int2str(k), <span class="string">'color'</span>, [0.5 0.5 0.5]);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    lastobj = obj;
<span class="keyword">end</span>
</pre><pre class="codeoutput">Iteration count = 1, obj. fcn = 28971.732229
Iteration count = 2, obj. fcn = 21428.913712
Iteration count = 3, obj. fcn = 15907.394597
Iteration count = 4, obj. fcn = 9263.010879
Iteration count = 5, obj. fcn = 7062.630646
Iteration count = 6, obj. fcn = 6475.211882
Iteration count = 7, obj. fcn = 6249.471562
Iteration count = 8, obj. fcn = 6146.023339
Iteration count = 9, obj. fcn = 6097.858175
Iteration count = 10, obj. fcn = 6075.873149
Iteration count = 11, obj. fcn = 6066.095010
Iteration count = 12, obj. fcn = 6061.840414
Iteration count = 13, obj. fcn = 6060.018628
Iteration count = 14, obj. fcn = 6059.247071
Iteration count = 15, obj. fcn = 6058.922679
Iteration count = 16, obj. fcn = 6058.786940
Iteration count = 17, obj. fcn = 6058.730317
Iteration count = 18, obj. fcn = 6058.706745
Iteration count = 19, obj. fcn = 6058.696944
Iteration count = 20, obj. fcn = 6058.692872
Iteration count = 21, obj. fcn = 6058.691181
Iteration count = 22, obj. fcn = 6058.690480
Iteration count = 23, obj. fcn = 6058.690189
Iteration count = 24, obj. fcn = 6058.690068
Iteration count = 25, obj. fcn = 6058.690018
Iteration count = 26, obj. fcn = 6058.689997
Iteration count = 27, obj. fcn = 6058.689988
Iteration count = 28, obj. fcn = 6058.689985
Iteration count = 29, obj. fcn = 6058.689983
Iteration count = 30, obj. fcn = 6058.689983
</pre><img vspace="5" hspace="5" src="irisfcm_02.png" alt=""> <p>The figure shows the initial and final fuzzy cluster centers. The bold numbers represent the final fuzzy cluster centers obtained by updating them iteratively.</p><p class="footer">Copyright 1994-2006 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Fuzzy C-Means Clustering for Iris Data
% This demo illustrates how to use Fuzzy C-Means clustering for
% Iris dataset.
%
% Copyright 1994-2006 The MathWorks, Inc. 
% $Revision: 1.7.2.4 $  $Date: 2008/10/31 06:10:05 $

%% Load Data
% The dataset is obtained from the data file 'iris.dat'. This dataset was
% collected by botanist Anderson and contains random samples of flowers belonging to three species of iris flowers  _setosa_ , _versicolor_ , and _virginica_. 
% For each of the species, 50 observations for sepal length, sepal width, petal length, and petal width are recorded. 
%
% The dataset is partitioned into three groups named _setosa_ , _versicolor_ , and _virginica_. This is shown in the
% following code snippet.
load iris.dat               
setosa = iris((iris(:,5)==1),:);        % data for setosa
versicolor = iris((iris(:,5)==2),:);    % data for versicolor
virginica = iris((iris(:,5)==3),:);     % data for virginica
obsv_n = size(iris, 1);                 % total number of observations

%% Plot Data in 2-D
% The data to be clustered is 4-dimensional data and represents sepal
% length, sepal width, petal length, and petal width. From each of the
% three groups(setosa, versicolor and virginica), two characteristics (for
% example, sepal length vs. sepal width) of the 
% flowers are plotted in a 2-dimensional plot. This is done using the
% following code snippet.
Characteristics = {'sepal length','sepal width','petal length','petal width'};
pairs = [1 2; 1 3; 1 4; 2 3; 2 4; 3 4];
h = figure;
for j = 1:6,
    x = pairs(j, 1); 
    y = pairs(j, 2);   
    subplot(2,3,j);
    plot([setosa(:,x) versicolor(:,x) virginica(:,x)],...
         [setosa(:,y) versicolor(:,y) virginica(:,y)], '.');
    xlabel(Characteristics{x}); 
    ylabel(Characteristics{y});
end

%% Setup Parameters
% Next, the parameters required for Fuzzy C-Means clustering such as number of clusters, exponent for the partition matrix,
% maximum number of iterations and minimum improvement
% are defined and set. This are shown in the
% following code snippet.

cluster_n = 3;                          % Number of clusters
expo = 2.0;                             % Exponent for U
max_iter = 100;                         % Max. iteration
min_impro = 1e-6;                       % Min. improvement

%% Compute Clusters
% Fuzzy C-Means clustering is an iterative process. First, the initial fuzzy partition matrix is generated and the initial
% fuzzy cluster centers are calculated. In each step of the
% iteration, the cluster centers and the membership grade 
% point are updated and the objective function is minimized to find the best location for the clusters.
% The process stops when the maximum number of iterations
% is reached, or when the objective function improvement between two
% consecutive iterations is less than the minimum amount of improvement
% specified. This is shown in the following code snippet.

% initialize fuzzy partition   
U = initfcm(cluster_n, obsv_n);     
% plot the data if the figure window is closed
if ishghandle(h)
    figure(h);
else
    for j = 1:6,
        x = pairs(j, 1); 
        y = pairs(j, 2);   
        subplot(2,3,j);
        plot([setosa(:,x) versicolor(:,x) virginica(:,x)],...
             [setosa(:,y) versicolor(:,y) virginica(:,y)], '.');
        xlabel(Characteristics{x}); 
        ylabel(Characteristics{y});
    end
end    
% iteration
for i = 1:max_iter,
    [U, center, obj] = stepfcm(iris, U, cluster_n, expo);
    fprintf('Iteration count = %d, obj. fcn = %f\n', i, obj);
    % refresh centers
    if i>1 && (abs(obj - lastobj) < min_impro)
        for j = 1:6,
            subplot(2,3,j);
            for k = 1:cluster_n,
                text(center(k, pairs(j,1)), center(k,pairs(j,2)), int2str(k), 'FontWeight', 'bold');
            end
        end
        break; 
    elseif i==1
        for j = 1:6,
            subplot(2,3,j);
            for k = 1:cluster_n,
                text(center(k, pairs(j,1)), center(k,pairs(j,2)), int2str(k), 'color', [0.5 0.5 0.5]);
            end
        end
    end
    lastobj = obj;
end
%%
% The figure shows the initial and final fuzzy cluster centers. The bold
% numbers represent the final fuzzy cluster centers obtained by updating
% them iteratively.


%%
displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
--></body></html>