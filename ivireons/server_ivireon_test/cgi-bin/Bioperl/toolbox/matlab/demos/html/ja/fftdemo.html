
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>スペクトル解析のための FFT</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-26"><meta name="DC.source" content="fftdemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit fftdemo">エディターで fftdemo.m を開く</a></div><div class="right"><a href="matlab:echodemo fftdemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>スペクトル解析のための FFT</h1><!--introduction--><p>この例では、スペクトル解析に対する関数 FFT の使用を示します。FFT の一般的な利用法は、時間領域のノイズの含まれる信号内に埋もれた信号の周波数成分を見つけることです。</p><!--/introduction--><p>最初にいくつかのデータを作成します。1000 Hz でサンプルされたデータとします。データに対して、t=0 から t=0.25 までの 1 ミリ秒間隔の時間軸を作成します。次に、50 Hz と 120 Hz の正弦波を含む信号 x を作成します。</p><pre class="codeinput">t = 0:.001:.25;
x = sin(2*pi*50*t) + sin(2*pi*120*t);
</pre><p>ノイズを含む信号 y を生成するために、標準偏差が 2 のいくつかのランダム ノイズを追加します。このノイズを含む信号 y をプロットして確認します。</p><pre class="codeinput">y = x + 2*randn(size(t));
plot(y(1:50))
title(<span class="string">'Noisy time domain signal'</span>)
</pre><img vspace="5" hspace="5" src="../fftdemo_01.png" alt=""> <p>この信号を見て周波数成分を識別することが難しいのは明らかです。そのために、スペクトル解析がよく使われます。</p><p>ノイズを含む信号 y の離散フーリエ変換を求めることは簡単です。高速フーリエ変換 (FFT) を行うだけです。</p><pre class="codeinput">Y = fft(y,251);
</pre><p>複素共役 (CONJ) を使用して、パワー スペクトル密度、つまり、さまざまな周波数でのエネルギーの測定値を計算します。最初の 127 点に対する周波数軸を作成し、結果のプロットに使用します。(点の残りは対称です。)</p><pre class="codeinput">Pyy = Y.*conj(Y)/251;
f = 1000/251*(0:127);
plot(f,Pyy(1:128))
title(<span class="string">'Power spectral density'</span>)
xlabel(<span class="string">'Frequency (Hz)'</span>)
</pre><img vspace="5" hspace="5" src="../fftdemo_02.png" alt=""> <p>200 Hz までの範囲に拡大してプロットします。50 Hz と 120 Hz にピークがあります。これらがオリジナルの信号の周波数です。</p><pre class="codeinput">plot(f(1:50),Pyy(1:50))
title(<span class="string">'Power spectral density'</span>)
xlabel(<span class="string">'Frequency (Hz)'</span>)
</pre><img vspace="5" hspace="5" src="../fftdemo_03.png" alt=""> <p class="footer">Copyright 1984-2005 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% FFT for Spectral Analysis % This example shows the use of the FFT function for spectral  analysis.  A % common use of FFT's is to find the frequency components of a signal buried in % a noisy time domain signal. % % Copyright 1984-2005 The MathWorks, Inc.  % $Revision: 1.1.6.11.2.1 $  $Date: 2010/07/29 21:28:52 $  %% % First create some data.  Consider data sampled at 1000 Hz.  Start by forming a % time axis for our data, running from t=0 until t=.25 in steps of 1 % millisecond.  Then form a signal, x, containing sine waves at 50 Hz and 120 % Hz.  t = 0:.001:.25; x = sin(2*pi*50*t) + sin(2*pi*120*t);  %% % Add some random noise with a standard deviation of 2 to  produce a noisy % signal y.  Take a look at this noisy  signal y by plotting it.  y = x + 2*randn(size(t)); plot(y(1:50)) title('Noisy time domain signal')  %% % Clearly, it is difficult to identify the frequency components from looking at % this signal; that's why spectral analysis is so popular. % % Finding the discrete Fourier transform of the noisy signal y is easy; just % take the fast-Fourier transform (FFT).  Y = fft(y,251);  %% % Compute the power spectral density, a measurement of the energy at various % frequencies, using the complex conjugate (CONJ).  Form a  frequency axis for % the first 127 points and use it to plot the result.  (The remainder of the % points are symmetric.)  Pyy = Y.*conj(Y)/251; f = 1000/251*(0:127); plot(f,Pyy(1:128)) title('Power spectral density') xlabel('Frequency (Hz)')  %% % Zoom in and plot only up to 200 Hz.  Notice the peaks at 50 Hz and  120 Hz. % These are the frequencies of the original signal.  plot(f(1:50),Pyy(1:50)) title('Power spectral density') xlabel('Frequency (Hz)')   displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>