
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Yaw Damper Design for a 747&reg; Jet Aircraft</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-06-29"><meta name="DC.source" content="jetdemo.m"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit jetdemo">Open jetdemo.m in the Editor</a></div><div class="right"><a href="matlab:echodemo jetdemo">Run in the Command Window</a></div></div><div class="content"><h1>Yaw Damper Design for a 747&reg; Jet Aircraft</h1><!--introduction--><p>This demo steps through the design of a YAW DAMPER for a 747&reg; aircraft using the classical control design features in Control System Toolbox&#8482;.</p><!--/introduction--><p><img vspace="5" hspace="5" src="../Figures/jetdemofigures_01.png" alt=""> </p><p>A simplified trim model of the aircraft during cruise flight</p><p><img src="jetdemo_eq77170.png" alt="$$ \frac{dx}{dt} = Ax + Bu $$"></p><p><img src="jetdemo_eq02268.png" alt="$$ y = Cx + Du $$"></p><p>has four states:</p><pre>   beta (sideslip angle), phi (bank angle), yaw rate, roll rate</pre><p>and two inputs:     the rudder and aileron deflections.</p><p>All angles and angular velocities are in radians and radians/sec.</p><p>Given the matrices A,B,C,D of the trim model, use the SS command to create the state-space model in MATLAB&reg;:</p><pre class="codeinput">A=[-.0558 -.9968 .0802 .0415;
     .598 -.115 -.0318 0;
    -3.05 .388 -.4650 0;
        0 0.0805 1 0];

B=[ .00729  0;
   -0.475   0.00775;
    0.153   0.143;
     0      0];

C=[0 1 0 0;
   0 0 0 1];

D=[0 0;
   0 0];

sys = ss(A,B,C,D);
</pre><p>and label the inputs, outputs, and states:</p><pre class="codeinput">set(sys, <span class="string">'inputname'</span>, {<span class="string">'rudder'</span> <span class="string">'aileron'</span>},<span class="keyword">...</span>
         <span class="string">'outputname'</span>, {<span class="string">'yaw rate'</span> <span class="string">'bank angle'</span>},<span class="keyword">...</span>
         <span class="string">'statename'</span>, {<span class="string">'beta'</span> <span class="string">'yaw'</span> <span class="string">'roll'</span> <span class="string">'phi'</span>});
</pre><p>This model has a pair of lightly damped poles.  They correspond to what is called the Dutch roll mode.  To see these modes, type</p><pre class="codeinput">axis(gca,<span class="string">'normal'</span>)
h = pzplot(sys);
setoptions(h,<span class="string">'FreqUnits'</span>,<span class="string">'rad/sec'</span>,<span class="string">'Grid'</span>,<span class="string">'off'</span>);
</pre><img vspace="5" hspace="5" src="jetdemo_01.png" alt=""> <p>Right-click and select "Grid" to plot the damping and natural frequency values.  You need to design a compensator that increases the damping of these two poles.</p><p>Start with some open loop analysis to determine possible control' strategies.  The presence of lightly damped modes is confirmed by ' looking at the impulse response:'</p><pre class="codeinput">impulseplot(sys)
</pre><img vspace="5" hspace="5" src="jetdemo_02.png" alt=""> <p>To inspect the response over a smaller time frame of 20 seconds, you could also type</p><pre class="codeinput">impulseplot(sys,20)
</pre><img vspace="5" hspace="5" src="jetdemo_03.png" alt=""> <p>Look at the plot from aileron to bank angle phi.  To show only this plot, right-click and choose "I/O Selector", then click on the (2,2) entry.</p><p>This plot shows the aircraft oscillating around a non-zero bank angle. Thus the aircraft turns in response to an aileron impulse.  This behavior will be important later.</p><p>Typically yaw dampers are designed using yaw rate as the sensed output and rudder as the input.  Inspect the frequency response for this I/O pair:</p><pre class="codeinput">sys11 = sys(<span class="string">'yaw'</span>,<span class="string">'rudder'</span>);    <span class="comment">% select I/O pair</span>
h = bodeplot(sys11);
setoptions(h, <span class="string">'FreqUnits'</span>,<span class="string">'rad/sec'</span>,<span class="string">'MagUnits'</span>,<span class="string">'dB'</span>,<span class="string">'PhaseUnits'</span>,<span class="string">'deg'</span>);
</pre><img vspace="5" hspace="5" src="jetdemo_04.png" alt=""> <p>This plot shows that the rudder has a lot of authority around the lightly damped Dutch roll mode (1 rad/sec).</p><p>A reasonable design objective is to provide a damping ratio zeta &gt; 0.35, with natural frequency Wn &lt; 1.0 rad/sec.  The simplest compensator is a gain.  Use the root locus technique to select an adequate feedback gain value:</p><pre class="codeinput">h = rlocusplot(sys11);
setoptions(h,<span class="string">'FreqUnits'</span>,<span class="string">'rad/sec'</span>)
</pre><img vspace="5" hspace="5" src="jetdemo_05.png" alt=""> <p>Oops, looks like we need positive feedback!</p><pre class="codeinput">h = rlocusplot(-sys11);
setoptions(h,<span class="string">'FreqUnits'</span>,<span class="string">'rad/sec'</span>)
</pre><img vspace="5" hspace="5" src="jetdemo_06.png" alt=""> <p>This looks better.  Click on the blue curve and move the black square to track the gain and damping values.  The best achievable closed-loop damping is about 0.45 for a gain of K=2.85.</p><p>Now close this SISO feedback loop and look at the impulse response</p><pre class="codeinput">k = 2.85;
cl11 = feedback(sys11,-k);
</pre><p>Note: feedback assumes negative feedback by default</p><pre class="codeinput">impulseplot(sys11,<span class="string">'b--'</span>,cl11,<span class="string">'r'</span>)
legend(<span class="string">'open loop'</span>,<span class="string">'closed loop'</span>,4)
</pre><img vspace="5" hspace="5" src="jetdemo_07.png" alt=""> <p>The response looks pretty good.</p><p>Now close the loop around the full MIMO model and see how the response from the aileron looks.  The feedback loop involves input 1 and output 1 of the plant:</p><pre class="codeinput">cloop = feedback(sys,-k,1,1);
impulseplot(sys,<span class="string">'b--'</span>,cloop,<span class="string">'r'</span>,20)           <span class="comment">% MIMO impulse response</span>
</pre><img vspace="5" hspace="5" src="jetdemo_08.png" alt=""> <p>The yaw rate response is now well damped.</p><p>When moving the aileron, however, the system no longer continues to bank like a normal aircraft, as seen from</p><pre class="codeinput">impulseplot(cloop(<span class="string">'bank angle'</span>,<span class="string">'aileron'</span>),<span class="string">'r'</span>,18)
</pre><img vspace="5" hspace="5" src="jetdemo_09.png" alt=""> <p>You have over-stabilized the spiral mode.  The spiral mode is typically a very slow mode that allows the aircraft to bank and turn without constant aileron input.  Pilots are used to this behavior and will not like a design that does not fly normally.</p><p>You need to make sure that the spiral mode doesn't move farther into the left-half plane when we close the loop.  One way flight control designers have fixed this problem is by using a washout filter.</p><p>Washout Filter:</p><p><img src="jetdemo_eq21356.png" alt="$$ H(s) = \frac{ks}{s+a} $$"></p><p>Using the SISO Design Tool (help sisotool), you can graphically tune the parameters k and a to find the best combination.  In this demo we choose a = 0.2 or a time constant of 5 seconds.</p><p>Form the washout filter for a=0.2 and k=1</p><pre class="codeinput">H = zpk(0,-0.2,1);
</pre><p>connect the washout in series with your design model, and use the root locus to determine the filter gain k:</p><pre class="codeinput">oloop = H * (-sys11);          <span class="comment">% open loop'</span>
h = rlocusplot(oloop);
setoptions(h, <span class="string">'FreqUnits'</span>,<span class="string">'rad/sec'</span>)
sgrid
</pre><img vspace="5" hspace="5" src="jetdemo_10.png" alt=""> <p>The best damping is now about zeta = 0.305 for k=2.34.  Close the loop with the MIMO model and check the impulse response:</p><pre class="codeinput">k = 2.34;
wof = -k * H;            <span class="comment">% washout compensator</span>
cloop = feedback(sys,wof,1,1);
impulseplot(sys,<span class="string">'b--'</span>,cloop,<span class="string">'r'</span>,20)
</pre><img vspace="5" hspace="5" src="jetdemo_11.png" alt=""> <p>The washout filter has also restored the normal bank-and-turn behavior as seen by looking at the impulse response from aileron to bank angle.</p><pre class="codeinput">impulseplot(sys(2,2),<span class="string">'b--'</span>,cloop(2,2),<span class="string">'r'</span>,20)
legend(<span class="string">'open loop'</span>,<span class="string">'closed loop'</span>,4)
</pre><img vspace="5" hspace="5" src="jetdemo_12.png" alt=""> <p>Although it doesn't quite meet the requirements, this design substantially increases the damping while allowing the pilot to fly the aircraft normally.</p><p class="footer">Copyright 1986-2009 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Yaw Damper Design for a 747(R) Jet Aircraft
% This demo steps through the design of a YAW DAMPER for a 
% 747(R) aircraft using the classical control design features 
% in Control System Toolbox(TM).

%   Copyright 1986-2009 The MathWorks, Inc. 
%   $Revision: 1.23.4.6 $  $Date: 2009/08/29 08:21:49 $

%%
% <<../Figures/jetdemofigures_01.png>>

%%
% A simplified trim model of the aircraft during cruise flight 
%
% $$ \frac{dx}{dt} = Ax + Bu $$
%
% $$ y = Cx + Du $$
%
% has four states:
%
%     beta (sideslip angle), phi (bank angle), yaw rate, roll rate
%
% and two inputs: 
%     the rudder and aileron deflections. 
%
% All angles and angular velocities are in radians and radians/sec.

%%
% Given the matrices A,B,C,D of the trim model, use the SS command to
% create the state-space model in MATLAB(R):
%
A=[-.0558 -.9968 .0802 .0415;
     .598 -.115 -.0318 0;
    -3.05 .388 -.4650 0;
        0 0.0805 1 0];

B=[ .00729  0;
   -0.475   0.00775;
    0.153   0.143;
     0      0];

C=[0 1 0 0;
   0 0 0 1];

D=[0 0;
   0 0];

sys = ss(A,B,C,D);

%%
% and label the inputs, outputs, and states:
set(sys, 'inputname', {'rudder' 'aileron'},...
         'outputname', {'yaw rate' 'bank angle'},...
         'statename', {'beta' 'yaw' 'roll' 'phi'});

    
%%
% This model has a pair of lightly damped poles.  They correspond to what
% is called the Dutch roll mode.  To see these modes, type
%
axis(gca,'normal')
h = pzplot(sys);
setoptions(h,'FreqUnits','rad/sec','Grid','off');
%%
% Right-click and select "Grid" to plot the damping and natural frequency
% values.  You need to design a compensator that increases the damping of
% these two poles.

%%
% Start with some open loop analysis to determine possible control'
% strategies.  The presence of lightly damped modes is confirmed by '
% looking at the impulse response:'
%
impulseplot(sys)

%%
% To inspect the response over a smaller time frame of 20 seconds, you
% could also type
%
impulseplot(sys,20)

    
%%
% Look at the plot from aileron to bank angle phi.  To show only this plot,
% right-click and choose "I/O Selector", then click on the (2,2) entry.
%
% This plot shows the aircraft oscillating around a non-zero bank angle.
% Thus the aircraft turns in response to an aileron impulse.  This behavior
% will be important later.

    
%%
% Typically yaw dampers are designed using yaw rate as the sensed output
% and rudder as the input.  Inspect the frequency response for this I/O
% pair:
%
sys11 = sys('yaw','rudder');    % select I/O pair
h = bodeplot(sys11);
setoptions(h, 'FreqUnits','rad/sec','MagUnits','dB','PhaseUnits','deg');


%%
% This plot shows that the rudder has a lot of authority around the lightly
% damped Dutch roll mode (1 rad/sec).
   
%%
% A reasonable design objective is to provide a damping ratio zeta > 0.35,
% with natural frequency Wn < 1.0 rad/sec.  The simplest compensator is a 
% gain.  Use the root locus technique to select an adequate feedback gain 
% value:
%
h = rlocusplot(sys11);
setoptions(h,'FreqUnits','rad/sec')

    
%%
% Oops, looks like we need positive feedback!
%
h = rlocusplot(-sys11);
setoptions(h,'FreqUnits','rad/sec')

%%
% This looks better.  Click on the blue curve and move the black square to
% track the gain and damping values.  The best achievable closed-loop
% damping is about 0.45 for a gain of K=2.85.

%%
% Now close this SISO feedback loop and look at the impulse response
%
k = 2.85;
cl11 = feedback(sys11,-k);

%%
% Note: feedback assumes negative feedback by default

impulseplot(sys11,'bREPLACE_WITH_DASH_DASH',cl11,'r')
legend('open loop','closed loop',4)

%%
% The response looks pretty good.

    
%%
% Now close the loop around the full MIMO model and see how the response
% from the aileron looks.  The feedback loop involves input 1 and output 1
% of the plant:
%
cloop = feedback(sys,-k,1,1);
impulseplot(sys,'bREPLACE_WITH_DASH_DASH',cloop,'r',20)           % MIMO impulse response

%%
% The yaw rate response is now well damped. 

    
%%
% When moving the aileron, however, the system no longer continues to bank
% like a normal aircraft, as seen from
%
impulseplot(cloop('bank angle','aileron'),'r',18)

%%
% You have over-stabilized the spiral mode.  The spiral mode is typically a
% very slow mode that allows the aircraft to bank and turn without constant
% aileron input.  Pilots are used to this behavior and will not like a
% design that does not fly normally.

     
%%
% You need to make sure that the spiral mode doesn't move farther into the
% left-half plane when we close the loop.  One way flight control designers
% have fixed this problem is by using a washout filter.
%
% Washout Filter:
%
% $$ H(s) = \frac{ks}{s+a} $$
%
% Using the SISO Design Tool (help sisotool), you can graphically tune the
% parameters k and a to find the best combination.  In this demo we choose
% a = 0.2 or a time constant of 5 seconds.
  
%%
% Form the washout filter for a=0.2 and k=1
%
H = zpk(0,-0.2,1);

%%
% connect the washout in series with your design model, and use the root
% locus to determine the filter gain k:
 
oloop = H * (-sys11);          % open loop'
h = rlocusplot(oloop);
setoptions(h, 'FreqUnits','rad/sec')
sgrid
 
    
%%
% The best damping is now about zeta = 0.305 for k=2.34.  Close the loop
% with the MIMO model and check the impulse response:
k = 2.34;
wof = -k * H;            % washout compensator
cloop = feedback(sys,wof,1,1);
impulseplot(sys,'bREPLACE_WITH_DASH_DASH',cloop,'r',20)

    
%%
% The washout filter has also restored the normal bank-and-turn behavior
% as seen by looking at the impulse response from aileron to bank angle.

impulseplot(sys(2,2),'bREPLACE_WITH_DASH_DASH',cloop(2,2),'r',20)
legend('open loop','closed loop',4)

%%
% Although it doesn't quite meet the requirements, this design
% substantially increases the damping while allowing the pilot to fly the
% aircraft normally.


displayEndOfDemoMessage(mfilename)
##### SOURCE END #####
--></body></html>