
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Merging Signals</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-07-08"><meta name="DC.source" content="mergedemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">mergedemo.mdl</div><div class="right"><a href="matlab:mergedemo">Open this model</a></div></div><div class="content"><h1>Merging Signals</h1><!--introduction--><p>This interactive demonstration introduces you to the following Simulink&reg; concepts.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Model Description</a></li><li><a href="#24">Conditionally Executed Subsystems</a></li><li><a href="#31">Logical Operator Block</a></li><li><a href="#37">Boolean Signals in Simulink&reg;</a></li><li><a href="#41">The Merge Block and Alternately Enabling Subsystems</a></li><li><a href="#48">Interesting Feature: Programmatically Changing a Block's Background Color</a></li></ul></div><h2>Model Description<a name="1"></a></h2><img vspace="5" hspace="5" src="mergedemo_01.png" alt=""> <p>The left side of this model contains two blocks, for example the Repeating Sequence block, from the Simulink Sources library.  Each block generates a scalar output signal of the form displayed on the block's icon.</p><img vspace="5" hspace="5" src="mergedemo_02.png" alt=""> <p>These two signals are fed into different Enabled Subsystems, which are outlined with thick lines.</p><img vspace="5" hspace="5" src="mergedemo_03.png" alt=""> <p>The enabled (or conditionally executed) subsystems are controlled by the signal generated by a Discrete Pulse Generator block.</p><img vspace="5" hspace="5" src="mergedemo_04.png" alt=""> <p>This block's output toggles between the values of zero and one every five seconds. When the output of the Discrete Pulse Generator block is positive, the top enabled subsystem is simulating. When the output of the Discrete Pulse Generator block is zero, the bottom enabled subsystem is simulating.</p><p>To force the bottom enabled subsystem to simulate when the Discrete Pulse Generator block's output is zero, the output is passed through a Logical Operator block set to the NOT operator. The NOT block outputs a value of one when its input is zero.</p><img vspace="5" hspace="5" src="mergedemo_05.png" alt=""> <p>The outputs of the two enabled subsystems are fed into a Merge block.</p><img vspace="5" hspace="5" src="mergedemo_06.png" alt=""> <p>The output of the Merge block is, finally, displayed on a Simulink Scope.</p><img vspace="5" hspace="5" src="mergedemo_07.png" alt=""> <p>You can run the simulation to see the output of the Merge block on the Scope. Notice that the type of waveform shown on the Scope changes every five seconds. This is due to the behavior of the Merge block.</p><img vspace="5" hspace="5" src="mergedemo_08.png" alt=""> <h2>Conditionally Executed Subsystems<a name="24"></a></h2><p>The Merge block demonstration contains two conditionally executed subsystems.</p><img vspace="5" hspace="5" src="mergedemo_09.png" alt=""> <p>A conditionally executed subsystem is a subsystem that is only executed at particular times during the simulation, i.e., when certain conditions are met. In this case, the subsystems are enabled subsystems, distinguished by their icons and the additional input port on the top or bottom of the block, as shown below.</p><img vspace="5" hspace="5" src="mergedemo_10.png" alt=""> <p>The signal feeding into the additional port is called the control signal. The value of this signal provides the condition that determines whether the subsystem is executed, or not, at any given time step. Enabled subsystems are executed when the control signal is strictly positive.</p><p>In this demonstration, you want to execute one of the enabled subsystems when the control signal is positive, and the other when the control signal is zero. You can do this by using the Logical Operator block in Simulink.</p><h2>Logical Operator Block<a name="31"></a></h2><p>The Logical Operator block in Simulink gives you a method for incorporating logical operators and boolean signals into your Simulink diagram.</p><img vspace="5" hspace="5" src="mergedemo_11.png" alt=""> <p>You can open the Logical Operator block to see the different operators that are listed in the drop down menu. The current setting of NOT returns 1 (or TRUE) when the input signal is non-zero, or 0 (FALSE) when the input signal is strictly zero.</p><p>In this example, you can use this feature to generate a positive value when the control signal goes to zero by maintaining the current operator setting of NOT and closing the dialog.</p><p><b>Note:</b> You can display the data type of each signal by checking the <b>Port Data Types</b> command in the Simulink diagram's <b>Format &gt; Port/Signal Displays</b> menu.</p><img vspace="5" hspace="5" src="mergedemo_12.png" alt=""> <h2>Boolean Signals in Simulink&reg;<a name="37"></a></h2><p>You have the option to have Simulink to use boolean or double values for the inputs and outputs of the Logical Operator block, using the following steps.</p><p>1. Open the Configuration Parameters dialog box by choosing the <b>Configuration parameters</b> command from the <b>Simulation</b> menu.</p><p>2. Go to the Optimization page in the Configuration Parameters dialog.</p><p>3. See that the <b>Implement logic signals as boolean data (vs. double)</b> parameter has been enabled. This optimization tells Simulink whether or not it should allow a signal whose data type is double to be passed into and out of blocks that support the boolean data type.</p><p>4. Click the <b>OK</b> button on the <b>Configuration Parameters dialog</b>.</p><p>By having the Data Type Conversion block after the Discrete Pulse Generator block, you avoid an error indicating that the Logical Operator block expects a boolean input signal.</p><img vspace="5" hspace="5" src="mergedemo_13.png" alt=""> <h2>The Merge Block and Alternately Enabling Subsystems<a name="41"></a></h2><p>You can use the Merge block to create a single signal whose value is equal to the output of whichever enabled subsystem is currently executing. The following steps.</p><img vspace="5" hspace="5" src="mergedemo_14.png" alt=""> <p>1. Open the Merge block's Block Parameter dialog by double clicking on the block.</p><p>2. Specify the <b>Number of inputs</b> as the number of enabled subsystems whose outputs you want to merge. In this case you want to set the *Number of inputs *to be 2.</p><p>3. Leave the <b>Initial output field</b> empty to specify that the Merge block sets its initial output to the initial value of one of its input signals. In this case, the output will be the initial value of the subsystem that is enabled when the simulation starts.</p><p>4. Close the Merge block's Block Parameter dialog.</p><p>5. Connect the output of the two conditionally executed subsystems to the inputs of the Merge block.</p><img vspace="5" hspace="5" src="mergedemo_15.png" alt=""> <p>As before, when you run the simulation, the output of the Merge block is the value of whatever conditionally executed subsystem is executing at any point in time.</p><img vspace="5" hspace="5" src="mergedemo_16.png" alt=""> <h2>Interesting Feature: Programmatically Changing a Block's Background Color<a name="48"></a></h2><p>When you ran the simulation, you should have noticed that the color of the currently executing conditionally executing subsystems changed. This does <b>not</b> happen automatically for all conditionally executing subsystems. It was achieved using an S-function and MATLAB&reg; code!</p><p>If you open one of the enabled subsystems by double clicking on the block in the Simulink diagram, you'll see it contains the following.</p><p>1. An Enable block, which is what makes this a conditionally executed subsystem and adds the input port for the control signal</p><img vspace="5" hspace="5" src="mergedemo_17.png" alt=""> <p>2. A Level-2 MATLAB-file S-function block, which runs the MATLAB file S-function <a href="matlab:edit('mergefcn.m')">mergefcn.m</a></p><img vspace="5" hspace="5" src="mergedemo_18.png" alt=""> <p>At each time step, the S-function's mdlUpdate subfunction executes. It sets the BackgroundColor property of the Subsystems based on whether it is currently executing, or not, with the following command.</p><p><a href="matlab:open_system('mergedemo');set_param('mergedemo/Subsystem','BackgroundColor','green')">set_param('mergedemo/Subsystem','BackgroundColor','green')</a></p><p>For more information on how to write MATLAB file S-functions, see the documentation.</p><p class="footer">Copyright 2005-2010 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Merging Signals
% 
% This interactive demonstration introduces you to the following Simulink(R)
% concepts.
%

% Copyright 2005-2010 The MathWorks, Inc.

%% Model Description
% 
open_system('mergedemo');

%%
close_system('mergedemo',0); 

%%
% The left side of this model contains two blocks, for example the
% Repeating Sequence block, from the Simulink Sources library.  Each block 
% generates a scalar output signal of the form displayed on the block's
% icon. 

%%
open_system('mergedemo')
hilite_system(['mergedemo/Repeating',char(10),'Sequence'],'find')

%%
close_system('mergedemo',0);

%%
% These two signals are fed into different Enabled Subsystems,
% which are outlined with thick lines. 

%%
open_system('mergedemo')
hilite_system('mergedemo/Subsystem','find')
hilite_system('mergedemo/Subsystem1','find')

%%
close_system('mergedemo',0);

%%
% The enabled (or conditionally executed) subsystems are controlled by the
% signal generated by a Discrete Pulse Generator block.  

%%
open_system('mergedemo')
hilite_system(['mergedemo/Discrete',char(32),'Pulse',char(10),'Generator'],'find')

%%
close_system('mergedemo',0);

%%
% This block's output toggles between the values of zero
% and one every five seconds. When the output of the Discrete Pulse
% Generator block is positive, the top enabled subsystem is simulating.
% When the output of the Discrete Pulse Generator block is zero, the bottom
% enabled subsystem is simulating. 

%%
% To force the bottom enabled subsystem to
% simulate when the Discrete Pulse Generator block's output is zero, the
% output is passed through a Logical Operator block set to the NOT
% operator. The NOT block outputs a value of one when its input is zero.

%%
open_system('mergedemo')
hilite_system(['mergedemo/Logical',char(10),'Operator'],'find')

%%
close_system('mergedemo',0);

%%
% The outputs of the two enabled subsystems are fed into a Merge block. 

%%
open_system('mergedemo')
hilite_system('mergedemo/Merge','find')

%%
close_system('mergedemo',0);

%%
% The output of the Merge block is, finally, displayed on a Simulink Scope.

%%
open_system('mergedemo')
hilite_system('mergedemo/Scope','find')

%%
% You can run the simulation to see the output of the Merge block on the
% Scope. Notice that the type of waveform shown on the Scope changes every
% five seconds. This is due to the behavior of the Merge block. 

%%
open_system('mergedemo/Scope')
sim('mergedemo')

%%
close_system('mergedemo',0);

%% Conditionally Executed Subsystems
%
% The Merge block demonstration contains two conditionally executed subsystems.

%%
open_system('mergedemo')
hilite_system('mergedemo/Subsystem','find')
hilite_system('mergedemo/Subsystem1','find')

%%
close_system('mergedemo',0);

%%
% A conditionally executed subsystem is a subsystem that is
% only executed at particular times during the simulation, i.e., when
% certain conditions are met. In this case, the subsystems are enabled
% subsystems, distinguished by their icons and the additional input port on
% the top or bottom of the block, as shown below.

%%
open_system('enabledsubsystem');

%%
close_system('enabledsubsystem');

%% 
% The signal feeding into the additional port is called the control signal.
% The value of this signal provides the condition that determines whether
% the subsystem is executed, or not, at any given time step. Enabled
% subsystems are executed when the control signal is strictly positive.
%
% In this demonstration, you want to execute one of the enabled subsystems
% when the control signal is positive, and the other when the control
% signal is zero. You can do this by using the Logical Operator block in
% Simulink.

%% Logical Operator Block
%
% The Logical Operator block in Simulink gives you a method for
% incorporating logical operators and boolean signals into your Simulink
% diagram. 

%%
open_system('mergedemo')
hilite_system(['mergedemo/Logical',char(10),'Operator'],'find')

%%
close_system('mergedemo',0);

%%
% You can open the Logical Operator block to see the different
% operators that are listed in the drop down menu. The current setting of
% NOT returns 1 (or TRUE) when the input signal is non-zero, or 0 (FALSE)
% when the input signal is strictly zero.
%
% In this example, you can use this feature to generate a positive value
% when the control signal goes to zero by maintaining the current operator
% setting of NOT and closing the dialog. 
%
% *Note:* You can display the data type of each signal by checking the
% *Port Data Types* command in the Simulink diagram's *Format > Port/Signal
% Displays* menu. 

%%
open_system('mergedemo')
set_param('mergedemo','ShowPortDataTypes','on')
set_param('mergedemo','SimulationCommand','update');
        
%%
close_system('mergedemo',0);

%% Boolean Signals in Simulink(R)
%
% You have the option to have Simulink to use boolean or double values for
% the inputs and outputs of the Logical Operator block, using the following
% steps.
%
% 1. Open the Configuration Parameters dialog box by choosing the
% *Configuration parameters* command from the *Simulation* menu. 
%
%
% 2. Go to the Optimization page in the Configuration Parameters dialog.
%
% 3. See that the *Implement logic signals as boolean data (vs.
% double)* parameter has been enabled. This optimization tells Simulink
% whether or not it should allow a signal whose data type is double to be
% passed into and out of blocks that support the boolean data type.
%
% 4. Click the *OK* button on the *Configuration Parameters dialog*.
%

%%
% By having the Data Type Conversion block after the Discrete Pulse
% Generator block, you avoid an error indicating that the Logical Operator
% block expects a boolean input signal. 

%%
open_system('mergedemo')
hilite_system('mergedemo/Data Type Conversion','find')

%%
close_system('mergedemo',0); 

%% The Merge Block and Alternately Enabling Subsystems
%
% You can use the Merge block to create a single signal whose
% value is equal to the output of whichever enabled subsystem is
% currently executing. The following steps.

open_system('mergedemo')
hilite_system('mergedemo/Merge','find')

%%
close_system('mergedemo',0); 

%%
% 1. Open the Merge block's Block Parameter dialog by double clicking on
% the block. 
%
% 2. Specify the *Number of inputs* as the number of enabled subsystems
% whose outputs you want to merge. In this case you want to set the *Number
% of inputs *to be 2.
%
% 3. Leave the *Initial output field* empty to specify that the Merge block
% sets its initial output to the initial value of one of its input signals.
% In this case, the output will be the initial value of the subsystem that
% is enabled when the simulation starts. 
%
% 4. Close the Merge block's Block Parameter dialog. 
%
% 5. Connect the output of the two conditionally executed subsystems
% to the inputs of the Merge block.

%%
open_system('mergedemo')
set_param('mergedemo/Merge','Inputs','2');
set_param('mergedemo/Merge','InitialOutput','[]');
PH=get_param({'mergedemo/Subsystem';'mergedemo/Subsystem1'},'PortHandles');
PH=[PH{:}];
Outs=[PH.Outport];
hilite_system(Outs);

%%
hilite_system(Outs,'none');

%%
% As before, when you run the simulation, the output of the Merge block is
% the value of whatever conditionally executed subsystem is executing at any
% point in time.

%%
open_system('mergedemo/Scope')
sim('mergedemo')

%% Interesting Feature: Programmatically Changing a Block's Background Color
%
% 
% When you ran the simulation, you should have noticed that the
% color of the currently executing conditionally executing
% subsystems changed. This does *not* happen automatically
% for all conditionally executing subsystems. It was achieved using
% an S-function and MATLAB(R) code!
% 
% If you open one of the enabled subsystems by double clicking on the block
% in the Simulink diagram, you'll see it contains the following.

%%
% 1. An Enable block, which is what makes this a conditionally executed
% subsystem and adds the input port for the control signal
open_system('mergedemo');
hilite_system('mergedemo/Subsystem/Enable','find')

%%
close_system('mergedemo/Subsystem',0);

%%
% 2. A Level-2 MATLAB-file S-function block, which runs the MATLAB file S-function
% <matlab:edit('mergefcn.m') mergefcn.m>
open_system('mergedemo/Subsystem');
hilite_system('mergedemo/Subsystem/Enable','none')
hilite_system(['mergedemo/Subsystem/Level-2 MATLAB-file' char(10) 'S-Function'],'find')

%%
% At each time step, the S-function's mdlUpdate subfunction
% executes. It sets the BackgroundColor property of the Subsystems
% based on whether it is currently executing, or not, with the
% following command.

%%
% <matlab:open_system('mergedemo');set_param('mergedemo/Subsystem','BackgroundColor','green') set_param('mergedemo/Subsystem','BackgroundColor','green')>
 
%%
% For more information on how to write MATLAB file S-functions, see
% the documentation.
%

%%
close_system('mergedemo',0); 



##### SOURCE END #####
--></body></html>