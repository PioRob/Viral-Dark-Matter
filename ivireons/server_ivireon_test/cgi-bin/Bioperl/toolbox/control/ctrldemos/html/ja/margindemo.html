
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>ゲインと位相余裕の評価</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="margindemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit margindemo">エディターで margindemo.m を開く</a></div><div class="right"><a href="matlab:echodemo margindemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>ゲインと位相余裕の評価</h1><!--introduction--><p>このデモは、安定余裕の概念とその閉ループの応答特性との関係を説明します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">フィードバック ループの安定性</a></li><li><a href="#6">安定性のレベル</a></li><li><a href="#8">ゲイン余裕と位相余裕</a></li><li><a href="#13">複数のゲインまたは位相クロッシングを持つシステム</a></li><li><a href="#21">対話型 GUI</a></li></ul></div><h2>フィードバック ループの安定性<a name="1"></a></h2><p>通常、安定性は、すべての内部信号が制限内に収まっていることを意味します。これは、制御できなくなったり、機器が損傷を受けることを避けるための、制御システムに対する基準の要件です。線形フィードバック システムでは、安定性は閉ループ伝達関数の極を見ることで評価できます。たとえば、SISO フィードバック ループを見てみます。</p><p><img vspace="5" hspace="5" src="../../Figures/margin_01.png" alt=""> </p><p><b>図 1:</b> SISO フィードバック ループ</p><p>単位ループ ゲイン <tt>k</tt> に対しては、以下を使用して閉ループ伝達関数 <tt>T</tt> を計算できます。</p><pre class="codeinput">G = tf([.5 1.3],[1 1.2  1.6 0]);
T = feedback(G,1);
</pre><p><tt>T</tt> の極を求めるには、次のように入力します。</p><pre class="codeinput">pole(T)
</pre><pre class="codeoutput">
ans =

  -0.2305 + 1.3062i
  -0.2305 - 1.3062i
  -0.7389          

</pre><p><tt>k=1</tt> のフィードバック ループは、すべての極が負の実数部を持っているため、安定しています。</p><h2>安定性のレベル<a name="6"></a></h2><p>閉ループの極を確認すると、安定性を 2 進数で評価できます。業務上は、安定性が堅牢 (または脆弱) であるかがわかると非常に役に立ちます。堅牢性を示すものとして、安定性が失われる前の、ループ ゲインの変化の度合いがあります。根軌跡図を使用すると、ループが安定している <tt>k</tt> 値の範囲を推定できます。</p><pre class="codeinput">rlocus(G)
</pre><img vspace="5" hspace="5" src="../margindemo_01.png" alt=""> <p>軌跡が y 軸と交差する点をクリックすると、このフィードバック ループが以下に対して安定していることが示されます。</p><p><img src="../margindemo_eq23356.png" alt="$$ 0 &lt; k &lt; 2.7 $$"></p><p>この範囲は、<tt>k=1</tt> の場合、安定性が失われる前に、ループ ゲインを 270% 増加できることを示します。</p><h2>ゲイン余裕と位相余裕<a name="8"></a></h2><p>ループ ゲインの変化は堅牢な安定性を示す 1 つの要素にすぎません。一般的に、不完全なプラントのモデル化は、ゲインと位相の両方が正確にわかっていないことを意味します。モデル化誤差はゲインのクロスオーバー周波数 (開ループ ゲインが 0dB の周波数) 付近で最も悪影響を及ぼすため、この周波数でどの程度の位相の変化を許容できるかも問題になります。</p><p>位相余裕は、安定性を失うにはゲインのクロスオーバー周波数でどの程度の位相の変化が必要であるかを測定します。同様に、ゲイン余裕は、安定性を失うにはゲインのクロスオーバー周波数でどの程度の相対ゲインの変化が必要であるかを測定します。これらの 2 つの数値は共に、閉ループの安定性に対して推定される &quot;安全性の余裕&quot; を示します。安定性の余裕が小さいほど、安定性は低下します。</p><p>ゲイン余裕と位相余裕は、以下のようにボード線図に表示できます。まず、プロットを作成します。</p><pre class="codeinput">bode(G), grid
</pre><img vspace="5" hspace="5" src="../margindemo_02.png" alt=""> <p>次に、プロットを右クリックし、<b>[特性] -&gt; [最小安定余裕]</b> サブメニューを選択します。最後に、青のドット マーカーをクリックします。結果のプロットは以下のようになります。</p><p><img vspace="5" hspace="5" src="../../Figures/margin_03.png" alt=""> </p><p>これは、約 9 dB のゲイン余裕と約 45 度の位相余裕を示しています。対応する閉ループ ステップ応答は、約 20% のオーバーシュートとある程度の振動を示しています。</p><pre class="codeinput">step(T), title(<span class="string">'Closed-loop response for k=1'</span>)
</pre><img vspace="5" hspace="5" src="../margindemo_03.png" alt=""> <p>ゲインを <tt>k=2</tt> に増加すると、安定性余裕は以下まで削減されます。</p><pre class="codeinput">[Gm,Pm] = margin(2*G);
GmdB = 20*log10(Gm)   <span class="comment">% gain margin in dB</span>
Pm  <span class="comment">% phase margin in degrees</span>
</pre><pre class="codeoutput">
GmdB =

    2.7471


Pm =

    8.6328

</pre><p>閉ループ応答には大きく減衰された振動が存在します。これは不安定になりつつあることを示す兆候です。</p><pre class="codeinput">step(feedback(2*G,1)), title(<span class="string">'Closed-loop response for k=2'</span>)
</pre><img vspace="5" hspace="5" src="../margindemo_04.png" alt=""> <h2>複数のゲインまたは位相クロッシングを持つシステム<a name="13"></a></h2><p>システムには、複数のゲイン クロスオーバー周波数または位相クロスオーバー周波数が存在する場合があります。これにより、複数のゲイン余裕値または位相余裕値が生じます。たとえば、次のフィードバック ループを考えます。</p><p><img vspace="5" hspace="5" src="../../Figures/margin_02.png" alt=""> </p><p><b>図 2:</b> 複数の位相クロスオーバーを含むフィードバック ループ</p><p><tt>k=1</tt> に対する閉ループ応答は安定しています。</p><pre class="codeinput">G = tf(20,[1 7]) * tf([1 3.2 7.2],[1 -1.2 0.8]) * tf([1 -8 400],[1 33 700]);
T = feedback(G,1);
step(T), title(<span class="string">'Closed-loop response for k=1'</span>)
</pre><img vspace="5" hspace="5" src="../margindemo_05.png" alt=""> <p>このループの安定性を評価するには、そのボード応答をプロットします。</p><pre class="codeinput">bode(G), grid
</pre><img vspace="5" hspace="5" src="../margindemo_06.png" alt=""> <p>次に、プロットを右クリックし、<b>[特性] -&gt; [すべての安定余裕]</b> サブメニューを選択して、すべてのクロスオーバー周波数および関連する安定余裕を表示します。結果のプロットは、以下のようになります。</p><p><img vspace="5" hspace="5" src="../../Figures/margin_04.png" alt=""> </p><p>2 つの 180 度の位相クロッシングと、それに対応する -9.35dB および +10.6dB のゲイン余裕が存在することに注目してください。負のゲイン余裕はゲインの減少により安定性が失われていることを示し、正のゲイン余裕はゲインの増加により安定性が失われていることを示します。これは、<tt>k=1</tt> に関してプラス/マイナス 6dB のゲインの変化に対して閉ループ ステップ応答をプロットすることで確認できます。</p><pre class="codeinput">k1 = 2;     T1 = feedback(G*k1,1);
k2 = 1/2;   T2 = feedback(G*k2,1);
step(T,<span class="string">'b'</span>,T1,<span class="string">'r'</span>,T2,<span class="string">'g'</span>,12),
legend(<span class="string">'k = 1'</span>,<span class="string">'k = 2'</span>,<span class="string">'k = 0.5'</span>)
</pre><img vspace="5" hspace="5" src="../margindemo_07.png" alt=""> <p>プロットは、小さなゲイン値と大きなゲイン値の両方に対して振動が増加していることを示しています。</p><p>コマンド <tt>allmargin</tt> を使用すると、すべての安定余裕を計算できます。ゲイン余裕は dB ではなくゲイン比で表されることに注意してください。値を dB に変換するには、<tt>mag2db</tt> を使用します。</p><pre class="codeinput">m = allmargin(G)

GainMargins_dB = mag2db(m.GainMargin)
</pre><pre class="codeoutput">
m = 

     GainMargin: [0.3408 3.3920]
    GMFrequency: [1.9421 16.4807]
    PhaseMargin: 68.1178
    PMFrequency: 7.0762
    DelayMargin: 0.1680
    DMFrequency: 7.0762
         Stable: 1


GainMargins_dB =

   -9.3510   10.6091

</pre><h2>対話型 GUI<a name="21"></a></h2><p>安定余裕と閉ループ応答間の関係に関してさらに洞察を深めるには、次のリンクをクリックして、ループ ゲイン <tt>k</tt> を調整し、余裕と閉ループ応答に対する影響を確認するための対話型 GUI を起動してください。</p><p><a href="matlab:margin_gui">ゲインおよび位相余裕 GUI を開く</a></p><pre class="codeinput">margin_gui
</pre><img vspace="5" hspace="5" src="../margindemo_08.png" alt=""> <p class="footer">Copyright 1986-2007 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Assessing Gain and Phase Margins % This demo illustrates the concept of stability margins and  % its connection with closed-loop response characteristics.  %   Copyright 1986-2007 The MathWorks, Inc. %   $Revision: 1.1.4.2.2.1 $  $Date: 2010/07/29 21:28:40 $  %% Stability of a Feedback Loop % Stability generally means that all internal signals remain bounded. This % is a standard requirement for control systems to avoid loss of % control and damage to equipment. For linear feedback systems, % stability can be assessed by looking at the poles of the closed-loop % transfer function. Consider for example the SISO feedback loop: % % <<../Figures/margin_01.png>>  %% % *Figure 1*: SISO Feedback Loop.   %% % For a unit loop gain |k|, you can compute the closed-loop transfer function % |T| using: G = tf([.5 1.3],[1 1.2  1.6 0]); T = feedback(G,1);  %% % To obtain the poles of |T|, type pole(T)  %% % The feedback loop for |k=1| is stable since all poles have negative real parts.  %% How Stable is Stable? % Checking the closed-loop poles gives us a binary assessment of stability. % In practice, it is more useful to know how robust (or fragile) stability  % is. One indication of robustness is  how much the loop gain can change % before stability is lost. You can use the root locus plot to estimate the % range of |k| values for which the loop is stable: rlocus(G)  %%  % Clicking on the point where the locus intersects the y axis reveals that % this feedback loop is stable for  % % $$ 0 < k < 2.7 $$ % % This range shows that with |k=1|, the loop gain can increase 270% before  % you lose stability.  %% Gain and Phase Margins % Changes in the loop gain are only one aspect of robust stability. In % general, imperfect plant modeling means that both  gain and  % phase are not known exactly. Because modeling errors are most damaging % near the gain crossover frequency (frequency where open-loop gain is % 0dB), it also matters how much phase variation can be tolerated at % this frequency. % % The phase margin measures how much phase variation is needed at the gain % crossover frequency to lose stability. Similarly, the gain margin % measures what relative gain variation is needed at the gain % crossover frequency to lose stability. Together, these two numbers give an % estimate of the "safety margin" for closed-loop stability. The smaller % the stability margins, the more fragile stability is. % % You can display the gain and phase margins on a Bode plot as follows. % First create the plot: bode(G), grid  %%  % Then, right-click on the plot and select the *Characteristics -> Minimum Stability % Margins* submenu. Finally, click on the blue dot markers.  % The resulting plot is shown below: %  % <<../Figures/margin_03.png>>  %% % This indicates a gain margin of about 9 dB and a phase % margin of about 45 degrees. The corresponding closed-loop step response % exhibits about 20% overshoot and some oscillations. step(T), title('Closed-loop response for k=1')  %% % If we increase the gain to |k=2|, the stability margins are reduced to [Gm,Pm] = margin(2*G); GmdB = 20*log10(Gm)   % gain margin in dB Pm  % phase margin in degrees  %% % and the closed-loop response has poorly damped oscillations, a sign of % near instability. step(feedback(2*G,1)), title('Closed-loop response for k=2')  %% Systems with Multiple Gain or Phase Crossings % Some systems have multiple gain crossover or phase % crossover frequencies, which leads to multiple gain or phase margin values. For % example, consider the feedback loop %  % <<../Figures/margin_02.png>>  %% % *Figure 2*: Feedback Loop with Multiple Phase Crossovers  %% % The closed-loop response for |k=1| is stable: G = tf(20,[1 7]) * tf([1 3.2 7.2],[1 -1.2 0.8]) * tf([1 -8 400],[1 33 700]); T = feedback(G,1); step(T), title('Closed-loop response for k=1')  %%  % To assess how robustly stable this loop is, plot its Bode response: bode(G), grid  %% % Then, right-click on the plot and select the *Characteristics -> All Stability Margins* % submenu to show all the crossover frequencies and associated stability % margins. The resulting plot is shown below. % % <<../Figures/margin_04.png>>  %% % Note that there are two 180 deg phase crossings with corresponding gain  % margins of -9.35dB and +10.6dB. Negative gain margins % indicate that stability is lost by decreasing the gain, while positive % gain margins indicate that stability is lost by increasing the gain. % This is confirmed by plotting the closed-loop step response for a  % plus/minus 6dB gain variation about |k=1|: k1 = 2;     T1 = feedback(G*k1,1); k2 = 1/2;   T2 = feedback(G*k2,1); step(T,'b',T1,'r',T2,'g',12),  legend('k = 1','k = 2','k = 0.5')  %%  % The plot shows increased oscillations for both smaller and larger % gain values.  %% % You can use the command |allmargin| to compute all stability margins. Note % that gain margins are expressed as gain ratios, not dB. Use |mag2db| to % convert the values to dB. m = allmargin(G)  GainMargins_dB = mag2db(m.GainMargin)  %% Interactive GUI % To gain additional insight into the connection between stability margins % and closed-loop responses, click on the link below to launch an interactive  % GUI for tuning the loop gain |k| and seeing the effect on margins and % closed-loop responses. % % <matlab:margin_gui Open the Gain and Phase Margin GUI> margin_gui   displayEndOfDemoMessage(mfilename)   ##### SOURCE END ##### --></body></html>