
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>遅延を持つモデルの線形化</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="scddelaypad.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit scddelaypad">エディターで scddelaypad.m を開く</a></div><div class="right"><a href="matlab:echodemo scddelaypad">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>遅延を持つモデルの線形化</h1><!--introduction--><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">連続遅延を持つモデルの線形化</a></li><li><a href="#16">離散遅延を持つモデルの線形化</a></li><li><a href="#24">遅延を持つ線形化モデルの操作</a></li></ul></div><h2>連続遅延を持つモデルの線形化<a name="1"></a></h2><p>次のいずれかのオプションを使用して、Transport Delay、Variable Transport Delay、Variable Time Delay などの連続時間遅延ブロックを持つ Simulink&reg; モデルを線形化できます。</p><div><ul><li>遅延のパデ近似を使用し、線形化を介して有理線形システムを取得する</li><li>遅延が正確に表現されている線形化を計算する。このオプションは、正確なシミュレーションや線形化モデルからの周波数応答が必要な場合とパデ近似の精度を評価する場合に使用します。</li></ul></div><p>既定の設定では、Simulink&reg; Control Design™ は、Simulink モデルで遅延ブロックのパデ近似を使用します。</p><p>このデモで使用されるエンジン スピード モデルを開くには、次のように入力します。</p><pre class="codeinput">model = <span class="string">'scdspeed'</span>;
open_system(model);
</pre><img vspace="5" hspace="5" src="../scddelaypad_01.png" alt=""> <p>エンジン スピード モデルには、サブシステム Induction to Power Stroke Delay の dM/dt という Variable Transport Delay ブロックが含まれています。便宜上、次のように入力して、ブロックのパスを MATLAB&reg; 変数に保存できます。</p><pre class="codeinput">DelayBlock = <span class="string">'scdspeed/Induction to  Power Stroke Delay/dM//dt delay'</span>;
</pre><p>1 次近似を使用して線形化を計算するには、次のいずれかの手法を使用して、パデ近似の次数を 1 に設定します。</p><div><ul><li>Variable Transport Delay ブロック ダイアログ ボックスで、<b></b>[パデ次数 (線形化用)] フィールドに 1 を入力する</li><li>コマンド ラインで、次のコマンドを入力する</li></ul></div><pre class="codeinput">set_param(DelayBlock,<span class="string">'PadeOrder'</span>,<span class="string">'1'</span>);
</pre><p>次のように入力し、スロットル角の線形化 I/O を入力として、エンジン スピードを出力として指定します。</p><pre class="codeinput">io(1) = linio(<span class="string">'scdspeed/throttle (degrees)'</span>,1,<span class="string">'in'</span>);
io(2) = linio(<span class="string">'scdspeed/rad//s to rpm'</span>,1,<span class="string">'out'</span>);
</pre><p>次の線形化コマンドを使用して、線形化を計算します。</p><pre class="codeinput">sys_1st_order_approx = linearize(model,io);
</pre><p>パデ近似を 2 に設定することで、2 次近似を使用して線形化を計算できます。</p><pre class="codeinput">set_param(DelayBlock,<span class="string">'PadeOrder'</span>,<span class="string">'2'</span>);
sys_2nd_order_approx = linearize(model,io);
</pre><p>正確な遅延表現を持つ線形モデルを計算するには、linoptions オブジェクトの 'UseExactDelayModel' プロパティを次のように設定します。</p><pre class="codeinput">opt = linoptions;
opt.UseExactDelayModel = <span class="string">'on'</span>;
</pre><p>次の線形化コマンドを使用して、モデルを線形化します。</p><pre class="codeinput">sys_exact = linearize(model,io,opt);
</pre><p>次のように入力して、パデ近似モデルのボード応答と正確な線形化モデルを比較します。</p><pre class="codeinput">p = bodeoptions(<span class="string">'cstprefs'</span>);
p.Grid = <span class="string">'on'</span>;
p.PhaseMatching = <span class="string">'on'</span>;
p.XLimMode = {<span class="string">'Manual'</span>};
p.XLim = {[0.1 1000]};
f = figure;
bode(sys_1st_order_approx,sys_2nd_order_approx,sys_exact,p);
h = legend(<span class="string">'sys_1st_order_approx'</span>,<span class="string">'sys_2nd_order_approx'</span>,<span class="string">'sys_exact'</span>,<span class="keyword">...</span>
            <span class="string">'Location'</span>,<span class="string">'SouthWest'</span>);
set(h,<span class="string">'Interpreter'</span>,<span class="string">'none'</span>)
</pre><img vspace="5" hspace="5" src="../scddelaypad_02.png" alt=""> <p>1 次近似の場合、位相は約 50 rad/s で拡散し始め、約 100 rad/s で拡散します。</p><p>Simulink モデルを閉じます。</p><pre class="codeinput">bdclose(model)
</pre><h2>離散遅延を持つモデルの線形化<a name="16"></a></h2><p>Unit Delay ブロックや Integer Delay ブロックなどの離散遅延ブロックを持つモデルを線形化する場合は、正確な遅延オプションを使用し、状態をモデルのダイナミクスに追加しないで遅延を考慮します。これらの遅延を明示的に考慮すると、モデル内の状態が少ないため、多数の離散遅延を持つシステムのシミュレーション性能が向上します。</p><p>このデモに使用される 20 の遅延状態を持つ Integer Delay ブロックを使用して、離散システムの Simulink モデルを開くには、次のように入力します。</p><pre class="codeinput">model = <span class="string">'scdintegerdelay'</span>;
open_system(model);
</pre><img vspace="5" hspace="5" src="../scddelaypad_03.png" alt=""> <p>既定の設定では、線形化には、線形モデルに畳み込まれたすべての状態が含まれています。線形化 I/O を設定して、モデルを線形化するには、次のようにします。</p><pre class="codeinput">io(1) = linio(<span class="string">'scdintegerdelay/Step'</span>,1,<span class="string">'in'</span>);
io(2) = linio(<span class="string">'scdintegerdelay/Discrete Filter'</span>,1,<span class="string">'out'</span>);
sys_default = linearize(model,io);
</pre><p>結果のモデルを統合し、モデルに 21 の状態 (1 - 離散フィルター、20 - 整数遅延) があることを確認します。</p><pre class="codeinput">size(sys_default)
</pre><pre class="codeoutput">State-space model with 1 outputs, 1 inputs, and 21 states.
</pre><p>'UseExactDelayModel' プロパティを使用して、この同じモデルを線形化するには、次のようにします。</p><pre class="codeinput">opt = linoptions;
opt.UseExactDelayModel = <span class="string">'on'</span>;
sys_exact = linearize(model,io,opt);
</pre><p>新しい結果のモデルを調べると、1 つの状態があり、遅延が線形化モデルで内部的に考慮されていることがわかります。</p><pre class="codeinput">size(sys_exact)
</pre><pre class="codeoutput">State-space model with 1 outputs, 1 inputs, and 1 states.
</pre><p>両方の線形化モデルのステップ応答シミュレーションを実行し、次のように入力してそれらが同一であることを確認します。</p><pre class="codeinput">step(sys_default,sys_exact);
h = legend(<span class="string">'sys_default'</span>,<span class="string">'sys_exact'</span>,<span class="keyword">...</span>
            <span class="string">'Location'</span>,<span class="string">'SouthEast'</span>);
set(h,<span class="string">'Interpreter'</span>,<span class="string">'none'</span>)
</pre><img vspace="5" hspace="5" src="../scddelaypad_04.png" alt=""> <p>Simulink モデルを閉じて、図をクリーンアップします。</p><pre class="codeinput">bdclose(model)
close(f)
</pre><h2>遅延を持つ線形化モデルの操作<a name="24"></a></h2><p>遅延を持つ線形化モデルの操作の詳細は、Control System Toolbox™ のドキュメンテーションと<a href="../../../control/ctrldemos/html/GSSpecifyingDelays.html">時間遅れの指定</a>および<a href="../../../control/ctrldemos/html/MADelayResponse.html">遅延を持つ制御システムの解析</a>のデモを参照してください。</p><p class="footer">Copyright 2007 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Linearization of Models with Delays % % Copyright 2007 The MathWorks, Inc. % $Revision: 1.1.4.2.2.1 $ $Date: 2010/07/29 21:29:23 $ %  %% Linearization of Models with Continuous Delays % You can linearize a Simulink(R) model with continuous time delays blocks such as the % Transport Delay, Variable Transport Delay, and Variable Time Delay using one % of the following options: %% % * Use a Pade approximations of the delays to get a rational linear system % through linearizations. % * Compute a linearization where the delay is exactly represented. Use % this option when you need accurate simulation and frequency responses % from a linearized model and when assessing the accuracy of Pade % approximation.  %% % By default, Simulink(R) Control Design(TM) uses Pade % approximations of the delay blocks in a Simulink model.    %% % To open the engine speed model used in this demonstration, type model = 'scdspeed'; open_system(model);  %% % The engine speed model contains a Variable Transport Delay block named % dM/dt in the subsystem Induction to Power Stroke Delay. % For convienince you can store the path to the block in a MATLAB(R) variable by % typing DelayBlock = 'scdspeed/Induction to  Power Stroke Delay/dM//dt delay';  %% % To compute a linearization using a first order approximation, use one of % the following techniques to set the order of the Pade approximation to 1: %% % * In the Variable Transport Delay block dialog box, enter 1 in the *Pade % Order (for linearization)* field. % * At the command line, enter the following command: set_param(DelayBlock,'PadeOrder','1');  %% % Next, specify the linearization I/O to throttle angle as the input and  % engine speed as the output by typing io(1) = linio('scdspeed/throttle (degrees)',1,'in'); io(2) = linio('scdspeed/rad//s to rpm',1,'out');  %% % Compute the linearization using the following linearize command: sys_1st_order_approx = linearize(model,io);  %%  % You can compute a linearization using a second order approximation by setting the % Pade order to 2: set_param(DelayBlock,'PadeOrder','2'); sys_2nd_order_approx = linearize(model,io);  %%  % To compute a linear model with the exact delay representation, set the % 'UseExactDelayModel' property in the linoptions object to on: opt = linoptions; opt.UseExactDelayModel = 'on';  %%  % Linearize the model using the following linearize command: sys_exact = linearize(model,io,opt);  %% % Compare the Bode response of the Pade approximation model and the exact % linearization model by typing p = bodeoptions('cstprefs'); p.Grid = 'on'; p.PhaseMatching = 'on'; p.XLimMode = {'Manual'}; p.XLim = {[0.1 1000]}; f = figure; bode(sys_1st_order_approx,sys_2nd_order_approx,sys_exact,p); h = legend('sys_1st_order_approx','sys_2nd_order_approx','sys_exact',...             'Location','SouthWest'); set(h,'Interpreter','none')  %% % In the case of a first order approximation, the phase begins to diverge % around 50 rad/s and diverges around 100 rad/s.  %% % Close the Simulink model. bdclose(model)  %% Linearization of Models with Discrete Delays % When linearizing a model with discrete delay blocks, such as Unit and Integer Delay % blocks use the exact delay option to account for the delays without adding % states to the model dynamics.  Explicitly accounting for these delays % improves your simulation performance for systems with many discrete % delays because your fewer states in your model.  %% % To open the Simulink model of a discrete system with an Integer Delay % block with 20 delay state used for this demonstration, type model = 'scdintegerdelay'; open_system(model);  %% % By default the linearization includes all of the states folded into % the linear model.  Set the linearization I/Os and linearize the model as % follows: io(1) = linio('scdintegerdelay/Step',1,'in'); io(2) = linio('scdintegerdelay/Discrete Filter',1,'out'); sys_default = linearize(model,io); %% % Integrate the resulting model to see that it has 21 states (1 - Discrete % Filter, 20 - Integer Delay). size(sys_default)  %%  % You can linearize this same model using the 'UseExactDelayModel' property % as follows: opt = linoptions; opt.UseExactDelayModel = 'on'; sys_exact = linearize(model,io,opt);  %% % Interrogating the new resulting model shows that it has 1 state and the % delays are accounted for interally in the linearized model.  size(sys_exact)  %% % Run a step response simulation of both linearized model to see that they % are identical by typing step(sys_default,sys_exact); h = legend('sys_default','sys_exact',...             'Location','SouthEast'); set(h,'Interpreter','none')  %% % Close the Simulink model and clean up figures. bdclose(model) close(f)  %% Working with Linearized Models with Delays % For more information on manipulating linearized models with delays, see % the Control System Toolbox(TM) documentation along with the demos  % <../../../control/ctrldemos/html/GSSpecifyingDelays.html "Specifying Time % Delays"> and  % <../../../control/ctrldemos/html/MADelayResponse.html "Analyzing Control Systems with Delays"> .   displayEndOfDemoMessage(mfilename) ##### SOURCE END ##### --></body></html>