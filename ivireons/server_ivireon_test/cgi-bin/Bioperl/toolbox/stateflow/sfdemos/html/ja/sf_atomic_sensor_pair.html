
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>Atomic サブチャートを使用した冗長なセンサー ペアのモデル作成</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="sf_atomic_sensor_pair.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">sf_atomic_sensor_pair.mdl</div><div class="right"><a href="matlab:sf_atomic_sensor_pair">このモデルを開く</a></div></div><div class="content"><h1>Atomic サブチャートを使用した冗長なセンサーの組み合わせのモデル作成</h1><!--introduction--><p>このモデルでは、Atomic サブチャートと呼ばれる新しい Stateflow&reg; 機能を使用して、単純な冗長なセンサーの組み合わせのモデルを作成する方法を示します。この機能を使用すると、別のライブラリ ファイルにある他のチャートから大きなチャートを作成できます。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#2">メイン チャート</a></li><li><a href="#4">ライブラリ チャート</a></li><li><a href="#5">入力値、出力値、およびパラメーターのマッピング</a></li><li><a href="#6">シミュレーション動作</a></li></ul></div><img vspace="5" hspace="5" src="../sf_atomic_sensor_pair_01.png" alt=""> <h2>メイン チャート<a name="2"></a></h2><p>Stateflow のメイン チャートである <tt>RedundantSensors</tt> は、<tt>Sensor1</tt> と <tt>Sensor2</tt> という 2 つの「リンクされた Atomic サブチャート」で構成されています。</p><img vspace="5" hspace="5" src="../sf_atomic_sensor_pair_02.png" alt=""> <p>既定の設定では、<tt>Sensor1</tt> がアクティブです。ここで入力 <tt>u1</tt> が読み込まれ、出力 <tt>y</tt> が設定されます。Sensor1 が失敗すると、<tt>Sensor2</tt> に切り替わり、ここで入力 <tt>u2</tt> が読み込まれ、出力 <tt>y</tt> が設定されます。両方とも失敗すると、<tt>Alarm</tt> ステートになり、出力は公称ゼロになります。</p><p><tt>Sensor1</tt> と <tt>Sensor2</tt> は「リンクされた Atomic サブチャート」です。これは見た目も動作も通常の Stateflow の状態と同じですが、リンクされた Atomic サブチャートの内容は別のライブラリ モデル内のチャートにある点が異なります。この例では、リンクされた Atomic サブチャートは両方とも <tt>sf_atomic_sensor_lib/SingleSensor</tt> ライブラリ チャートに対応しています。</p><h2>ライブラリ チャート<a name="4"></a></h2><p><tt>SingleSensor</tt> チャートは、センサー入力 <tt>u</tt> を受け入れ、フィルター処理されたセンサー出力 <tt>y</tt> を生成する単一のセンサーのモデルを作成します。これには範囲外エラーを検出するロジックが組み込まれています。既定の設定では、センサーは &quot;OK&quot; 状態にあると想定されます。センサー読み取り値が範囲外になり (これは &quot;OK&quot; から &quot;FailOnce&quot; への遷移によってモデル作成)、そのまま 0.5秒間経過した場合、&quot;Fail&quot; に遷移します。この場合、センサーは定数 0 を出力します。これにより、センサーは障害のモデルを作成しますが、センサー読み取り値の一時的なスパイクを無視することができます。</p><p>次の点に注意してください。</p><div><ul><li>&quot;OK&quot; から &quot;FailOnce&quot; への遷移は、Stateflow チャート パラメーター &quot;LOW&quot; および &quot;HIGH&quot; に基づいて行われます。</li><li>センサーが失敗したかどうかをコンテナー チャートに通知するために使用される &quot;inFailed&quot; という最上位の関数があります。</li></ul></div><img vspace="5" hspace="5" src="../sf_atomic_sensor_pair_03.png" alt=""> <img vspace="5" hspace="5" src="../sf_atomic_sensor_pair_04.png" alt=""> <h2>入力値、出力値、およびパラメーターのマッピング<a name="5"></a></h2><p>メイン チャート <tt>RedundantSensors</tt> には <tt>u1</tt> と <tt>u2</tt> の 2 つの入力がありますが、リンクされた Atomic サブチャートに対応するライブラリ チャートには <tt>u</tt> という入力が 1 つあるだけです。この場合、リンクされたサブチャート <tt>Sensor1</tt> がチャート入力 <tt>u1</tt> にアクセスし、リンクされたサブチャート <tt>Sensor2</tt> がチャート入力 <tt>u2</tt> にアクセスするようにする必要があります。そのためには、リンクされた Atomic サブチャートの各インスタンスに対するマッピングを指定する必要があります。たとえば、<tt>Sensor1</tt> を右クリックしてコンテキスト メニューの <tt>[Edit Subchart Mappings]</tt> を選択すると、次のようなダイアログが表示されます。</p><p><img vspace="5" hspace="5" src="../sf_atomic_sensor_pair_binding_sensor1.png" alt=""> </p><p>このダイアログでは、メイン チャートのシンボル (入力、出力、パラメーター) をライブラリ チャートのシンボルにマッピングできます。入力 &quot;u&quot; がメイン チャートの入力 &quot;u1&quot; にマップされているのがわかります。同様に、ライブラリ チャートで定義されているパラメーターには、サブチャートのさまざまなインスタンスの間で異なる値を与えることができます。</p><p>この場合、<tt>Sensor1</tt> と <tt>Sensor2</tt> のマッピングは次のようになっています。</p><p>
<table border="1">
  <tr>
    <td></td>
<td><tt>Sensor1</tt></td>
<td><tt>Sensor2</tt></td>
  </tr>
  <tr>
<td>u</td>
<td>u1</td>
<td>u2</td>
  </tr>
  <tr>
<td>HIGH</td>
    <td>75</td>
    <td>100</td>
  </tr>
  <tr>
<td>LOW</td>
    <td>-75</td>
    <td>-100</td>
  </tr>
</table>
</p><h2>シミュレーション動作<a name="6"></a></h2><p>このモデルのシミュレーションを実行すると、次のような動作を見ることができます。</p><div><ul><li>最初のメイン チャートへの入力は両方ともゼロです。したがって、出力はゼロになります。</li><li>最初の入力 u1 が -75 ～ 75 の間で変動すると、出力は u1 に追従します。</li><li>u1 がこの範囲外に出るとすぐに、y は u2 に追従し始めます。</li><li>u2 が -100 ～ 100 の範囲外に出ると、y は公称ゼロを出力するようになります。</li></ul></div><p>このモデルを<a href="matlab:open_system('sf_atomic_sensor_pair')">開いて</a>シミュレーションを開始すると、この動作を見ることができます。チャートへの入力を変更するには、Gain ブロックをダブルクリックして、そのスライダーをドラッグします。</p><p class="footer">Copyright 2007-2010 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Modeling a Redundant Sensor Pair Using Atomic Subcharts %  % This model demonstrates how to model a simple redundant sensor pair using % a new Stateflow(R) feature called Atomic Subcharts. This feature allows % you to compose a large chart from other charts which reside in a % different library file.  %% %   %   Copyright 2007-2010 The MathWorks, Inc.  mdl = 'sf_atomic_sensor_pair'; open_system(mdl); r = sfroot; m = r.find('-isa', 'Stateflow.Machine', 'Name', mdl); c = m.find('-isa', 'Stateflow.Chart', 'Name', 'RedundantSensors'); c.Visible = 0;  %% Main Chart % The main Stateflow chart |RedundantSensors| consists of two "linked % atomic subcharts" called |Sensor1| and |Sensor2|.  c.Visible = 1; ed = c.Editor; ed.WindowPosition(3) = ed.WindowPosition(3)/1.5; ed.WindowPosition(4) = ed.WindowPosition(4)/1.5; ed.ZoomFactor = ed.ZoomFactor*1.5;  %%  % By default, |Sensor1| is active. It reads input |u1| and sets the output % |y|. When it fails, we switch to |Sensor2| which reads input |u2| and % sets the output |y|. When both of them fail, we fall into the |Alarm| % state and produce a nominal zero output. %  % |Sensor1| and |Sensor2| are "linked atomic subcharts". These look and % behave just like normal Stateflow states except that the contents of the % linked atomic subchart reside in a chart in another library model. In % this case, both of the linked atomic subcharts correspond to the library % chart |sf_atomic_sensor_lib/SingleSensor|. %  %% Library Chart %  % The |SingleSensor| chart models a single sensor which accepts a sensor % input |u| and provides a filtered sensor output |y|. It has logic % built-in to detect out-of-range errors. By default the sensor is assumed % to be in the state "OK". If the sensor reading goes out of range (which % is modeled by the transition from "OK" to "FailOnce") and stays faulty % for 0.5 seconds, then we transition to "Fail". In this case, the sensor % outputs a constant 0. This allows the sensor to model faults but ignore % very transient spikes in the sensor reading. %  % Notice the following: %  % * The transition from "OK" to "FailOnce" relies on two Stateflow chart % parameters "LOW" and "HIGH".  % * There is a top-level function called "inFailed" which is used to convey % to the container chart whether the sensor is in a failed state. %   open_system('sf_atomic_sensor_lib'); open_system('sf_atomic_sensor_lib/SingleSensor'); set_param('sf_atomic_sensor_lib', 'Lock', 'off');  cid = sfprivate('block2chart', 'sf_atomic_sensor_lib/SingleSensor'); c = idToHandle(sfroot, cid); ed = c.Editor; ed.WindowPosition(3) = ed.WindowPosition(3)/1.5; ed.WindowPosition(4) = ed.WindowPosition(4)/1.5; ed.ZoomFactor = ed.ZoomFactor*1.5;   %% Mapping Inputs, Outputs and Parameters %  % Notice that the main chart |RedundantSensors| has two inputs |u1| and % |u2|, while the library chart corresponding to the linked atomic % subcharts has only a single input |u|. In this case, we want the linked % subchart |Sensor1| to access the chart input |u1| and the linked subchart % |Sensor2| to access the chart input |u2|. In order to accomplish this, we % need to specify "Mappings" for each instance of the linked atomic % subchart. For example, if you right-click on |Sensor1| and select the % context menu item |Edit Subchart Mappings|, you will see the following % dialog: %  % <<sf_atomic_sensor_pair_binding_sensor1.png>> %  % This dialog allows you to map symbols (inputs, outputs and parameters) % from the main chart to symbols in the library chart. Notice how the input % "u" is mapped to the main chart input "u1". Similarly, parameters defined % in the library chart can be given different values amongst the various % instances of the subchart. %  % In this case, the mappings for |Sensor1| and |Sensor2| are as follows: %  % <html> % <table border="1"> %   <tr> %     <td></td> %     <td><tt>Sensor1</tt></td> %     <td><tt>Sensor2</tt></td> %   </tr> %   <tr> %     <td>u</td> %     <td>u1</td> %     <td>u2</td> %   </tr> %   <tr> %     <td>HIGH</td> %     <td>75</td> %     <td>100</td> %   </tr> %   <tr> %     <td>LOW</td> %     <td>-75</td> %     <td>-100</td> %   </tr> % </table> % </html> %  %% Simulation Behavior % If you simulate the model, you will notice the following behavior: %  % * Initially, both inputs to the main chart are zero. Hence the output % produced is zero. % * When you vary the first input between, u1, between (-75, 75), the % output will track u1. % * As soon as u1 is outside these bounds, y begins to track u2. % * When u2 falls outside the range (-100, 100), then y begins to produce a % nominal zero output. %  % You can <matlab:open_system('sf_atomic_sensor_pair') open> % this model now and start the simulation to see this behavior. To change % the inputs to the chart, double click on the gain blocks and drag the % sliders.  bdclose all; ##### SOURCE END ##### --></body></html>