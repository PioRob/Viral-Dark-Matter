
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>FIR ガウス パルス整形フィルター設計</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="gaussfirdesigndemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit gaussfirdesigndemo">エディターで gaussfirdesigndemo.m を開く</a></div><div class="right"><a href="matlab:echodemo gaussfirdesigndemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>FIR ガウス パルス整形フィルター設計</h1><!--introduction--><p>このデモでは、ガウス パルス整形 FIR フィルターの設計と、この設計に影響を与えるパラメーターを示します。FIR ガウス パルス整形フィルターを設計するには、以下で得られるガウス フィルターの連続時間インパルス応答のサンプリング バージョンを打ち切ります。</p><p><img src="../gaussfirdesigndemo_eq00693.png" alt="$$h(t) = \frac{\sqrt \pi} {a} e^{- \frac{\pi^2 t^2}{a^2}}$$"></p><p>パラメーター 'a' は、以下で得られるガウス フィルターの 3-dB 帯域幅シンボル時間積 (B*Ts) に関連しています。</p><p><img src="../gaussfirdesigndemo_eq56408.png" alt="$$a = \frac{1}{B T_s} \sqrt{\frac{\log 2}{2}}$$"></p><p>設計には 2 つの近似誤差 (打ち切り誤差とサンプリング誤差) があります。打ち切り誤差は、理論的にはガウス フィルターの無限インパルス応答の有限時間 (FIR) を近似するために起こります。サンプリングの誤差 (エイリアシング) は、ガウスの周波数応答が厳密な意味において、実際には帯域制限されていない (すなわち、ある周波数を超えるガウス信号のエネルギーは正確に 0 ではない) という事実によるものです。これは、以下で得られる連続時間ガウス フィルターの伝達関数から示すことができます。</p><p><img src="../gaussfirdesigndemo_eq90923.png" alt="$$H(f) = e^{ - a^2 f^2}$$"></p><p>f が増加すると、周波数応答は 0 になる傾向がありますが、これは、エイリアシングを起こさずにサンプリングすることはできないことを意味します。正確には決して 0 にはなりません。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">連続時間ガウス フィルター</a></li><li><a href="#3">連続時間ガウス フィルターの周波数応答</a></li><li><a href="#4">ガウス フィルターの FIR 近似</a></li><li><a href="#5">FIR ガウス フィルターの周波数応答 (オーバーサンプリング ファクター = 16)</a></li><li><a href="#7">オーバーサンプリング ファクターの重要性</a></li><li><a href="#8">FIR ガウス フィルターの周波数応答 (オーバーサンプリング ファクター = 4)</a></li></ul></div><h2>連続時間ガウス フィルター<a name="1"></a></h2><p>連続時間ガウス フィルターを設計するには、シンボル時間 (Ts) を 1 マイクロ秒に定義し、インパルス応答の開始点とそのピーク (NT) 間のシンボル数を 3 に定義します。上記の式から、ガウス フィルターのインパルス応答と周波数応答は、3dB の帯域幅シンボル時間積に関連するパラメーター 'a' によって決定します。ガウス FIR フィルター設計に対するこのパラメーターの影響を調べるため、Ts に関してさまざまな値 'a' を定義し、対応する帯域幅を計算します。次に、各 'a' のインパルス応答と各帯域幅の振幅応答をプロットします。</p><pre class="codeinput">Ts = 1e-6; <span class="comment">% Symbol time (sec)</span>
NT = 3; <span class="comment">% Number of symbol periods between beginning and peak of impulse response</span>

a = Ts*[.5, .75, 1, 2];
B = sqrt(log(2)/2)./(a);

t = linspace(-NT*Ts,NT*Ts,1000)';
hg = zeros(length(t),length(a));
<span class="keyword">for</span> k = 1:length(a),
    hg(:,k) = sqrt(pi)/a(k)*exp(-(pi*t/a(k)).^2);
<span class="keyword">end</span>

plot(t/Ts,hg)
title(<span class="string">'Impulse response of a continuous-time Gaussian filter for various bandwidths'</span>);
xlabel(<span class="string">'Normalized time (t/Ts)'</span>)
ylabel(<span class="string">'Amplitude'</span>)
legend(sprintf(<span class="string">'a = %g*Ts'</span>,a(1)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(2)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(3)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(4)/Ts))
</pre><img vspace="5" hspace="5" src="../gaussfirdesigndemo_01.png" alt=""> <p>インパルス応答はシンボル時間に正規化されます。</p><h2>連続時間ガウス フィルターの周波数応答<a name="3"></a></h2><p>帯域幅が異なる連続時間ガウス フィルターの周波数応答を計算してプロットします。次のグラフでは、振幅応答曲線の赤い円 ('o') は 3-dB のカットオフを示しています。3-dB の帯域幅は DC と B の間です。</p><pre class="codeinput">f = linspace(0,32e6,10000)';
Hideal = zeros(length(f),length(a));
<span class="keyword">for</span> k = 1:length(a),
    Hideal(:,k) = exp(-a(k)^2*f.^2);
<span class="keyword">end</span>

plot(f,20*log10(Hideal))
title(<span class="string">'Ideal magnitude response for a continuous-time Gaussian filter for various bandwidths'</span>);
legend(sprintf(<span class="string">'B = %g'</span>,B(1)),sprintf(<span class="string">'B = %g'</span>,B(2)),sprintf(<span class="string">'B = %g'</span>,B(3)),sprintf(<span class="string">'B = %g'</span>,B(4)))
hold <span class="string">on</span>
<span class="keyword">for</span> k = 1:length(a),
    plot(B,20*log10(exp(-a.^2.*B.^2)),<span class="string">'ro'</span>)
<span class="keyword">end</span>

axis([0 5*max(B) -50 5])
xlabel(<span class="string">'Frequency (Hz)'</span>)
ylabel(<span class="string">'Magnitude (dB)'</span>)
</pre><img vspace="5" hspace="5" src="../gaussfirdesigndemo_02.png" alt=""> <h2>ガウス フィルターの FIR 近似<a name="4"></a></h2><p>関数 FDESIGN.PULSESHAPING を使用して FIR ガウス フィルターを設計します。関数 FDESIGN.PULSESHAPING は、オーバーサンプリング ファクター (シンボルあたりのサンプル数など)、3-dB の帯域幅シンボル時間積、およびフィルターのインパルス応答の開始点と入力の終了点の間のシンボル周期の数を取得します。</p><p>オーバーサンプリング ファクター (OF) は、サンプリング周波数とフィルター長を決定するガウス FIR フィルター設計の重要な要素です。設計時の近似誤差は、オーバーサンプリング ファクターを適切に選択することで軽減できます。ここでは、2 つの異なるオーバーサンプリング ファクターを使用して設計されたガウス FIR フィルターを比較して説明します。</p><p>最初に、離散ガウス フィルターを設計するためのオーバーサンプリング ファクターについて考えます。</p><pre class="codeinput">OF = 16; <span class="comment">% Oversampling factor (samples/symbol)</span>
d = fdesign.pulseshaping(OF,<span class="string">'Gaussian'</span>,<span class="string">'Nsym,BT'</span>,2*NT);
<span class="keyword">for</span> k = 1:length(a),
    d.BT = B(k)*Ts;
    h(k) = design(d);
<span class="keyword">end</span>
[iz,t] = impz(h);
t = (t-t(end)/2)/Ts;
figure(<span class="string">'color'</span>,<span class="string">'white'</span>)
stem(t,iz)
title(<span class="string">'Impulse response of the Gaussian FIR filter for various bandwidths, OF=16'</span>);
xlabel(<span class="string">'Normalized time (t/Ts)'</span>)
ylabel(<span class="string">'Amplitude'</span>)
legend(sprintf(<span class="string">'a = %g*Ts'</span>,a(1)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(2)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(3)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(4)/Ts))
</pre><img vspace="5" hspace="5" src="../gaussfirdesigndemo_03.png" alt=""> <h2>FIR ガウス フィルターの周波数応答 (オーバーサンプリング ファクター = 16)<a name="5"></a></h2><p>オーバーサンプリング ファクター 16 を使用してガウス FIR フィルターの周波数応答を計算し、理想的な周波数応答 (連続時間ガウス フィルターの周波数応答など) と比較します。</p><pre class="codeinput">Fs = OF/Ts;
hfvt = fvtool(h, <span class="string">'FrequencyRange'</span>, <span class="string">'Specify freq. vector'</span>, <span class="keyword">...</span>
    <span class="string">'FrequencyVector'</span>,f,<span class="string">'Fs'</span>,Fs,<span class="string">'color'</span>,<span class="string">'white'</span>);
title({<span class="string">'Ideal mag. responses (dashed lines) and corresponding FIR approximations (solid lines)'</span> ;<span class="string">' for various values of B, OF=16'</span>})
legend(hfvt, sprintf(<span class="string">'B = %g'</span>,B(1)),sprintf(<span class="string">'B = %g'</span>,B(2)),<span class="keyword">...</span>
    sprintf(<span class="string">'B = %g'</span>,B(3)),sprintf(<span class="string">'B = %g'</span>,B(4)), <span class="keyword">...</span>
    <span class="string">'Location'</span>,<span class="string">'NorthEast'</span>)
hold <span class="string">on</span>;
plot(f*Ts,20*log10(Hideal),<span class="string">'--'</span>)
axis([0 32 -350 5])
</pre><img vspace="5" hspace="5" src="../gaussfirdesigndemo_04.png" alt=""> <p>最初の 2 つの FIR フィルターはエイリアシング誤差を示し、最後の 2 つの FIR フィルターは打ち切り誤差を示しています。エイリアシングは、サンプリング周波数がナイキスト周波数以下である場合に発生します。最初の 2 つのフィルターでは帯域幅が大きいため、オーバーサンプリング ファクターによって、エイリアシングを防げるだけのスペクトルの複製が分割されません。ただし、エイリアシングの量はあまり重要ではありません。</p><p>一方、最後の 2 つの FIR フィルターは、エイリアシングが発生する前の FIR 近似限界を示しています。これらの 2 つのフィルターの振幅応答は、スペクトルの複製と重なる前に底に達します。</p><h2>オーバーサンプリング ファクターの重要性<a name="7"></a></h2><p>エイリアシングと打ち切り誤差は、オーバーサンプリング ファクターに応じて変わります。オーバーサンプリング ファクターが減少すると、サンプリング周波数が減少し (これによって複製が接近する)、フィルター長も減少するため (FIR 近似の誤差が増加する)、これらの誤差が重大になります。</p><p>たとえば、オーバーサンプリング ファクターを 4 に指定すると、FIR フィルターではスペクトルの複製の重なりを防ぐのにサンプリング周波数の大きさが十分でなくなるため、FIR フィルターはエイリアシング誤差を生じます。</p><pre class="codeinput">OF = 4; <span class="comment">% Oversampling factor (samples/symbol)</span>
d.SamplesPerSymbol = OF;
<span class="keyword">for</span> k = 1:length(a),
    d.BT = B(k)*Ts;
    h(k) = design(d);
<span class="keyword">end</span>
[iz,t] = impz(h);
t = (t-t(end)/2)/Ts;
figure(<span class="string">'color'</span>,<span class="string">'white'</span>)
stem(t,iz)
title(<span class="string">'Impulse response of the Gaussian FIR filter for various bandwidths, OF=4'</span>);
xlabel(<span class="string">'Normalized time (t/Ts)'</span>)
ylabel(<span class="string">'Amplitude'</span>)
legend(sprintf(<span class="string">'a = %g*Ts'</span>,a(1)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(2)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(3)/Ts),sprintf(<span class="string">'a = %g*Ts'</span>,a(4)/Ts))
</pre><img vspace="5" hspace="5" src="../gaussfirdesigndemo_05.png" alt=""> <h2>FIR ガウス フィルターの周波数応答 (オーバーサンプリング ファクター = 4)<a name="8"></a></h2><p>オーバーサンプリング ファクターを 4 に指定して設計したガウス FIR フィルターの周波数応答をプロットして、検討します。オーバーサンプリング ファクターが小さくなると、サンプリング周波数も小さくなります。その結果、このサンプリング周波数がスペクトルの重なりを防ぐのに十分な大きさでなくなり、すべての FIR 近似フィルターはエイリアシングを生じます。</p><pre class="codeinput">Fs = OF/Ts;
hfvt = fvtool(h, <span class="string">'FrequencyRange'</span>, <span class="string">'Specify freq. vector'</span>, <span class="keyword">...</span>
    <span class="string">'FrequencyVector'</span>,f,<span class="string">'Fs'</span>,Fs,<span class="string">'color'</span>,<span class="string">'white'</span>);
title({<span class="string">'Ideal mag. responses (dashed lines) and corresponding FIR approximations (solid lines)'</span> ;<span class="string">' for various values of B, OF=4'</span>})
legend(hfvt, sprintf(<span class="string">'B = %g'</span>,B(1)),sprintf(<span class="string">'B = %g'</span>,B(2)),<span class="keyword">...</span>
    sprintf(<span class="string">'B = %g'</span>,B(3)),sprintf(<span class="string">'B = %g'</span>,B(4)), <span class="keyword">...</span>
    <span class="string">'Location'</span>,<span class="string">'NorthEast'</span>)
hold <span class="string">on</span>;
plot(f*Ts,20*log10(Hideal),<span class="string">'--'</span>)
axis([0 32 -350 5])
</pre><img vspace="5" hspace="5" src="../gaussfirdesigndemo_06.png" alt=""> <img vspace="5" hspace="5" src="../gaussfirdesigndemo_07.png" alt=""> <p class="footer">Copyright 1984-2006 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% FIR Gaussian Pulse-shaping Filter Design % This demo shows the design of the Gaussian pulse-shaping FIR filter and % the parameters influencing this design. The FIR Gaussian pulse-shaping % filter design is done by truncating a sampled version of the % continuous-time impulse response of the Gaussian filter which is given % by: %   % $$h(t) = \frac{\sqrt \pi} {a} e^{- \frac{\pi^2 t^2}{a^2}}$$ %  % The parameter 'a' is related to 3-dB bandwidth-symbol time product (B*Ts)  % of the Gaussian filter as given by: %  % $$a = \frac{1}{B T_s} \sqrt{\frac{\log 2}{2}}$$ %  % There are two approximation errors in the design: a truncation error and % a sampling error. The truncation error is due to a finite-time (FIR) % approximation of the theoretically infinite impulse response of the ideal % Gaussian filter. The sampling error (aliasing) is due to the fact that a % Gaussian frequency response is not really band-limited in a strict sense % (i.e. the energy of the Gaussian signal beyond a certain frequency is not % exactly zero). This can be noted from the transfer function of the % continuous-time Gaussian filter, which is given as below:  %    % $$H(f) = e^{ - a^2 f^2}$$ %  % As f increases, the frequency response tends to zero, but never is % exactly zero, which means that it cannot be sampled without some aliasing % occurring.  %  % Copyright 1984-2006 The MathWorks, Inc.  % $Revision: 1.1.4.2.2.1 $  $Date: 2010/07/29 21:29:04 $ % %% Continuous-time Gaussian Filter  % To design a continuous-time Gaussian filter, let us define the symbol % time (Ts) to be 1 micro-second and the number of symbols between the % start of the impulse response and its peak (NT) to be 3. From the % equations above, we can see that the impulse response and the frequency % response of the Gaussian filter depend on the parameter 'a' which is % related to the 3 dB bandwidth-symbol time product. To study the effect of % this parameter on the Gaussian FIR filter design, we will define various % values of 'a' in terms of Ts and compute the corresponding bandwidths. % Then, we will plot the impulse response for each 'a' and the magnitude % response for each bandwidth. % Ts = 1e-6; % Symbol time (sec) NT = 3; % Number of symbol periods between beginning and peak of impulse response  a = Ts*[.5, .75, 1, 2];  B = sqrt(log(2)/2)./(a);  t = linspace(-NT*Ts,NT*Ts,1000)'; hg = zeros(length(t),length(a)); for k = 1:length(a),     hg(:,k) = sqrt(pi)/a(k)*exp(-(pi*t/a(k)).^2); end  plot(t/Ts,hg) title('Impulse response of a continuous-time Gaussian filter for various bandwidths'); xlabel('Normalized time (t/Ts)') ylabel('Amplitude') legend(sprintf('a = %g*Ts',a(1)/Ts),sprintf('a = %g*Ts',a(2)/Ts),sprintf('a = %g*Ts',a(3)/Ts),sprintf('a = %g*Ts',a(4)/Ts)) %% % Note that the impulse responses are normalized to the symbol time. % %% Frequency Response for Continuous-time Gaussian Filter % We will compute and plot the frequency response for continuous-time % Gaussian filters with different bandwidths. In the graph below, the 3-dB % cutoff is indicated by the red circles ('o') on the magnitude response % curve. Note that 3-dB bandwidth is between DC and B. %  f = linspace(0,32e6,10000)'; Hideal = zeros(length(f),length(a)); for k = 1:length(a),     Hideal(:,k) = exp(-a(k)^2*f.^2); end  plot(f,20*log10(Hideal)) title('Ideal magnitude response for a continuous-time Gaussian filter for various bandwidths'); legend(sprintf('B = %g',B(1)),sprintf('B = %g',B(2)),sprintf('B = %g',B(3)),sprintf('B = %g',B(4))) hold on for k = 1:length(a),     plot(B,20*log10(exp(-a.^2.*B.^2)),'ro')  end  axis([0 5*max(B) -50 5]) xlabel('Frequency (Hz)') ylabel('Magnitude (dB)')   %% FIR approximation of the Gaussian Filter % We will design the FIR Gaussian filter using the FDESIGN.PULSESHAPING % function. The FDESIGN.PULSESHAPING function takes the oversampling factor % (i.e. the number of samples per symbol), the 3-dB bandwidth-symbol time % product and number of symbol periods between the start of the filter % impulse response and the end as inputs.  % % The oversampling factor (OF) determines the sampling frequency and the % filter length and hence, plays a significant role in the Gaussian FIR % filter design. The approximation errors in the design can be reduced with % an appropriate choice of oversampling factor. We illustrate this by % comparing the Gaussian FIR filters designed with two different % oversampling factors. %  % First, we will consider oversampling factor of 16 to design the discrete Gaussian % filter.  % OF = 16; % Oversampling factor (samples/symbol) d = fdesign.pulseshaping(OF,'Gaussian','Nsym,BT',2*NT); for k = 1:length(a),     d.BT = B(k)*Ts;     h(k) = design(d); end [iz,t] = impz(h); t = (t-t(end)/2)/Ts; figure('color','white') stem(t,iz) title('Impulse response of the Gaussian FIR filter for various bandwidths, OF=16'); xlabel('Normalized time (t/Ts)') ylabel('Amplitude') legend(sprintf('a = %g*Ts',a(1)/Ts),sprintf('a = %g*Ts',a(2)/Ts),sprintf('a = %g*Ts',a(3)/Ts),sprintf('a = %g*Ts',a(4)/Ts))  %% Frequency Response for FIR Gaussian Filter (oversampling factor=16) % We will calculate the frequency response for the Gaussian FIR filter with % an oversampling factor of 16 and we will compare it with the ideal % frequency response (i.e. frequency response of a continuous-time Gaussian % filter).  Fs = OF/Ts; hfvt = fvtool(h, 'FrequencyRange', 'Specify freq. vector', ...     'FrequencyVector',f,'Fs',Fs,'color','white'); title({'Ideal mag. responses (dashed lines) and corresponding FIR approximations (solid lines)' ;' for various values of B, OF=16'}) legend(hfvt, sprintf('B = %g',B(1)),sprintf('B = %g',B(2)),...     sprintf('B = %g',B(3)),sprintf('B = %g',B(4)), ...     'Location','NorthEast') hold on; plot(f*Ts,20*log10(Hideal),'REPLACE_WITH_DASH_DASH') axis([0 32 -350 5])  %% % Notice that the first two FIR filters exhibit aliasing error and the last % two FIR filters exhibit the truncation error. Aliasing occurs when the % sampling frequency is not greater than the Nyquist frequency. In case of % the first two filters, the bandwidth is large enough that the % oversampling factor does not separate the spectral replicas enough to % avoid aliasing. The amount of aliasing is not very significant however.  %  % On the other hand, the last two FIR filters show the FIR approximation % limitation before any aliasing can occur. The magnitude responses of % these two filters reach a floor before they can overlap with the spectral % replicas.  %% Significance of the Oversampling Factor  % The aliasing and truncation errors vary according to the oversampling % factor. If the oversampling factor is reduced, these errors will be more % severe, since this reduces the sampling frequency (thereby moving the % replicas closer) and also reduces the filter lengths (increasing the % error in the FIR approximation).  %  % For example, if we select the oversampling factor of 4, we will see that % all the FIR filters exhibit aliasing error as the sampling frequency is % not large enough to avoid the overlapping of the spectral replicas in % case of any FIR filter.  %  OF = 4; % Oversampling factor (samples/symbol) d.SamplesPerSymbol = OF; for k = 1:length(a),     d.BT = B(k)*Ts;     h(k) = design(d); end [iz,t] = impz(h); t = (t-t(end)/2)/Ts; figure('color','white') stem(t,iz) title('Impulse response of the Gaussian FIR filter for various bandwidths, OF=4'); xlabel('Normalized time (t/Ts)') ylabel('Amplitude') legend(sprintf('a = %g*Ts',a(1)/Ts),sprintf('a = %g*Ts',a(2)/Ts),sprintf('a = %g*Ts',a(3)/Ts),sprintf('a = %g*Ts',a(4)/Ts))   %% Frequency Response for FIR Gaussian Filter (oversampling factor=4) % We will plot and study the frequency response for the Gaussian FIR filter % designed with oversampling factor of 4. A smaller oversampling factor % means smaller sampling frequency. As a result, this sampling frequency is % not enough to avoid the spectral overlap and all the FIR approximation % filters exhibit aliasing in this case.  Fs = OF/Ts; hfvt = fvtool(h, 'FrequencyRange', 'Specify freq. vector', ...     'FrequencyVector',f,'Fs',Fs,'color','white'); title({'Ideal mag. responses (dashed lines) and corresponding FIR approximations (solid lines)' ;' for various values of B, OF=4'}) legend(hfvt, sprintf('B = %g',B(1)),sprintf('B = %g',B(2)),...     sprintf('B = %g',B(3)),sprintf('B = %g',B(4)), ...     'Location','NorthEast') hold on; plot(f*Ts,20*log10(Hideal),'REPLACE_WITH_DASH_DASH') axis([0 32 -350 5])  displayEndOfDemoMessage(mfilename) ##### SOURCE END ##### --></body></html>