
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>Simulink&reg; バス信号</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="busdemo.m"><link rel="stylesheet" type="text/css" href="../../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">busdemo.mdl</div><div class="right"><a href="matlab:busdemo">このモデルを開く</a></div></div><div class="content"><h1>Simulink&reg; バス信号</h1><!--introduction--><p>この対話型のデモでは、次の Simulink&reg; の概念を紹介します。</p><div><ul><li>ベクトル、行列およびバス/複合信号の識別</li><li>信号線の書式の理解</li><li>信号次元の表示および理解 </li><li>Bus Creator ブロックおよび Bus Selector ブロックの使用</li><li>Simulink Scope での行列信号の表示</li><li>Simulink ブロック線図でのブロックの強調表示</li></ul></div><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">モデルの説明</a></li><li><a href="#20">Simulink でのバス信号および線の書式</a></li><li><a href="#27">Simulink でのベクトル信号</a></li><li><a href="#34">Simulink での行および列の行列信号</a></li><li><a href="#37">Simulink での行列信号</a></li><li><a href="#40">Bus Creator ブロックの使用</a></li><li><a href="#47">Bus Selector ブロックの使用</a></li><li><a href="#53">興味深い機能:HILITE_SYSTEM</a></li></ul></div><h2>モデルの説明<a name="1"></a></h2><img vspace="5" hspace="5" src="../busdemo_01.png" alt=""> <p>busdemo モデルの左側には、Simulink Sources ライブラリからのソース ブロックが 5 つ含まれています。各ブロックは、幅が 1 の信号であるスカラー出力信号を生成します。ブロック線図では、これらの信号に適切なラベルが付けられています。</p><p>Chirp Signal ブロックの出力は、タグが A に設定されている Goto ブロックへ渡されます。</p><img vspace="5" hspace="5" src="../busdemo_02.png" alt=""> <p>Subsystem ブロック内に、関連付けられている From ブロックがあります。</p><img vspace="5" hspace="5" src="../busdemo_03.png" alt=""> <p>また、Subsystem ブロック内では、チャープ信号と Constant ブロックの出力が、Bus Creator ブロック (Simulink Signal Routing ライブラリ内に存在) を使用してバンドルされ、1 つのバスに入れられています。</p><img vspace="5" hspace="5" src="../busdemo_04.png" alt=""> <p>同様に、Clock ブロック、Pulse Generator ブロック、および Sine Wave ブロックからの 3 つの信号も、別の Bus Creator ブロックを使用してバンドルされます。</p><img vspace="5" hspace="5" src="../busdemo_05.png" alt=""> <p>この Bus Creator ブロックには、Bus Creator2 というラベルが付けられています。</p><img vspace="5" hspace="5" src="../busdemo_06.png" alt=""> <p>その後、bus1 と bus2 というラベルが付けられた 2 つのバス信号が 3 つ目の Bus Creator ブロックを使用してバンドルされ、main_bus というラベルが付けられた入れ子にされたバス信号が作成されます。</p><img vspace="5" hspace="5" src="../busdemo_07.png" alt=""> <p>その後、最後の Bus Creator から、バンドルされた信号が Bus Selector ブロックへ渡されます。</p><img vspace="5" hspace="5" src="../busdemo_08.png" alt=""> <p>Bus Selector ブロックは、元の信号バンドルからパルス信号とチャープ信号を抽出します。最終的に、この 2 つの信号が Simulink Scope に 2 つの座標軸を使用して表示されます。</p><img vspace="5" hspace="5" src="../busdemo_09.png" alt=""> <p>パルス信号は上の座標軸に表示され、チャープ信号は下の座標軸に表示されます。</p><p>シミュレーションを実行して、Scope で Chirp ブロックと Pulse ブロックの出力を表示することができます。</p><img vspace="5" hspace="5" src="../busdemo_10.png" alt=""> <p>メモ:さまざまな理由から、このモデルでは Mux ブロックと Demux ブロックではなく、Bus Creator ブロックと Bus Selector ブロックを使用しています。重要な動機の 1 つは、バス信号は非常に効率がよいということです。バス信号の場合、シミュレーション中にブロック線図内では Bus Selector で選択された信号のみが順に渡されていくからです。考慮すべきもう 1 つの点は、この 2 つの Bus ブロックは信号名を使用して設定されるため、読みやすい Simulink ブロック線図を作成できるという点です。</p><h2>Simulink でのバス信号および線の書式<a name="20"></a></h2><p>シミュレーションの実行後、busdemo.mdl 内の線を確認してください。以下に示すように、Bus Creator ブロックと Bus Selector ブロックに接続している信号は 3 本の線で描かれています。</p><img vspace="5" hspace="5" src="../busdemo_11.png" alt=""> <p>この線の書式は、信号が<b>バス信号</b>であることを示しています。バス信号とは信号のセットのことで、1 つに束ねられたワイヤーの束のようなものです。バス信号は、バス信号にバンドルされている信号のサイズと形状に基づいて、ベクトル信号として動作するか、あるいは複合信号として動作するという 2 つの方法のいずれかで動作できます。</p><p>これをよりよく理解するために、Simulink ブロック線図の <b>[書式]</b> メニューの <b>[端子/信号の表示]</b> サブメニューで <b>[信号次元]</b> 項目をオンにして、信号次元を表示してください。以下に示すように、バス信号に「5{5}」というラベルが表示されるはずです。</p><img vspace="5" hspace="5" src="../busdemo_12.png" alt=""> <p>中かっこの前の数値は、そのバス信号を作成するのに何本の線がバンドルされたのかを示します。たとえば、Bus Creator2 ブロックの出力は、Clock ブロック、Pulse ブロック、および Sine Wave ブロックからの 3 本の線から作成されています。中かっこ内の数値は、そのバスに合計いくつの信号が含まれているのかを示します。信号 bus2 の場合、Source ブロックからの各出力はスカラーであるため、バスには、各線から 1 つずつ、合計 3 つの信号が含まれています。</p><p>このモデル内のすべてのバス信号は、バス内の個々の信号がスカラーであるため、ベクトル信号と同様に扱われます。Gain、Sum、Integer など、ベクトル入力を受け入れる Simulink ブロックに、ベクトル信号と同様のものとしてこのバス信号を渡すことができます。</p><p>以下に示すように、バス信号は、バス内の個々の信号のすべてがスカラーまたは 1 次元ベクトルのいずれかである場合にも、ベクトル信号として扱われます。</p><h2>Simulink でのベクトル信号<a name="27"></a></h2><p>スカラーではなく信号のベクトルを出力するように Sine Wave ブロックを変更できます。</p><img vspace="5" hspace="5" src="../busdemo_13.png" alt=""> <p>このためには、まず、ブロック線図内の Sine Wave ブロックをダブルクリックして開きます。これにより、Sine Wave ブロックに関連付けられている [ブロック パラメーター] ダイアログが開きます。</p><p>[ブロック パラメーター] ダイアログの最初のフィールドは <b>[振幅]</b> です。次のコマンドを使用して、このフィールド内の値をベクトルに変更できます。</p><p>1 [振幅] フィールドに [1 2] と入力します。</p><p>2 <b>[OK]</b> をクリックして、変更を適用し、ダイアログを閉じます。</p><p>3 モデルの <b>[編集]</b> メニューから <b>[ブロック線図の更新]</b> を選択して、Simulink ブロック線図を更新します。</p><img vspace="5" hspace="5" src="../busdemo_14.png" alt=""> <p>Sine Wave ブロックから出ている線には「2」と表示されます。これは、この線が 2 つの要素を持つベクトル信号 (つまり 1 次元信号) を伝送していることを示しています。Bus Selector ブロックへの入力信号には、「5{6}」というラベルが付けられています。中かっこの前の 5 は、バス信号にはこれまでどおり 5 つの信号がバンドルされていることを示しています。これらの信号の 1 つが 2 つの要素を持つベクトルであるため、バス信号の合計幅は 6 (中かっこ内の数値) となっています。</p><p>バス信号はこれまでどおりベクトルとして扱われ、ベクトル信号を受け入れる Simulink ブロックに渡すことができます。実際には、バス信号は、スカラーと 1 次元ベクトルのみで構成されている限り、ベクトル信号として扱われます。この後すぐに説明しますが、バス信号がベクトルとして扱われる場合の条件はもう1つあります。</p><h2>Simulink での行および列の行列信号<a name="34"></a></h2><p>既定の設定では、Simulink ブロック線図内の信号は 1 次元ベクトルとなります。ただし、ブロック線図に 2 次元の行列を導入することはできます。これをデモンストレーションするために、Sine Wave ブロックを変更して、以前入力したベクトルではなく行列信号を出力するようにします。</p><p>このためには、Sine Wave ブロックをダブルクリックして開きます。ダイアログの下部 (および<b>すべての</b> Source ブロックのダイアログの下部) に、<b>[ベクトル パラメータを 1 次元として解釈]</b> チェック ボックスが表示されます。</p><div><ul><li>このチェック ボックスをオンにすると、Simulink は、[ブロック パラメーター] ダイアログに入力された行または列ベクトルを 1 次元配列として解釈します。</li><li>このチェック ボックスをオンにしない場合は、Simulink は、[ブロック パラメーター] ダイアログに入力された行または列ベクトルを 2 次元行列として解釈します。<b>メモ:</b>このモードで作業する場合は、[ブロック パラメーター] ダイアログに入力するベクトルと行列の次元をすべて一致させる必要があります。</li></ul></div><p>これを説明するために、次の手順を使用して、Sine Wave の出力を 2 次元にします。</p><p>1. <b>[ベクトル パラメータを 1 次元として解釈]</b> チェック ボックスをオフにします。</p><p>2. <b>[OK]</b> をクリックして、変更を適用し、ダイアログを閉じます。</p><p>3. Simulink ブロック線図を更新して、信号次元のラベルで変更が有効になっていることを確認します。</p><img vspace="5" hspace="5" src="../busdemo_15.png" alt=""> <p>Sine Wave ブロックの出力信号には、[1x2] というラベルが付けられています。Simulink は、実際にその線で 2 次元の行列信号を伝送しているのです。Bus Selector ブロックへの入力信号には合計 6 つの要素を持つ 5 つの信号が含まれているため、この信号には、これまでどおり「5{6}」というラベルが付けられています。ただし、この場合、バス内の 5 つ目の信号は、実際は行行列です。</p><p>これは、バス信号がベクトルとして扱われる最後の事例ですが、バス内のすべての信号が、スカラー、1 次元ベクトル、行行列、または列行列のいずれかである場合、バス信号は、ベクトル信号として扱われます。バスに行行列と列行列の信号が両方とも含まれている場合は、バス信号はベクトル信号ではなくなります。その代わり、そのバス信号は複合信号として扱われます。これについては、この後すぐに説明します。</p><h2>Simulink での行列信号<a name="37"></a></h2><p>Source ブロックには、任意の 2 次元行列を入力できます。 たとえば、2 x 2 行列を入力するには、[Sine Wave ブロック] ダイアログを開き、<b>[振幅]</b> パラメータに [1 2; 3 4] と入力して、ブロック線図を更新します。</p><img vspace="5" hspace="5" src="../busdemo_16.png" alt=""> <p>Sine Wave ブロックからの出力信号の次元は [2x2] となります。</p><p><b>メモ:</b> m x n 行列 (ここで m と n はどちらも 1 ではない) を入力すると、<b>[ベクトル パラメータを 1 次元として解釈]</b> チェック ボックスの現在の状態にかかわらず、ブロックの出力は常に行列となります。このチェック ボックスは、m または n のいずれかが 1 である場合に<b>のみ</b>、ベクトル パラメータに適用されます。</p><p>Bus Selector ブロックへの入力信号には、「5{8}」というラベルが付けられています。この信号には 5 つの信号が含まれていますが、それらの信号の 1 つが 4 つの要素を持っているため、全幅は 8 となります。この場合、バス信号は複合信号として扱われます。実際には、バス内の信号のいずれかに行行列でも列行列でもない 2 次元信号が含まれると直ちに、バス信号が自動的に複合信号として扱われるようになります。</p><p>複合信号は、Simulink ブロック線図を通る単一のワイヤーにデータをバンドルする場合に役立ちます。ただし、複合信号は、ほとんどの Simulink ブロックに入ることができません。実際には、複合信号は、Bus Selector、Subsystem、Goto、Demux などのバーチャル ブロックにしか入れません。</p><p>要約すると、次の条件のいずれかが満たされる場合に、バス信号が複合信号として扱われます。</p><p>1. バスに、行行列である信号と、列行列である信号が含まれている場合。</p><p>2. バスに、1 つ以上の [m x n] 行列 (ここで m と n はどちらも 1 より大きい) が含まれている場合。</p><h2>Bus Creator ブロックの使用<a name="40"></a></h2><p>バス信号の構造をさらに深く理解するために、Bus Creator ブロックを開きます。</p><img vspace="5" hspace="5" src="../busdemo_17.png" alt=""> <p>このブロックには 2 つの入力があります。これらの入力はそれぞれ、その入力自体がバス信号となっています。bus1 と bus2 というラベルが付けられたこの 2 つのバス信号は、<b>[バス内の信号]</b> リストに、前に正符号を付けて示されます。この 2 つのバス信号を、ツリー内のそれぞれの最上位ノードをダブルクリックして開くと、最後のバスを構成する入れ子にされた信号が表示されます。</p><p><b>[バス内の信号]</b> リストで使用されている名前は、Simulink ブロック線図に入力された信号名から継承されたものです。特定の信号の発信元を検出したい場合は、次の手順を実行します。</p><p>1. たとえば、bus2 ノード内のパルス信号を選択します。</p><p>2. <b>[バス内の信号]</b> リストの右側にある [検索] をクリックします。</p><p>3. Pulse Generator ブロックが強調表示されます。</p><img vspace="5" hspace="5" src="../busdemo_18.png" alt=""> <p>Bus Creator は信号名を使用して、バス内の特定の信号のソースを特定します。</p><h2>Bus Selector ブロックの使用<a name="47"></a></h2><p>信号ラベルが示すように、Bus Creator ブロックの出力はこれまでどおり 5 つの信号で構成されています。ここで、最後の要素は、以前に入力した 2 x 2 行列信号です。これを説明するために、Sine Wave ブロックからの行列信号を出力するように Bus Selector ブロックを設定できます。このためには、まず、Bus Selector ブロックをダブルクリックして開きます。</p><img vspace="5" hspace="5" src="../busdemo_19.png" alt=""> <div><ul><li>このダイアログの左側に、Bus Selector ブロックへ渡されるすべての信号のリストが表示されています。バスに対応するツリーをクリックすると、そのバスを構成しているソース信号を表示できます。Bus Creator の出力信号は、bus1 と bus2 という 2 つのバス信号で構成されています。</li><li>右側には、[選択された信号] が表示されています。これは、Bus Selector ブロックの出力となるすべての入力信号が示されたリストです。特定の入力バスに対応する信号を参照するには、ドット表記を使用します。たとえば、bus1 からのチャープ入力信号にアクセスするには、bus1.Chirp を使用します。</li></ul></div><p>次の手順は、Pulse Generator ソースと Sine Wave ソースに対応する出力信号リストを指定する方法を説明しています。</p><p>1. <b>[選択された信号]</b> リスト内の bus1.Chirp 信号を強調表示し、このリストの左側にある [削除] を選択して、この信号を削除します。</p><p>2. <b>[バス内の信号]</b> リスト内の bus2.Sine 信号を強調表示し、<b>[選択]</b> を選択して、この信号を <b>[選択された信号]</b> に追加します。</p><p>3. <b>[OK]</b> を選択して、これらの変更を適用し、ダイアログを閉じます。</p><p>シミュレーションを実行します｡ Scope の下の座標軸に、Sine Wave ブロックからの 4 つの信号が表示されます。</p><img vspace="5" hspace="5" src="../busdemo_20.png" alt=""> <h2>興味深い機能:HILITE_SYSTEM<a name="53"></a></h2><p>このデモでは、リンクのいくつかをクリックしたときに、Simulink ブロック線図内のさまざまなブロックが強調表示されました。これは、関数 hilite_system を使用して行われたことです。構文は hilite_system(sys) です。ここで、sys は強調表示したいブロックの名前です。多種多様の強調表示スキームがあります。これらのスキームについては、このコマンドのヘルプ テキストを参照してください。Sine Wave ブロックを強調表示する例をいくつか次に示します。</p><div><ul><li><a href="matlab:busdemo;hilite_system(['busdemo/Sine',char(32),'Wave'],'find');">hilite_system('busdemo/Sine Wave','find')</a>  [検索] ダイアログで使用される強調表示スキームを使用します。このスキームは背景色を変更します。</li><li><a href="matlab:busdemo;hilite_system(['busdemo/Sine',char(32),'Wave'],'unique');">hilite_system('busdemo/Sine Wave','unique')</a>  前景色を変更する強調表示スキームを使用します。</li><li><a href="matlab:busdemo;hilite_system(['busdemo/Sine',char(32),'Wave'],'none');">hilite_system('busdemo/Sine Wave','none')</a>  強調表示を削除します。</li></ul></div><p class="footer">Copyright 2005-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Simulink(R) Bus Signals % % This interactive demonstration introduces you to the following Simulink(R) % concepts:  % % * Distinguishing vector, matrix, and bus/composite signals % * Understanding signal line formats  % * Displaying and understanding signal dimensions  % * Using the Bus Creator and the Bus Selector blocks  % * Viewing matrix signals on a Simulink Scope  % * Highlighting blocks in the Simulink diagram  %  % Copyright 2005-2009 The MathWorks, Inc.   %% Model Description % open_system('busdemo');  %% % The left side of the busdemo model contains five source blocks from the Simulink % Sources library.  Each block generates a scalar output signal, a signal % with a width of one, that is appropriately labeled on the diagram.   %% % The output of the Chirp Signal block is passed into a Goto block whose % Tag is set to A.   close_system('busdemo',0);  %% open_system('busdemo'); hilite_system('busdemo/Goto','find')  %% % The associated From block is found inside of the Subsystem block.   hilite_system('busdemo/Goto','none') open_system('busdemo/Subsystem'); hilite_system('busdemo/Subsystem/From','find')  %% hilite_system('busdemo/Subsystem/From','none') close_system('busdemo/Subsystem',0);  %% % Also inside the Subsystem block, you'll see that the Chirp signal and the % output of the Constant block are bundled together into a bus using a Bus % Creator block (found in the Simulink Signal Routing library).   open_system('busdemo/Subsystem'); hilite_system(['busdemo/Subsystem/Bus',char(32),'Creator1'],'find')  %% close_system('busdemo',0);  %% % Similarly, the three signals from the Clock, Pulse Generator, Sine Wave % blocks are bundled together using another Bus Creator block.    open_system('busdemo'); hilite_system('busdemo/Clock','find') hilite_system(['busdemo/Pulse',char(32),'Generator'],'find') hilite_system(['busdemo/Sine',char(32),'Wave'],'find')  %% close_system('busdemo',0);  %% % This Bus Creator block is labeled Bus Creator2.   open_system('busdemo'); hilite_system(['busdemo/Bus',char(32),'Creator2'],'find')  %% close_system('busdemo',0);  %% % The two bus signals, labeled bus1 and bus2, are then bundled together % using a third Bus Creator block to create the nested bus signal labeled % main_bus.    open_system('busdemo'); hilite_system(['busdemo/Bus',char(32),'Creator'],'find')  %% close_system('busdemo',0);  %% % The bundled signal from the final Bus Creator is then passed into the Bus % Selector block.   open_system('busdemo'); hilite_system(['busdemo/Bus',char(32),'Selector'],'find')  %% close_system('busdemo',0);  %% % The Bus Selector block extracts the Pulse and Chirp signals from the % original bundle of signals. These two signals are finally displayed on a % Simulink Scope with two axes.  open_system('busdemo'); hilite_system(['busdemo/Bus',char(32),'Output'],'find')  %% % The Pulse signal is shown on the top axis and the Chirp signal on the bottom axis. % % You can run the simulation to see the output of the Chirp and Pulse blocks on the Scope.  hilite_system(['busdemo/Bus',char(32),'Output'],'none') sim('busdemo');  %% % Note: This model uses Bus Creator and Bus Selector blocks instead of Mux % and Demux blocks for a variety reasons. One important motivation is that % bus signals are very efficient, as only the signals chosen in the Bus % Selector are passed around the diagram during a simulation. Another % consideration is that the two Bus blocks are configured using the signal % names, allowing you to create a Simulink diagram that is easier to read.    %% Bus signals and line formats in Simulink %  % After running the simulation, look at the lines in busdemo.mdl. Notice % that the signal connecting the Bus Creator and Bus Selector blocks is % drawn with three lines, as shown below.   open_system('sldemo_help_show_bus.mdl'); set_param(gcs,'SimulationCommand','update');  %% % This line format indicates that the signal is a *bus signal*. A bus signal % represents a set of signals, analogous to a bundle of wires tied % together. The bus signal can behave in one of two ways, either as a % vector signal or as a composite signal, based on the size and shape of % the signals bundled into the bus signal.  % % To understand this better, display the signal dimensions % by checking the *Signal Dimensions* item in the *Port/Signal Displays* % submenu of the Simulink diagram's *Format* menu. You should notice that the % label "5{5}" appears on the bus signal, as shown below.    %% close_system('sldemo_help_show_bus.mdl',0);  %% open_system('sldemo_help_show_bus.mdl'); set_param(gcs,'ShowLineDimensions','on'); set_param(gcs,'SimulationCommand','update');  %% close_system('sldemo_help_show_bus.mdl',0);  %% % The number before the braces tells you how many lines were bundled % together to create that particular bus signal. For example, the output of % the Bus Creator2 block was created from the three lines from the Clock, % Pulse, and Sine Wave blocks. The number inside of the braces tells you % how many total signals are contained in the bus. In the case of the bus2 % signal, each output from the Source blocks is a scalar, so the bus % contains a total of three signals, one from each line. % % All the bus signal in this model are treated like vector signals because % each individual signal in the bus is a scalar. As such, you can pass the % bus signal into any Simulink block that accepts vector inputs, such as a % Gain, Sum, Integer, etc. % % Bus signals are also treated as vector signals when all the individual % signals in the bus are either scalars or 1-dimensional vectors, as you % will see below.  %% close_system('busdemo', 0)  %% Vector signals in Simulink %  % You can change the Sine Wave block to output a vector of signals, instead % of a scalar.   open_system('busdemo') hilite_system('busdemo/Sine Wave','find');  %% % To do this, first open the Sine Wave block by double % clicking on the block in the diagram. This opens the Block Parameters % dialog associated with the Sine Wave block. %  %% % The first field in the Block Parameters dialog is *Amplitude*. You can % change the value in this field to a vector, using the following commands. %  close_system('busdemo', 0)  %% % 1 Type [1 2] into the Amplitude field. % % 2 Apply the changes and close the dialog by clicking the *OK* button.  % % 3 Update the Simulink diagram by selecting the *Update Diagram* command % from the model's *Edit* menu.   %% open_system('busdemo') set_param('busdemo/Sine Wave','Amplitude','[1 2]'); set_param('busdemo','ShowLineDimensions','on'); set_param('busdemo','SimulationCommand','update');  %% % The line coming out of the Sine Wave block now has a "2" above it, % indicating that it carries a vector, or 1-dimensional, signal with two % elements. Notice, now, that the input signal to the Bus Selector block is % labeled with "5{6}". The 5 before the braces tells you that there are % still five signals bundled together in the bus signal. Since one of these % signals is a vector with two elements, the total width of the bus signal % is now six, the value inside the braces.  % % The bus signal is still treated as a vector and can be passed to any % Simulink block that accepts vector signals. In fact, as long as the bus % signal consists solely of scalars and 1-dimensional vectors, it will be % treated as a vector signal. As you will soon see, there is one more % condition on when bus signals are treated as vectors.  %% close_system('busdemo', 0)  %% Row and column matrix signals in Simulink %  % By default, the signals in your Simulink diagram are 1-dimensional % vectors. You can, however, introduce 2-dimensional matrices into your % diagram. To demonstrate this, change the Sine Wave block so it outputs a % matrix signal instead of the vector you previously entered. % % To do this open Sine Wave block by double clicking on the block.  At the % bottom of the dialog (and on the bottom of *all* Source block dialogs) % you will see the *Interpret vector parameters as 1-D* check box.  % % * When this box is checked, Simulink interprets any row or column vector you type into the Block Parameters dialog as a 1-dimensional array.  % * When this box is not checked, Simulink interprets any row or column vector you type into the Block Parameters dialog as a 2-dimensional matrix. *Note:* If you are working in this mode, then all the vectors and matrices you enter into the Block Parameters dialog must have consistent dimensions. % % To illustrate this, make the output of the Sine Wave 2-dimensional using % the following steps. % % 1. Uncheck the *Interpret vector parameters as 1-D* check box  % % 2. Apply the changes and close the dialog by clicking the *OK* button. % % 3. Update the Simulink diagram to see the changes take effect in the % signal dimension labels.    open_system('busdemo') set_param('busdemo/Sine Wave','Amplitude','[1 2]'); set_param('busdemo','ShowLineDimensions','on'); set_param('busdemo/Sine Wave','VectorParams1D','off'); set_param('busdemo','WideLines','on'); set_param('busdemo','SimulationCommand','update');   %% % Notice that the output signal of the Sine Wave block is now labeled % "[1x2]". Simulink is actually carrying a 2-D matrix signal along that % line!  The input signal to the Bus Selector block is still labeled with % "5{6}" as it contains five signals with a total of six elements. In this % case, however, the fifth signal in the bus is actually a row matrix. % % This is the final case where the bus signal is treated as a vector; when % all signals in the bus are either scalars, 1-dimensional vectors, or % either row or column matrices. If the bus contains both row and column % matrix signals then the bus signal is no longer a vector signal. Instead, % it is treated as a composite signal, discussed in a moment.  %% close_system('busdemo', 0)  %% Matrix signals in Simulink % % You can enter any 2-dimensional matrix into the Source blocks. For % example, to enter a 2x2 matrix open the Sine Wave block dialog, enter  % [1 2; 3 4] in the *Amplitude* parameter, and update the diagram.   open_system('busdemo') set_param('busdemo','ShowLineDimensions','on'); set_param('busdemo','WideLines','on'); set_param('busdemo/Sine Wave','Amplitude','[1 2; 3 4]'); set_param('busdemo','SimulationCommand','update');  %% % The signal coming out of the Sine Wave block now has the dimensions [2x2]. % % *Note:* When you enter an m-by-n matrix where neither m nor n is one, the % block's output will always be a matrix regardless of the current state of % the *Interpret vector parameters as 1-D* check box. The check box *only* % applies to vector parameters, where either m or n is one. % % The signal going into the Bus Selector is now labeled with "5{8}". It % contains 5 signals, but one of those signals has four elements for a % total width of eight. In this case, the bus signal is treated as a % composite signal. In fact, as soon as any of the signals in the bus % contain a 2-dimensional signal that is neither a row nor column matrix, % the bus signal is automatically treated as a composite signal. % % A composite signal is useful for bundling data into a single wire to pass % through the Simulink diagram. However, a composite signal cannot be % passed into most Simulink blocks. In fact, composite signals can only be % passed into virtual blocks, such as the Bus Selector, Subsystem, Goto, % Demux, etc.  % % To summarize, a bus signal is treated as a composite signal when either % of the following conditions is met.  % % 1. The bus contains a signal that is a row matrix and another signal that % is a column matrix. % % 2. The bus contains one or more [m x n] matrices where both m and n are % greater than one. % %% close_system('busdemo', 0)  %% Using the Bus Creator Block % % To understand more about how the bus signal is structured, open the Bus % Creator block.  open_system('busdemo')  set_param('busdemo','ShowLineDimensions','on'); set_param('busdemo','WideLines','on'); set_param('busdemo/Sine Wave','Amplitude','[1 2; 3 4]'); set_param('busdemo','SimulationCommand','update'); hilite_system(['busdemo/Bus',char(32),'Creator'],'find')          %% % This block has two inputs, each of which is itself a bus % signal. The two bus signals, labeled bus1 and bus2, are listed in the % *Signals in bus* list, preceded by a plus sign. If you expand out the two % bus signals by double-clicking in each top level node in the tree, you'll % see the nested signals that make up the final bus.  %% close_system('busdemo', 0)  %% % The names used in the *Signals in bus* list are inherited from the signal % names typed onto the Simulink diagram. If you want to locate the block a % particular signal originated from, you can do the following. % % 1. Select, for example, the Pulse signal in the bus2 node.  % % 2. Press the Find button to the right of the *Signals in bus* list.  % % 3. Note that the Pulse Generator block is now highlighted.  %  %% open_system('busdemo') set_param('busdemo','ShowLineDimensions','on'); set_param('busdemo','WideLines','on'); set_param('busdemo/Sine Wave','Amplitude','[1 2; 3 4]'); set_param('busdemo','SimulationCommand','update'); hilite_system(['busdemo/Pulse',char(32),'Generator'],'find')   %% % The Bus Creator uses the signal name to determine the source of a % particular signal in the bus  %% close_system('busdemo', 0)  %% Using the Bus Selector Block % % As the signal label indicates, the output of the Bus Creator block still % consists of five signals, where the last element is the 2x2 matrix signal % you previously entered. To illustrate this, you can configure the Bus % Selector block to output the matrix signal from the Sine Wave block. To % do this, first open the Bus Selector block by double clicking on the block.   %% open_system('busdemo') set_param('busdemo','ShowLineDimensions','on'); set_param('busdemo','WideLines','on'); set_param('busdemo/Sine Wave','Amplitude','[1 2; 3 4]'); set_param('busdemo','SimulationCommand','update'); hilite_system(['busdemo/Bus',char(32),'Selector'],'find')  %% % * On the left side of this dialog, you see a list of all the signals passed into the Bus Selector block. You can click on the tree corresponding to a bus to see the source signals that the bus is composed of. The output signal of the Bus Creator is in turn composed of the two bus signals bus1 and bus2.  % * On the right side, you see "Selected Signals" - a list of all the input signals that are to serve as the output for the Bus Selector block. To reference a signal corresponding to a specific input bus, use the dot-notation. For example, to access the Chirp input signal from bus1, use bus1.Chirp. % % The following steps illustrate how you can specify the output signal list % to correspond to the Pulse Generator and Sine Wave sources. % % 1. Highlight the bus1.Chirp signal in the *Selected signals* list and % remove it by selecting Remove to the left of the list.  % % 2. Highlight the bus2.Sine signal in the *Signals in the bus* list and add it % to the *Selected signals* by choosing *Select>>*. % % 3. Apply these changes and close the dialog by selecting *OK*.   %% open_system(find_system('busdemo','BlockType','BusSelector')); busSelectorDlgObj = FindDdgDlgInDAStudioRootFromFullBlkPath('busdemo/Bus Selector'); busSelectorDlgObj.setWidgetValue('outputsList',1); busSelectorddg_cb(busSelectorDlgObj,'doRemove'); busSelectorDlgObj.setWidgetValue('outputsList',0); busSelectorDlgObj.setWidgetValue('inputsTree',''); busSelectorDlgObj.setWidgetValue('inputsTree',''); busSelectorDlgObj.setWidgetValue('inputsTree','bus2/Sine'); busSelectorddg_cb(busSelectorDlgObj,'doSelect'); busSelectorDlgObj.apply; close_system('busdemo/Bus Selector');          %% % Now, run the simulation. The bottom axis on the Scope displays the four % signals from the Sine Wave block.  %% sim('busdemo');   % % *Note:* The labels for the signal name and signal dimension may overlap on % the bottom line feeding into the Scope block. If this is the case, just % hold the left mouse button down on the signal name while dragging it to % another location on the line. Then, you should see that a [2x2] signal % feeds into the second input.  %% Interesting Feature: HILITE_SYSTEM % % Various blocks in the Simulink diagram highlighted when you clicked some % of the links in this demonstration. This was done using the  % hilite_system function. The syntax is hilite_system(sys) where sys is the % name of the block you want to highlight. There are a variety of different % highlighting schemes, which you can find by looking at the help text for % this command. Here are a few samples that highlight the Sine Wave block. % % * <matlab:busdemo;hilite_system(['busdemo/Sine',char(32),'Wave'],'find'); hilite_system('busdemo/Sine Wave','find')>  Uses the highlighting scheme used by the Find dialog, which changes the background color.  % * <matlab:busdemo;hilite_system(['busdemo/Sine',char(32),'Wave'],'unique'); hilite_system('busdemo/Sine Wave','unique')>  Uses a highlighting scheme that changes the foreground color.  % * <matlab:busdemo;hilite_system(['busdemo/Sine',char(32),'Wave'],'none'); hilite_system('busdemo/Sine Wave','none')>  Removes any highlighting.  %  %% close_system('busdemo',0);    ##### SOURCE END ##### --></body></html>