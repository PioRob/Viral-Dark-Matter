
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>2 進小数点スケーリング</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="fiscalingdemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit fiscalingdemo">エディターで fiscalingdemo.m を開く</a></div><div class="right"><a href="matlab:echodemo fiscalingdemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>2 進小数点スケーリング</h1><!--introduction--><p>このデモでは、FI における 2 進小数点スケーリングについて説明します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">FI 構築</a></li><li><a href="#2">2 進小数点の小数部の長さと位置</a></li><li><a href="#3">小数部の長さが正で語長より短い場合</a></li><li><a href="#4">小数部の長さが正で語長より長い場合</a></li><li><a href="#5">小数部の長さが負の整数で語長より短い場合</a></li><li><a href="#6">小数部の長さは最適な精度で自動的に設定され負である</a></li><li><a href="#7">対話型 FI 2 進小数点スケーリングのデモ</a></li></ul></div><h2>FI 構築<a name="1"></a></h2><p><tt>a = fi(v,s,w,f)</tt> は、値 <tt>v</tt>、符号付き/なし <tt>s</tt>、語長 <tt>w</tt>、小数部の長さ <tt>f</tt> の <tt>fi </tt>を返します。</p><p><tt>s</tt> が true (符号付き) の場合、結果の fi の先行または上位ビット (MSB) は常に符号ビットです。</p><p>小数部の長さ <tt>f</tt> はスケーリング <tt>2^(-f)</tt> です。</p><p>たとえば、値 0.5 と スケーリング 2^(-7) の符号付き 8 ビット長 <tt>fi</tt> を作成します: </p><pre class="codeinput">a = fi(0.5,true,8,7)
</pre><pre class="codeoutput"> 
a =
 
                       0.5

          DataTypeMode: Fixed-point: binary point scaling
            Signedness: Signed
            WordLength: 8
        FractionLength: 7
</pre><h2>2 進小数点の小数部の長さと位置<a name="2"></a></h2><p>小数部の長さまたはスケーリングによって <tt>fi</tt> オブジェクト内の 2 進小数点の位置が決まります。</p><h2>小数部の長さが正で語長より短い場合<a name="3"></a></h2><p>小数部の長さ <tt>f</tt> が正で語長より短い場合、2 進小数点は最下位ビット (LSB) の <tt>f</tt> だけ左側かつワード内にあります。</p><p>たとえば、小数部の長さが 1 で値が -0.5 の符号付き 3 ビット <tt>fi</tt> では、2 進小数点は LSB の 1 つ左側にあります。この場合、各ビットは <tt>1</tt> に設定されて、2 進小数点の <tt>fi</tt> の 2 進等価は、<tt>11.1</tt> となります。</p><p>-0.5 の実際の値は、LSB から符号付き MSB までのスケーリング ファクターで各ビットを乗算することによって得られます。</p><p><tt>(1*2^-1) + (1*2^0) +(-1*2^1) = -0.5</tt></p><p><tt>int(a)</tt> は、格納された符号付きのスケールなし整数値 <tt>-1</tt> を返します。</p><p><tt>(1*2^0) + (1*2^1) +(-1*2^2) = -1</tt></p><pre class="codeinput">a = fi(-0.5,true,3,1)
bin(a)
int(a)
</pre><pre class="codeoutput"> 
a =
 
                      -0.5

          DataTypeMode: Fixed-point: binary point scaling
            Signedness: Signed
            WordLength: 3
        FractionLength: 1

ans =

111


ans =

   -1

</pre><h2>小数部の長さが正で語長より長い場合<a name="4"></a></h2><p>小数部の長さ <tt>f</tt> が正で語長より長い場合、2 進小数点は LSB の <tt>f</tt> だけ左側かつワードの外にあります。</p><p>たとえば、小数部の長さが 4 で値が -0.0625 の符号付き 3 ビットワードの 2 進数表現は <tt>._111</tt> です。ここで、<tt>._111</tt> の <tt>_</tt> は 3 ビットワードの一部ではない未使用ビットを示します。<tt>_</tt> の直後の <tt>1</tt> は MSB または符号ビットです。</p><p>実際の値 -0.0625 は、以下のように計算されます (LSB ～ MSB)。</p><p><tt>(1*2^-4) + (1*2^-3) + (-1*2^-2) = -0.0625</tt></p><p>bin(b) は、MATLAB&reg; プロンプトと <tt>int(b) = -1</tt> で <tt>111</tt> を返します。</p><pre class="codeinput">b = fi(-0.0625,true,3,4)
bin(b)
int(b)
</pre><pre class="codeoutput"> 
b =
 
                   -0.0625

          DataTypeMode: Fixed-point: binary point scaling
            Signedness: Signed
            WordLength: 3
        FractionLength: 4

ans =

111


ans =

   -1

</pre><h2>小数部の長さが負の整数で語長より短い場合<a name="5"></a></h2><p>小数部の長さ <tt>f</tt> が負の場合、2 進小数点は LSB の <tt>f</tt> だけ右側かつ物理的ワードの外にあります。</p><p>たとえば、<tt>c = fi(-4,true,3,-2)</tt> では、2 進小数点は LSB <tt>111__.</tt> の 2 つ右側にあります。ここでは、右端にある 2 つのスペースは、3 ビット ワードの一部ではない未使用ビットです。右端にある <tt>1</tt> は LSB で、先行する <tt>1</tt> は符号ビットです。</p><p>-4 の実際の値は、スケーリング ファクター <tt>2^(-f)</tt> で、たとえば LSB では <tt>2(-(-2)) = 2^(2)</tt> で各ビットを乗算して、積を加算することによって得られます。</p><p><tt>(1*2^2) + (1*2^3) +(-1*2^4) = -4</tt></p><p>前述の 2 つの例のように、<tt>bin(c)</tt> と <tt>int(c)</tt> は <tt>111</tt> と <tt>-1</tt> を出力します。</p><pre class="codeinput">c = fi(-4,true,3,-2)
bin(c)
int(c)
</pre><pre class="codeoutput"> 
c =
 
    -4

          DataTypeMode: Fixed-point: binary point scaling
            Signedness: Signed
            WordLength: 3
        FractionLength: -2

ans =

111


ans =

   -1

</pre><h2>小数部の長さは最適な精度で自動的に設定され負である<a name="6"></a></h2><p>この例では、<tt>fi</tt> が含むべき値によって小数部の長さが自動的に設定される符号付き 3 ビット <tt>fi</tt> を作成します。最終的な <tt>fi</tt> は、語長が 3 ビットで小数部の長さが -1 の値 6 をもちます。ここで、2 進小数点は、LSB の 1 つ右側で、<tt>011_.</tt> です。<tt>_</tt> はまた未使用ビットで、<tt>_</tt> の直前の <tt>1</tt> が LSB です。先行する <tt>1</tt> は符号ビットです。</p><p>実際の値 (6) は、以下のようにして求められます。</p><p><tt>(1*2^1) + (1*2^2) + (-0*2^3) = 6</tt></p><p><tt>bin(d)</tt> は <tt>011</tt> を出力し、<tt>int(d)</tt> は <tt>3</tt> を出力します。</p><pre class="codeinput">d = fi(5,true,3)
bin(d)
int(d)
</pre><pre class="codeoutput"> 
d =
 
     6

          DataTypeMode: Fixed-point: binary point scaling
            Signedness: Signed
            WordLength: 3
        FractionLength: -1

ans =

011


ans =

    3

</pre><h2>対話型 FI 2 進小数点スケーリングのデモ<a name="7"></a></h2><p>これは、ユーザーがスライダーを使用して 2 進小数点を移動することによって 3 ビット固定小数点数の小数部の長さを変更できるようにする対話型デモです。小数部の長さは -3 ～ 5 で変更でき、ユーザーは、符号付き数か符号なし数のいずれかに対して 3 ビットの値を 0 または 1 に変更できます。</p><p>3 ビットの上にある「スケーリング ファクター」は、指定された符号付き/なしと小数部の長さに対して各ビットが与えられたスケーリングまたは重みを表示します。<tt>fi</tt> コード、倍精度の実際値と固定小数点の属性も表示されます。</p><p>このデモを開始するには、MATLAB プロンプトで fibinscaling と入力してください。</p><p class="footer">Copyright 1999-2007 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Binary-Point Scaling % This demo explains binary point scaling in FI. % % Copyright 1999-2007 The MathWorks, Inc. % $Revision: 1.1.4.2.2.1 $  %% FI Construction % |a = fi(v,s,w,f)| returns a |fi| with value |v|, signedness |s|, word length |w|, % and fraction length |f|. % % If |s| is true (signed) the leading or most significant bit (MSB) in the % resulting fi is always the sign bit. % % Fraction length |f| is the scaling |2^(-f)|. % % For example, create a signed 8-bit long |fi| with a value of 0.5 and a % scaling of 2^(-7): % a = fi(0.5,true,8,7)  %% Fraction Length and the Position of the Binary Point % The fraction length or the scaling determines the position of the binary % point in the |fi| object.  %% The Fraction Length is Positive and Less than the Word Length % When the fraction length |f| is positive and less than the word length, the % binary point lies |f| places to the left of the least significant bit (LSB) % and within the word. % % For example, in a signed 3-bit |fi| with fraction length of 1 and value % -0.5, the binary point lies 1 place to the left of the LSB. In this case % each bit is set to |1| and the binary equivalent of the |fi| with its binary % point is |11.1| . % % The real world value of -0.5 is obtained by multiplying each bit by its  % scaling factor, starting with the LSB and working up to the signed MSB. % % |(1*2^-1) + (1*2^0) +(-1*2^1) = -0.5| % % |int(a)| returns the stored signed, unscaled integer value |-1|. % % |(1*2^0) + (1*2^1) +(-1*2^2) = -1| % a = fi(-0.5,true,3,1) bin(a) int(a)  %% The Fraction Length is Positive and Greater than the Word Length % When the fraction length |f| is positive and greater than the word % length, the binary point lies |f| places to the left of the LSB and outside % the word. % % For example the binary equivalent of a signed 3-bit word with fraction % length of 4 and value of -0.0625 is |._111| % Here |_| in the |._111| denotes an unused bit that is not a part of the % 3-bit word. The first |1| after the |_| is the MSB or the sign bit. % % The real world value of -0.0625 is computed as follows (LSB to MSB). % % |(1*2^-4) + (1*2^-3) + (-1*2^-2) = -0.0625| % % bin(b) will return |111| at the MATLAB(R) prompt and |int(b) = -1|  b = fi(-0.0625,true,3,4) bin(b) int(b)  %% The Fraction Length is a Negative Integer and Less than the Word Length % When the fraction length |f| is negative the binary point lies |f| places to % the right of LSB and is outside the physical word. % % For instance in |c = fi(-4,true,3,-2)| the binary point lies 2 places to % the right of the LSB |111__.|. Here the two right most spaces are unused bits % that are not part of the 3-bit word. The right most |1| is the LSB and the  % leading |1| is the sign bit. % % The real world value of -4 is obtained by multiplying each bit by its % scaling factor |2^(-f)|,  i.e. |2(-(-2)) = 2^(2)| for the LSB, and then % adding the products together. % % |(1*2^2) + (1*2^3) +(-1*2^4) = -4| % % |bin(c)| and |int(c)| will still give |111| and |-1| as in the previous two % examples.  c = fi(-4,true,3,-2) bin(c) int(c)  %% The Fraction Length is Set Automatically to the Best Precision Possible and is Negative % In this example we create a signed 3-bit |fi| where the fraction length is set automatically % depending on the value that the |fi| is supposed to contain. The resulting |fi| has a % value of 6, with a wordlength of 3 bits and a fraction length of -1. % Here the binary point is 1 place to the right of the LSB: |011_.|. % The |_| is again an unused bit and the first |1| before the |_| is the % LSB. The leading |1| is the sign bit. % % The real world value (6) is obtained as follows: % % |(1*2^1) + (1*2^2) + (-0*2^3) = 6| % % |bin(d)| and |int(d)| will give |011| and |3| respectively.  d = fi(5,true,3) bin(d) int(d)  %% Interactive FI Binary Point Scaling Demo % This is an interactive demo that allows the user to change the fraction % length of a 3-bit fixed-point number by moving the binary point using a % slider. The fraction length can be varied from -3 to 5 and the user can  % change the value of the 3 bits to '0' or '1' for either signed or % unsigned numbers. % % The "Scaling factors" above the 3 bits display the scaling or weight that % each bit is given for the specified signedness and fraction length. % The |fi| code, the double precision real-world value and the fixed-point % attributes are also displayed. % % Type fibinscaling at the MATLAB prompt to run this demo.   displayEndOfDemoMessage(mfilename) ##### SOURCE END ##### --></body></html>