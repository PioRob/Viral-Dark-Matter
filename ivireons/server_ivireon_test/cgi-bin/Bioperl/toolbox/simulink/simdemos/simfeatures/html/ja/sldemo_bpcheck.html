
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>Prelookup ブロックと Interpolation ブロックの使用</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="sldemo_bpcheck.m"><link rel="stylesheet" type="text/css" href="../../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">sldemo_bpcheck.mdl</div><div class="right"><a href="matlab:sldemo_bpcheck">このモデルを開く</a></div></div><div class="content"><h1>Prelookup ブロックと Interpolation ブロックの使用</h1><!--introduction--><p>Prelookup ブロックを使用すると、ルックアップ テーブルのセット内で実行されるインデックス検索の数を最小限に抑え、1 つのテーブル計算の中に、クリッピング アルゴリズム、外挿アルゴリズムおよびインデックス検索アルゴリズムを混在させることができます。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">はじめに</a></li><li><a href="#4">最適化:PreLookup ブロックと Interpolation Using Prelookup ブロック</a></li><li><a href="#6">最適化:Interpolation Using Prelookup ブロック内の [サブテーブル選択] オプション</a></li><li><a href="#10">ブレークポイント データとテーブル データの整合性チェック</a></li></ul></div><h2>はじめに<a name="1"></a></h2><p>このモデルでは、Prelookup ブロックと Interpolation Using Prelookup ブロックを使用します。Prelookup ブロックが計算のインデックス検索部分をどのように実行するか、また、Interpolation Using Prelookup ブロックが残りの部分をどのように実行するかを確認してください。</p><p><a href="matlab:open_system('sldemo_bpcheck')">モデルを開く</a></p><img vspace="5" hspace="5" src="../sldemo_bpcheck_01.png" alt=""> <p>これらのブロックは、Simulink&reg; Block ライブラリ内の Lookup Tables サブライブラリにあります。</p><img vspace="5" hspace="5" src="../sldemo_bpcheck_02.png" alt=""> <h2>最適化:PreLookup ブロックと Interpolation Using Prelookup ブロック<a name="4"></a></h2><p>ブレークポイント セットに集中型のインデックス検索が設定されているテーブルについては、PreLookup ブロックを使用することを考慮する必要があります。Prelookup ブロックを使用すると、インデックス検索を 1 回実行し、その結果を多くのテーブル ルックアップで再利用することができます。このモデルでは、3 つのインデックス検索の結果が 5 つのブロックで、合計 10 回使用されます。右側の例のような同等の標準的なルックアップ テーブルには、3 つではなく 10 のインデックス検索が必要となります。</p><img vspace="5" hspace="5" src="../sldemo_bpcheck_03.png" alt=""> <h2>最適化:Interpolation Using Prelookup ブロック内の [サブテーブル選択] オプション<a name="6"></a></h2><p>このモデルの Interpolation ブロックの 1 つは、n 次元のテーブルの展開次元を「選択次元」としてマークできるという機能を使用して設定されます。つまり、その次元の入力は、サブテーブル選択をする (たとえば、3 次元のテーブルから 2 次元の平面を選択するなど) ためにのみ使用される整数ということです。その後、サブテーブルは通常の方法で内挿されます。</p><p>サブテーブルを内挿することによって、莫大な量の計算を省くことができます。内挿から次元が1つ削除されるごとに、計算量はほぼ半減します。N 次元内挿では、(2^N)-1 回の個別の内挿演算 (y? = ylow + f*(yhigh-ylow)) を行う必要があるため、選択次元が 1 次元だけでも、内挿の速度をほぼ 2 倍にすることができます。極端な例として、サブテーブル選択が 3 次元で、2 次元の内挿を使用する 5 次元のテーブルの場合、5 次元の内挿では 2^5-1 = 31 回の内挿を行う必要がありますが、2 次元の内挿では、2^2 - 1 = 3 回だけで済みます。</p><p>選択端子は、単一のブロック内で複数のサブテーブル選択/内挿が可能になるように、ベクトル化機能をサポートしています。</p><img vspace="5" hspace="5" src="../sldemo_bpcheck_04.png" alt=""> <p>サブテーブル演算モードまたは複数テーブル演算モードは、ブロックの [パラメーター] ダイアログの [サブテーブル選択次元数] パラメーターに正の整数を設定すると、アクティブ化されます。設定した数値は、最高次元から選択する次元数として解釈されます。たとえば、3 次元のテーブルがある場合に 2 を選択すると、最初の次元が内挿され、次元 2 および 次元 3 が選択されます。</p><p>メモ:[強調表示の表示/削除] メニュー項目または以下のコマンドを使用して、モデルから強調表示を削除できます。</p><pre> set_param(mdl,'HiliteAncestors','none')</pre><h2>ブレークポイント データとテーブル データの整合性チェック<a name="10"></a></h2><p>Prelookup ブロックと Interpolation Using Prelookup ブロックを使用する場合は、Prelookup ブロックの [ブレークポイント データ] パラメーターの長さが、接続されている Interpolation Using Prelookup ブロックの [テーブル データ] パラメーターの対応する次元と一致していることを確認する必要があります。Simulink は、ブロック線図の更新時には、必ずこの 2 つのブロック間の整合性をチェックします。Simulink は、矛盾しているブレークポイント データとテーブル データがあれば、エラーを報告します。以下に例を示します。</p><pre> <pre> try
     evalc(['sim(', mdl, ')']);
 catch E
     disp(['Error:', E.message]);
 end</pre><pre class="codeoutput">Error:The range of values for input port k2 of block 'sldemo_bpcheck/Interpolation on an 11x11 table ERROR IN DIM 2 ' does not match the size of the corresponding table dimension.
</pre><p class="footer">Copyright 1990-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Using the Prelookup and Interpolation Blocks % The Prelookup block allows you to minimize the number of index  % searches performed across a set of look-up tables and also  % to mix clipping, extrapolation, and index search algorithms within  % one table calculation.   %  %   Copyright 1990-2009 The MathWorks, Inc. %   $Revision: 1.1.4.9.2.1 $  $Date: 2010/07/29 21:29:14 $  %% Introduction  % This model uses Prelookup and Interpolation Using Prelookup blocks. Note how  % the Prelookup blocks perform the index search portion of the computation  % and the Interpolation Using Prelookup blocks perform the rest: % % <matlab:open_system('sldemo_bpcheck') Open the model> mdl = 'sldemo_bpcheck'; open_system(mdl)  %%  close_system(mdl)  %% % These blocks can be found in the Simulink(R) block library in % the Lookup Tables sub-library:  open_system('simulink') open_system(sprintf('simulink/Lookup\nTables'),'simulink','replace') hilite_system([ gcs, sprintf('/Prelookup')], 'different') hilite_system([ gcs, sprintf('/Interpolation\nUsing Prelookup')], 'different')  %% Optimization: PreLookup + Interpolation Using Prelookup Blocks % Use of the PreLookup block should be considered for tables with  % intensive index searches in breakpoint sets.  The Prelookup blocks  % allow you to perform an index search once and reuse the  % result in many table lookups.  In this model, 3 index search results  % are used in 5 blocks in a total of 10 uses.  Equivalent regular lookup  % tables such as the example to the right would have required 10 index  % searches instead of 3.  open_system(mdl) preblks = find_system('sldemo_bpcheck','BlockType','PreLookup'); for k=1:length(preblks)     hilite_system( preblks{k}, 'different' ); end  %%  close_system(mdl) close_system('simulink')  %% Optimization: Sub-table selection option in the Interpolation Using Prelookup Blocks % One of the Interpolation blocks in this model is configured using % a capability: trailing dimensions of an n-D table can be marked as  % "selection dimensions", meaning that the input for that dimension is  % an integer used only to make a sub-table selection, such as picking  % a 2-D plane from a 3-D table.  The sub-table is then interpolated  % normally. % % Interpolation of sub-tables can save tremendous amounts of computation. % For every dimension eliminated from interpolation, the computation  % almost halves.  Since an N-dimensional interpolation takes (2^N)-1 % individual interpolation operations (y? = ylow + f*(yhigh-ylow)), even  % just one dimension of selection can almost double the speed of the  % interpolation. Extreme example: a 5-D table with 3 dimensions of  % sub-table selection and 2-D interpolation: 5-D interpolation would  % take 2^5-1 = 31 interpolations, but a 2-D interpolation takes  % only 2^2 - 1 = 3. % % The selection ports support vectorization to allow multiple sub-table  % selection / interpolations in a single block.   open_system(mdl) subblk = find_system('sldemo_bpcheck', ...                       'BlockType',         'Interpolation_n-D',...                       'NumSelectionDims', '1' ); hilite_system( subblk{1}, 'different' );  %% % The sub-table or multi-table mode of operation is activated by setting % a positive integer for the Number of sub-table selections dimensions  % parameter in the block's parameter dialog.  The number you set is  % interpreted as the number of dimensions to select from the highest % dimensions.  For example, if you have a 3-D table and choose 2, that % means the first dimension will be interpolated and dimensions 2 and 3 % will be selected:  open_system( subblk{1} )  %%  close_system( subblk{1} )  %% % NOTE: you can remove highlighting from a model using  % the View / Remove highlighting menu item or this command: % %   set_param(mdl,'HiliteAncestors','none') set_param(mdl,'HiliteAncestors','none')  %% Breakpoint and Table Data Consistency Checking % % Using Prelookup and Interpolation Using Prelookup blocks introduces a need to ensure  % that the length of the 'Breakpoint data' parameter in the Prelookup blocks matches the  % corresponding dimension of the 'Table data' parameter in the connected Interpolation Using % Prelookup blocks. Simulink always checks the consistency between the two blocks when updating  % the block diagram. Simulink reports errors if it encounters inconsistent breakpoint and  % table data. For example: %  %   try %       evalc(['sim(', mdl, ')']); %   catch E %       disp(['Error:', E.message]); %   end % try     evalc(['sim(', mdl, ')']); catch E     disp(['Error:', E.message]); end   displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>