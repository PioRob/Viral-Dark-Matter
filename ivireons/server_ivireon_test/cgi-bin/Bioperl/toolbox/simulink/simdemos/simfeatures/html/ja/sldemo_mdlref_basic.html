
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>モデル参照によるコンポーネントベースのモデル化</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="sldemo_mdlref_basic.m"><link rel="stylesheet" type="text/css" href="../../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left">sldemo_mdlref_basic.mdl</div><div class="right"><a href="matlab:sldemo_mdlref_basic">このモデルを開く</a></div></div><div class="content"><h1>モデル参照によるコンポーネントベースのモデル化</h1><!--introduction--><p>このデモでは、基本的なモデル参照の概念を紹介します。別のモデルを複数回参照するモデルのシミュレーションと Real-Time Workshop&reg; コード生成について詳しく説明します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">デモの要件</a></li><li><a href="#2">モデル参照について</a></li><li><a href="#3">シミュレーション モード</a></li><li><a href="#7">コード生成を介したシミュレーション (Real-Time Workshop&reg; が不要)</a></li><li><a href="#8">スタンドアロン アプリケーションに対するコード生成 (Real-Time Workshop が必要)</a></li><li><a href="#9">インクリメンタル ロードのデモ</a></li></ul></div><h2>デモの要件<a name="1"></a></h2><p>このデモ中に、Simulink&reg; と Real-Time Workshop は、現在の作業ディレクトリ内に作成された Simulink プロジェクト ディレクトリにコードを生成します。このディレクトリ内にファイルを生成したくない (または生成できない) 場合は、作業ディレクトリを変更してください。</p><p>スタンドアロン アプリケーションで配布されるようにするために、Real-Time Workshop でモデル参照の Real-Time Workshop ターゲットが生成される必要があります。</p><p>デモ モデルを変更する予定がある場合は、以下の手順に従います。</p><p>1. 以下のファイルを、名前を変更することなく、MATLAB&reg; インストール ディレクトリから他のディレクトリにコピーすることで、デモを元の状態で保存しておきます。</p><pre>toolbox/simulink/simdemos/simfeatures/sldemo_mdlref_basic.mdl
toolbox/simulink/simdemos/simfeatures/sldemo_mdlref_counter.mdl</pre><p>2. 現在の作業ディレクトリを、これらのファイルをコピーしたディレクトリに変更します。</p><p>3. デモを続行します。</p><h2>モデル参照について<a name="2"></a></h2><p>デモ モデル <a href="matlab:open_system('sldemo_mdlref_basic')"><tt>sldemo_mdlref_basic</tt></a> を開きます。このモデルには、CounterA、CounterB、および CounterC という 3 つの Model ブロックが含まれています。これらのブロックは、同じモデル <tt>sldemo_mdlref_counter</tt> を参照します。これは別個のモデルで、<tt>sldemo_mdlref_basic</tt> のサブシステムではありません。</p><h2>シミュレーション モード<a name="3"></a></h2><p>Model ブロックには、参照モデルのシミュレーション方法を制御する、<b>SimulationMode</b> というパラメーターがあります。このパラメーターが <tt>Accelerator</tt> に設定されている場合、参照モデルのシミュレーションはコード生成を介して実行されます。このパラメーターが <tt>Normal</tt> に設定されている場合、参照モデルのシミュレーションは解釈されたモードで実行されます。このデモ モデルでは、Model ブロック CounterA と CounterB が <tt>sldemo_mdlref_counter</tt> をノーマル モードで参照します。このことを示すために、Model ブロック アイコンの四隅が白抜きになっています。他のインスタンス、CounterC は、<tt>sldemo_mdlref_counter</tt> をアクセラレータ モードで参照します。このことを示すために、Model ブロック アイコンの四隅が塗りつぶされています。ノーマル モードで複数回参照されるモデルの操作の詳細は、デモ <tt>sldemo_mdlref_depgraph</tt> を参照してください。</p><img vspace="5" hspace="5" src="../sldemo_mdlref_basic_01.png" alt=""> <p><b>図 1:</b> デモ モデル <tt>sldemo_mdlref_basic</tt></p><img vspace="5" hspace="5" src="../sldemo_mdlref_basic_02.png" alt=""> <p><b>図 2:</b> 参照モデル <tt>sldemo_mdlref_counter</tt></p><p>モデル参照には、サブシステムを使用する場合に比べ、以下のような利点があります。</p><div><ul><li>参照モデルが使用されるモデルとは別個に、参照モデルを開発できます。</li><li>1 つのモデルを別のモデルで何度でも参照できるため、余計なコピーの作成が不要です。</li><li>複数のモデルで同じモデルを参照できます。</li><li>インクリメンタル ロード機能<i></i>により、参照モデルは必要になるまで読み込まれません。インクリメンタル ロード機能により、モデルの読み込み処理が加速されます。</li><li>モデルがアクセラレータ モードで参照される場合、Simulink と Real-Time Workshop は、シミュレーションで使用する必要がある特別なバイナリを作成します。これらのバイナリが作成されてから参照モデルが変更されなかったため、バイナリが最新である場合、バイナリを使用するモデルのシミュレーションまたはコンパイルの際にコード生成は行われません。このことを、インクリメンタルなコード生成<i></i>と呼びます。バイナリを使用すると、シミュレーション速度が上がり、コード生成のモジュール性が向上します。</li><li>Model ブロックを含むモデル向けの Real-Time Workshop スタンドアロン アプリケーションを生成する際にも、インクリメンタルなコード生成を利用します。</li></ul></div><h2>コード生成を介したシミュレーション (Real-Time Workshop&reg; が不要)<a name="7"></a></h2><p>他のモデルをアクセラレータ モードで参照するモデルのシミュレーションには、固有の参照モデルそれぞれについて、シミュレーション ターゲットと呼ばれるバイナリ ファイルとコードの生成が必要です。この処理には、Real-Time Workshop は不要です。このデモでは、<tt>sldemo_mdlref_counter</tt> モデルに対するシミュレーション ターゲットがビルドされます。以下のいずれかのアクションでシミュレーション ターゲットを作成できます。</p><div><ul><li><tt>sldemo_mdlref_basic</tt> の更新</li><li><tt>sldemo_mdlref_basic</tt> のシミュレーション</li><li>以下のコマンドの発行</li></ul></div><p><a href="matlab:slbuild('sldemo_mdlref_counter','ModelReferenceSimTarget')"><tt>slbuild('sldemo_mdlref_counter','ModelReferenceSimTarget')</tt></a></p><p>備考:</p><div><ul><li>モデルがノーマル モードで参照される場合、その参照モデルに対してシミュレーション ターゲットはビルドされません。</li><li>シミュレーション ターゲットがビルドされた後にモデルのシミュレーションまたは更新を行っても、参照モデルが変更されていなければ、参照モデルのシミュレーション ターゲットは再ビルドされません。</li><li><tt>sldemo_mdlref_basic</tt> のサンプル時間の色分け表示をオンにしてください。Model ブロックがさまざまなサンプル時間を継承していることに注意してください。参照モデルでサンプル時間が明示的に指定されていない場合、Model ブロックはブロック自身のサンプル時間を継承します。</li></ul></div><h2>スタンドアロン アプリケーションに対するコード生成 (Real-Time Workshop が必要)<a name="8"></a></h2><p><tt>sldemo_mdlref_basic</tt> に対するスタンドアロン実行可能ファイルを作成するときに、<tt>sldemo_mdlref_counter</tt> の Real-Time Workshop ターゲットに対するコードとバイナリが最初に生成されます。必要な Real-Time Workshop ターゲットは、それが最新のものでない場合にビルドされます。<tt>sldemo_mdlref_counter</tt> に対する Real-Time Workshop ターゲットと <tt>sldemo_mdlref_basic</tt> に対するスタンドアロン実行可能ファイルを、以下のいずれかのアクションによってビルドできます。</p><div><ul><li><tt>sldemo_mdlref_basic</tt> に対するスタンドアロン実行可能ファイルのビルド</li><li><tt>sldemo_mdlref_counter</tt> のモデル参照ターゲットのビルドと、それに続く、<tt>sldemo_mdlref_basic</tt> に対するスタンドアロン実行可能ファイルのビルド</li></ul></div><p>備考:</p><div><ul><li><tt>sldemo_mdlref_counter</tt> の Real-Time Workshop ターゲットがビルドされた後に <tt>sldemo_mdlref_basic</tt> をビルドしても、<tt>sldemo_mdlref_counter</tt> が変化しなければ、<tt>sldemo_mdlref_counter</tt> は再ビルドされません (インクリメンタルなコード生成)。</li><li>参照モデル <tt>sldemo_mdlref_counter</tt> に対して生成されたコードが再使用されることに注意してください。</li><li><tt>sldemo_mdlref_basic</tt> に対して生成されたコードの HTML レポートには、以下の参照モデル セクションで <tt>sldemo_mdlref_counter</tt> に対して生成されたコードの HTML レポートへのリンクが含まれています。</li></ul></div><p><a href="matlab:slbuild('sldemo_mdlref_basic','StandaloneRTWTarget')">Build the Standalone Target and view the HTML report of the generated code</a></p><h2>インクリメンタル ロードのデモ<a name="9"></a></h2><p><tt>sldemo_mdlref_counter</tt> と <tt>sldemo_mdlref_basic</tt> を閉じ、<a href="matlab:open_system('sldemo_mdlref_basic')"><tt>sldemo_mdlref_basic</tt> を再び開きます</a>。MATLAB プロンプトで、以下のコマンドを発行します。</p><p><tt>find_system('type','block_diagram')</tt></p><p>読み込まれていないため、参照モデルは表示されません。Model ブロックを右クリックし、[モデルを開く] を選択します。MATLAB プロンプトで、以下のコマンドを発行します。</p><p><tt>find_system('type','block_diagram')</tt></p><p>参照モデルが表示され、インクリメンタル ロードの動作がわかります。</p><p class="footer">Copyright 1990-2010 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Component-Based Modeling with Model Reference % This demo introduces some basic Model Reference concepts. % It walks you through simulation and Real-Time Workshop(R) code generation of % a model that references another model multiple times.   % Copyright 1990-2010 The MathWorks, Inc. % $Revision: 1.1.4.9.2.1 $  $Date: 2010/07/29 21:29:17 $  %% Demo Requirements  % During this demo, Simulink(R) and Real-Time Workshop generate code % in a Simulink project directory created in the current working directory. % If you do not want to (or cannot) generate files in this % directory, you should change your working directory.  % % Real-Time Workshop is required to generate Model Reference Real-Time % Workshop target to be deployed in standalone applications.   %  % If you plan to alter the demo models: %  % 1. Preserve the demo in its original state by copying the following files % from your MATLAB(R) installation directory, without changing their names, to % a different directory:      % %  toolbox/simulink/simdemos/simfeatures/sldemo_mdlref_basic.mdl %  toolbox/simulink/simdemos/simfeatures/sldemo_mdlref_counter.mdl     % % 2. Change your current working directory to the directory to which you % copied the files % % 3. Continue with the demo  %% About Model Reference  % Open the demo model <matlab:open_system('sldemo_mdlref_basic') % |sldemo_mdlref_basic|>. This model contains three Model blocks: % CounterA, CounterB and CounterC. These blocks reference the same model, % |sldemo_mdlref_counter|, which is a separate model and % not a subsystem of |sldemo_mdlref_basic|.    %% Simulation Mode % The Model block has a parameter named *SimulationMode* that controls how the % referenced model is simulated.  If the parameter is set to |Accelerator|, the % referenced model is simulated through code generation.  If the parameter is % set to |Normal|, the referenced model is simulated in interpreted mode.  In % this demo model, the Model blocks CounterA and CounterB reference % |sldemo_mdlref_counter| in Normal mode, which is indicated by the hollow % corners on the Model block icon.  The other instances, CounterC, references % |sldemo_mdlref_counter| in Accelerator mode, which is indicated by the filled % corners on the Model block icon.  To learn more about interacting with models % that are referenced more than once in Normal mode, see the demo % |sldemo_mdlref_depgraph|. open_system('sldemo_mdlref_basic') %% % *Figure 1:* The demo model, |sldemo_mdlref_basic|  open_system('sldemo_mdlref_counter') %% % *Figure 2:* The referenced model, |sldemo_mdlref_counter|  %% % Model Reference has several advantages over subsystems:  % % * You can develop the referenced model independently from the models in % which it is used. % * You can reference a model multiple times in another model without % having to make redundant copies. % * Multiple models can reference a single model. % * The referenced model is not loaded until it is needed, a feature called % _Incremental Loading_. Incremental loading speeds up model load times. % * If a model is referenced in Accelerator mode, Simulink and Real-Time  % Workshop create special binaries to be used in simulations.  If the  % binaries are up-to-date, because the referenced model has not changed  % since the binaries were created, no code generation occurs when models  % that use these binaries are simulated or compiled. This is called  % _Incremental Code Generation_. The use of binaries increases simulation  % speed and modularity in code generation. % * Generating Real-Time Workshop standalone applications for a model with % Model blocks also takes advantage of incremental code generation.  %% Simulation Through Code Generation (Does not require Real-Time Workshop(R))  % Simulation of a model that references other models in Accelerator mode % requires the generation of code and a binary file called the Simulation  % Target for each unique referenced model. This process does not require  % Real-Time Workshop. For this demo, a simulation target is built  % for the |sldemo_mdlref_counter| model. You can create the Simulation  % Target by any of the following actions:   % % * Updating |sldemo_mdlref_basic| % * Simulating |sldemo_mdlref_basic| % * Issuing the command: % % <matlab:slbuild('sldemo_mdlref_counter','ModelReferenceSimTarget') % |slbuild('sldemo_mdlref_counter','ModelReferenceSimTarget')|>  % % Remarks: % % * If a model is referenced in Normal mode, the simulation target is not  % built for that referenced model. % * Once the simulation target is built, subsequently simulating or % updating the model does not trigger a rebuild of the referenced model's % simulation target unless the referenced model has changed.  % * Turn on the sample time colors for |sldemo_mdlref_basic|. Note that the % Model blocks have inherited different sample times. The Model Blocks inherit % their sample times if the referenced model does not explicitly specify a % sample time.    %% Code Generation for Standalone Applications (Requires Real-Time Workshop)  % When creating a standalone executable for |sldemo_mdlref_basic|, the % code and binaries for the Real-Time Workshop Target of % |sldemo_mdlref_counter| are first generated. The necessary Real-Time % Workshop Targets are built if they are not up-to-date. You can build the % Real-Time Workshop target for |sldemo_mdlref_counter| and the standalone % executable for |sldemo_mdlref_basic| by any of the following actions:    % % * Building the standalone executable for |sldemo_mdlref_basic|. % * Building the Model Reference target of |sldemo_mdlref_counter|, % followed by building the standalone executable for |sldemo_mdlref_basic|. % % Remarks: % % * Once the Real-Time Workshop target of |sldemo_mdlref_counter| is built, % subsequent builds of |sldemo_mdlref_basic| do not trigger a rebuild of % |sldemo_mdlref_counter| unless |sldemo_mdlref_counter| changes % (Incremental Code Generation).  % * Note that the code generated for the referenced model % |sldemo_mdlref_counter| is reused.    % * The HTML report of the generated code for |sldemo_mdlref_basic| has a % link to the HTML report of the generated code for |sldemo_mdlref_counter| % in the Referenced Model section. % % <matlab:slbuild('sldemo_mdlref_basic','StandaloneRTWTarget') Build the % Standalone Target and view the HTML report of the generated code>   %% Incremental Loading Demo  % Close |sldemo_mdlref_counter| and |sldemo_mdlref_basic| and then  % <matlab:open_system('sldemo_mdlref_basic') re-open % |sldemo_mdlref_basic|>. At the MATLAB prompt issue the command:  % % |find_system('type','block_diagram')| % % The referenced model is not listed because it is not loaded. Right click on % any Model block and select Open Model. % At the MATLAB prompt, issue the command: % % |find_system('type','block_diagram')| % % The referenced model is now listed, illustrating how incremental loading % works.           bdclose all    ##### SOURCE END ##### --></body></html>