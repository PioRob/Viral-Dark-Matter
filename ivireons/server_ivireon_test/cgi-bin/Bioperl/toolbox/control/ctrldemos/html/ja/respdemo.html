
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>システム応答のプロット</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="respdemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit respdemo">エディターで respdemo.m を開く</a></div><div class="right"><a href="matlab:echodemo respdemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>システム応答のプロット</h1><!--introduction--><p>このデモでは、SISO および MIMO の各線形システムの時間応答と周波数応答をプロットする方法を示します。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">時間応答</a></li><li><a href="#5">周波数応答</a></li><li><a href="#9">極零点配置図と根軌跡</a></li><li><a href="#15">応答の特性</a></li><li><a href="#17">MIMO システムの解析</a></li><li><a href="#21">システムの比較</a></li></ul></div><h2>時間応答<a name="1"></a></h2><p>説明目的のため、次の 3 次伝達関数を作成します。</p><pre class="codeinput">sys = tf([8 18 32],[1 6 14 24])
</pre><pre class="codeoutput"> 
Transfer function:
   8 s^2 + 18 s + 32
-----------------------
s^3 + 6 s^2 + 14 s + 24
 
</pre><p>このシステムのステップ応答とインパルス応答をプロットするには、<tt>step</tt> コマンドと <tt>impulse</tt> コマンドを使用します。</p><pre class="codeinput">subplot(211), step(sys)
subplot(212), impulse(sys)
</pre><img vspace="5" hspace="5" src="../respdemo_01.png" alt=""> <p><tt>lsim</tt> コマンドを使用すると、任意の信号 (たとえば正弦波) に対する応答をシミュレートすることもできます。入力信号は灰色、システムの応答は青色で表示されます。</p><pre class="codeinput">clf
t = 0:0.01:4;
u = sin(10*t);
lsim(sys,u,t)   <span class="comment">% u,t define the input signal</span>
</pre><img vspace="5" hspace="5" src="../respdemo_02.png" alt=""> <p>連続または離散の TF モデル、SS モデル、または ZPK モデルでは、プロット コマンドを使用できます。状態空間モデルの場合は、特定の初期状態からの強制のない応答をプロットすることもできます。以下に例を示します。</p><pre class="codeinput">A = [-0.8 3.6 -2.1; -3 -1.2 4.8; 3 -4.3 -1.1];
B = [0; -1.1; -0.2];
C = [1.2 0 0.6];
D = -0.6;
G = ss(A,B,C,D);
x0 = [-1;0;2];  <span class="comment">% initial state</span>
initial(G,x0)
grid
</pre><img vspace="5" hspace="5" src="../respdemo_03.png" alt=""> <h2>周波数応答<a name="5"></a></h2><p>周波数領域解析は、制御システムの安定性と性能に関するプロパティを理解するうえで重要となります。ボード線図、ナイキスト線図、およびニコルス線図は、線形システムの周波数応答をプロットし、解析するための標準的な方法の 3 つです。これらのプロットを作成するには、<tt>bode</tt>、<tt>nichols</tt>、<tt>nyquist</tt> の各コマンドを使用します。以下に例を示します。</p><pre class="codeinput">sys = tf([8 18 32],[1 6 14 24])
</pre><pre class="codeoutput"> 
Transfer function:
   8 s^2 + 18 s + 32
-----------------------
s^3 + 6 s^2 + 14 s + 24
 
</pre><pre class="codeinput">bode(sys), grid
</pre><img vspace="5" hspace="5" src="../respdemo_04.png" alt=""> <pre class="codeinput">nyquist(sys), grid
</pre><img vspace="5" hspace="5" src="../respdemo_05.png" alt=""> <pre class="codeinput">nichols(sys), grid
</pre><img vspace="5" hspace="5" src="../respdemo_06.png" alt=""> <h2>極零点配置図と根軌跡<a name="9"></a></h2><p>システムの極と零点には、そのシステムのダイナミクス、安定性、および性能制約に関する貴重な情報が含まれています。たとえば、図 1 のフィードバック ループを例に挙げて考えてみましょう。ここでは、次の関係が成り立っています。</p><p><img src="../respdemo_eq71913.png" alt="$$ G = { - (2 s + 1) \over s^2 + 3 s + 2 } $$"></p><p><img vspace="5" hspace="5" src="../../Figures/response_01.png" alt=""> </p><p><b>図 1:</b>SISO フィードバック ループ</p><p>ゲイン値 <tt>k = 0.7</tt> の場合は、<tt>pzmap</tt> を使用して、閉ループの極と零点をプロットできます。</p><pre class="codeinput">s = tf(<span class="string">'s'</span>);
G = -(2*s+1)/(s^2+3*s+2);
k = 0.7;
T = feedback(G*k,1);
pzmap(T)
grid, axis([-2 0 -1 1])
</pre><img vspace="5" hspace="5" src="../respdemo_07.png" alt=""> <p>閉ループ極 (青い x でマーク) は左半平面にあるため、ゲイン <tt>k</tt> に対してこの値を選択すると、フィードバック ループは安定します。この図からは、閉ループ極の減衰率を読み取ることができます (放射線上のラベルを参照)。ここでは、減衰率が約 0.7 になっており、次のコマンドによって確認できるとおり、閉ループ応答が大きく減衰していることが示されています。</p><pre class="codeinput">clf
step(T)
</pre><img vspace="5" hspace="5" src="../respdemo_08.png" alt=""> <p>ループ ゲイン <tt>k</tt> が閉ループの安定性に与える影響を詳しく理解するには、閉ループ極の軌跡を <tt>k</tt> の関数としてプロットします。</p><pre class="codeinput">rlocus(G), grid
</pre><img vspace="5" hspace="5" src="../respdemo_09.png" alt=""> <p>軌跡が y 軸と交差する箇所をクリックすると、閉ループ極が <tt>k = 1.51</tt> の場合に不安定になることがわかります。そのため、閉ループの安定性を保つには、ループ ゲインを 1.5 より低く維持する必要があります。</p><p><img vspace="5" hspace="5" src="../../Figures/response_02.png" alt=""> </p><h2>応答の特性<a name="15"></a></h2><p>応答プロットを右クリックすると、さまざまなオプションや注釈にアクセスできます。たとえば、<b>[特性]</b> メニューを使用すると、ステップ応答の立ち上がり時間と整定時間、周波数応答プロットのピーク ゲインと安定余裕などの標準的なメトリクスを表示できます。</p><p>前の節と同じ例を使用して、閉ループ ステップ応答をプロットします。</p><pre class="codeinput">step(T)
</pre><img vspace="5" hspace="5" src="../respdemo_10.png" alt=""> <p>次に、プロットを右クリックしてピーク応答と整定時間の各特性を表示し、青いドットをクリックして、それに対応するオーバーシュート値と整定時間値を読み取ります。</p><p><img vspace="5" hspace="5" src="../../Figures/response_03.png" alt=""> </p><h2>MIMO システムの解析<a name="17"></a></h2><p>ここまでに取り上げたコマンドはすべて、多入力多出力 (MIMO) システムを完全にサポートしています。MIMO では、これらのコマンドによってプロットの配列が生成されます。たとえば、2 つの入力と 2 つの出力を持つシステムのステップ応答は次のようになります。</p><pre class="codeinput">sys = rss(3,2,2);
sys.a = [-0.5 -0.3 -0.2 ; 0 -1.3  -1.7; 0.4 1.7 -1.3];
</pre><p>つまり、2 行 2 列のプロット配列となり、各列に特定の入力チャネルのステップ応答が示されます。</p><pre class="codeinput">step(sys)
</pre><img vspace="5" hspace="5" src="../respdemo_11.png" alt=""> <p>必要な場合は、プロットを右クリックして、<b>[I/O のグループ化] -&gt; [すべて]</b> サブメニューを選択することによって、単一のプロットに 4 つの応答すべてをグループ化できます。結果のプロットは、以下のようになります。</p><p><img vspace="5" hspace="5" src="../../Figures/response_04.png" alt=""> </p><p>MIMO システムを解析する場合に便利な追加のプロットは以下のとおりです。</p><div><ul><li>特異値プロット (<tt>sigma</tt>)。周波数応答の主ゲインを示します。</li><li>各 I/O ペアに対する極零点配置図 (<tt>iopzplot</tt>)。</li></ul></div><p>たとえば、<tt>sys</tt> のピーク ゲインを周波数の関数としてプロットします。</p><pre class="codeinput">sigma(sys), grid
</pre><img vspace="5" hspace="5" src="../respdemo_12.png" alt=""> <h2>システムの比較<a name="21"></a></h2><p>応答プロット コマンドを使用すると、一度に複数のシステムをプロットできます。特定の色、マーカー、またはライン スタイルを各システムに割り当てて、比較しやすくすることもできます。上記のフィードバック例を使用して、ループ ゲイン <tt>k</tt> の 3 つの値に対する閉ループ ステップ応答を 3 色でプロットします。</p><pre class="codeinput">k1 = 0.4;  T1 = feedback(G*k1,1);
k2 = 1;  T2 = feedback(G*k2,1);
step(T,<span class="string">'b'</span>,T1,<span class="string">'r'</span>,T2,<span class="string">'g'</span>)
legend(<span class="string">'k = 0.7'</span>,<span class="string">'k = 0.4'</span>,<span class="string">'k = 1'</span>)
</pre><img vspace="5" hspace="5" src="../respdemo_13.png" alt=""> <p class="footer">Copyright 1986-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Plotting System Responses % This demo shows how to plot the time and frequency responses % of SISO and MIMO linear systems.  %   Copyright 1986-2009 The MathWorks, Inc. %   $Revision: 1.1.4.2.2.1 $  $Date: 2010/07/29 21:28:40 $  %% Time Responses % For illustration purposes, create the following third-order transfer function: sys = tf([8 18 32],[1 6 14 24])  %% % You can plot the step and impulse responses of this system using the |step| % and |impulse| commands: subplot(211), step(sys) subplot(212), impulse(sys)  %%  % You can also simulate the response to an arbitrary signal, for example, a sine % wave, using the |lsim| command. The input signal appears in gray and the % system's response in blue. clf t = 0:0.01:4; u = sin(10*t); lsim(sys,u,t)   % u,t define the input signal  %% % You can use the plotting commands with continuous or discrete TF, SS, or ZPK models. For % state-space models, you can also plot the unforced response from some % given initial state, for example: A = [-0.8 3.6 -2.1;-3 -1.2 4.8;3 -4.3 -1.1]; B = [0; -1.1; -0.2]; C = [1.2 0 0.6]; D = -0.6; G = ss(A,B,C,D); x0 = [-1;0;2];  % initial state initial(G,x0) grid  %% Frequency Responses % Frequency-domain analysis is key to understanding stability and % performance properties of control systems. Bode plots, Nyquist plots,  % and Nichols chart are three standard ways to plot and analyze the % frequency response of a linear system. You can create these plots using % the |bode|, |nichols|, and |nyquist| commands. For example: sys = tf([8 18 32],[1 6 14 24])  %% bode(sys), grid  %% nyquist(sys), grid  %% nichols(sys), grid  %% Pole/Zero Maps and Root Locus % The poles and zeros of a system contain valuable information about its % dynamics, stability, and limits of performance. For example, consider the % feedback loop in Figure 1 where  % % $$ G = { - (2 s + 1) \over s^2 + 3 s + 2 } $$ % % <<../Figures/response_01.png>>  %% % *Figure 1*: SISO Feedback Loop.  %% % For the gain value |k = 0.7|, you can plot the closed-loop poles and zeros using % |pzmap|: s = tf('s'); G = -(2*s+1)/(s^2+3*s+2); k = 0.7; T = feedback(G*k,1); pzmap(T) grid, axis([-2 0 -1 1])  %% % The closed-loop poles (marked by blue x's) lie in the left half-plane so the  % feedback loop is stable for this choice of gain |k|. % You can read the damping ratio of the closed-loop poles from this chart % (see labels on the radial lines). Here the damping ratio is about 0.7, % suggesting a well-damped closed-loop response as confirmed by: clf step(T)  %%  % To further understand how the loop gain |k| affects closed-loop % stability, you can plot the locus of the closed-loop poles as a function % of |k|: rlocus(G), grid  %%  % Clicking where the locus intersects the y axis reveals that the % closed-loop poles become unstable for |k = 1.51|. So the loop gain should % remain smaller than 1.5 for closed-loop stability. % % <<../Figures/response_02.png>>   %% Response Characteristics % Right-clicking on response plots gives access to a variety of options and % annotations. In particular, the *Characteristics* menu lets you display % standard metrics such as rise time and settling time for step responses, % or peak gain and stability margins for frequency response plots. % % Using the example from the previous section, plot the closed-loop step % response: step(T)  %% % Now, right-click on the plot to display the Peak Response and Settling Time  % Characteristics, and click on the blue dots to read the corresponding  % overshoot and settling time values: % % <<../Figures/response_03.png>>  %% Analyzing MIMO Systems % All commands mentioned so far fully support multi-input multi-output % (MIMO) systems. In the MIMO case, these commands produce arrays of plots. % For example, the step response of the two-input, two-output system sys = rss(3,2,2); sys.a = [-0.5 -0.3 -0.2 ; 0 -1.3  -1.7; 0.4 1.7 -1.3];  %%  % is a 2-by-2 array of plots where each column shows the step response of  % a particular input channel:  step(sys)  %% % If desired, you can group all four responses on a single plot by % right-clicking on the plot and selecting the *I/O Grouping -> All* % submenu. The resulting plot is shown below. % % <<../Figures/response_04.png>>   %% % The following additional plots are useful for analyzing MIMO systems: % % * Singular value plot (|sigma|), which shows the principal gains of the frequency % response % * Pole/zero map for each I/O pair (|iopzplot|) % % For example, plot the peak gain of |sys| as a function of frequency: sigma(sys), grid  %% Comparing Systems % You can plot multiple systems at once using any of the response plot % commands. You can assign a specific color, marker, or line style to each % system for easy comparison. Using the feedback example above, plot the % closed-loop step response for three values of the loop gain |k| in  % three different colors: k1 = 0.4;  T1 = feedback(G*k1,1); k2 = 1;  T2 = feedback(G*k2,1); step(T,'b',T1,'r',T2,'g') legend('k = 0.7','k = 0.4','k = 1')   displayEndOfDemoMessage(mfilename) ##### SOURCE END ##### --></body></html>